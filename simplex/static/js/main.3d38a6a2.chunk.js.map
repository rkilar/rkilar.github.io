{"version":3,"sources":["utils.js","pivots.js","Program.js","SimplexState.js","TableauDisplay.js","examples.js","Input.js","Layout.js","ProgramDisplay.js","InteractiveTableau.js","App.js","reportWebVitals.js","index.js"],"names":["zero","Fraction","one","minusOne","isInteger","fraction","divisible","isIntegral","arr","every","v","isNonNegative","compare","range","n","st","Array","keys","map","i","copyArr","copyArr2D","r","addArrays","a","b","add","scaleArray","mul","last","length","truePrefixSum","reduce","sum","prefSum","push","listToBoolArray","size","res","inverseArray","cutToLength","len","getDefault","slice","concat","updateArr2D","j","val","newArr","updateArr","frMod","mod","floor","sub","ceil","maxFactor","f","exp","fct","decimalFraction","den","d","e2","f2","e5","rep","toString","padStart","s","toLatex","excludeWhole","useDecimal","isAllowedToSelect","selection","type","allowed","isInSelection","selected","isSecondarySelected","state","baseVariables","flipSelection","value","setSelection","pivot","tableau","newTableau","inverse","k","neg","newBaseVariables","nonePivotSuggestion","pivots","row","description","emptyPrimalPivots","emptyDualPivots","calculatePrimalPivots","baseColumns","disallowSlack","results","foundBland","unbounded","columnsToCheck","minDelta","maxI","div","equals","calculateDualPivots","x","minRatio","minJ","ratio","abs","getZeroFraction","Program","m","A","c","form","labels","this","Acopy","bcopy","ccopy","isBase","invBaseVariables","getStateFromProgram","program","EqualityState","getFromProgram","BasicState","validationFunction","selectedPart","allowedErrorMessage","args","isArray","e","includes","primalGomoryCutTransition","func","label","prompt","defaultSelection","validateArgs","getNewState","dualGomoryCutTransition","columns","standardStatusMessage","canStart","allowPrimalCut","allowDualCut","primalUnbounded","dualUnbounded","iter","primalFeasible","dualFeasible","canPrimalCut","primalSolution","canDualCut","dualSolution","primalProgram","primalLabels","dualLabels","addInfo","dualProgram","setForm","setLabels","addInformation","calculateSolutions","calculatePivots","calculatePrograms","calculateDisabled","calculateTransitions","statusMessage","getStatusMessage","transitions","rows","PrimaryGomory","getFirstCut","cols","DualGomory","AuxiliaryState","getFromBasicState","FarkasState","getFromBasic","primalPivots","dualPivots","suggestedPivots","defaultSuggestion","equalityForm","programs","name","defaultProgram","disabledColumns","disabledRows","disableObjectiveInvariant","FixBaseBasic","baseFixed","backToBasic","availablePivots","canPivot","addedOverall","initialN","initialM","addGomoryCuts","possibleToRemove","some","removeExtraColumns","rowsUsed","col","tab","newRow","newPrimalLabels","newDualLabels","newPrimalProgram","fromTableau","removedColumns","filter","l","addedRows","columnsAdded","auxiliaryProgram","savedObjective","correctI","minB","getFirstPivotRow","auxiliaryPivot","goBackToBasic","outerIter","undefined","fromArrays","of","dummyTableau","thisRef","hasBase","infeasible","nonePivots","EqualityDualGomory","EqualityFirstStage","getFromEqualityState","stage","goBack","FixBaseEquality","TableauCell","position","hidden","showInvariant","isCorner","isHighlighted","isDisabled","isSelected","isSelectable","showPointer","showSelection","showDisabled","useMixed","onClick","isInner","classes","join","className","cornerCell","settings","onCellClick","bCell","highlightInvariants","objectiveRow","showBColumnsLeft","showSlackLeft","showBase","highlightBase","innerCell","highlightedPivots","TableauDisplay","showObjectiveBottom","examples","checkInput","input","test","InputField","onChange","ending","target","ExampleLoading","examplesList","update","parseInt","htmlFor","id","ProgramInput","onFinish","useState","zeroProgram","fieldsA","fieldsB","fieldsC","fieldN","fieldM","selectedExample","setState","updateSize","fn","fm","isNaN","Math","max","min","adjustSizeFields","updateB","updateC","isDual","isEquality","exampleNum","toFraction","onBlur","required","newForm","style","clear","Fragment","updateA","colSpan","Pane","children","MultiPane","chosen","setChosen","filteredChildren","flat","child","props","SplitPane","Monomial","first","firstNonZero","lastInEmptyRow","ProgramDisplay","getFirstNonZeroIndex","indexOf","showPrimal","firstNonZeroInTopRow","SlackForm","nonBasicColumns","SolutionDisplay","title","solution","toShow","feasible","SelectSetting","currentValue","options","option","SwitchSetting","color","height","width","onColor","checked","Settings","setSetting","Object","entries","newValue","InteractiveTableau","initialProgram","onStartOver","stateHistory","index","selectedProgram","currentTransition","currentTableau","appendTableau","newTab","setting","p","console","log","disabled","split","subMsg","transition","errorMessage","makeTransition","correct","error","choice","App","setInitialProgram","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.3d38a6a2.chunk.js","sourcesContent":["// import Fraction from 'fraction.js/bigfraction'\r\nimport Fraction from 'fraction.js'\r\n\r\nexport const zero     = new Fraction(\"0\");\r\nexport const one      = new Fraction(\"1\");\r\nexport const minusOne = new Fraction(\"-1\");\r\n\r\nexport const isInteger = fraction => fraction.divisible(one);\r\nexport const isIntegral = arr => arr.every(v => isInteger(v));\r\nexport const isIntegral2D = arr => arr.every(r => isIntegral(r));\r\nexport const isNonNegative = arr => arr.every(v => v.compare(zero) >= 0);\r\n\r\nexport const range = (n, st=0) => [...Array(n).keys()].map(i => i + st);\r\n\r\nexport const copyArr = arr => [...arr];\r\nexport const copyArr2D = arr => arr.map(r => copyArr(r));\r\n\r\nexport const addArrays  = (a, b) => a.map((v, i) => v.add(b[i]));\r\nexport const scaleArray = (v, a) => v.map(v => v.mul(a));\r\n\r\nexport const last = arr => arr[arr.length - 1];\r\n\r\nexport const countTrue = arr => arr.reduce((count, v) => v ? count + 1 : count, 0);\r\nexport const truePrefixSum = arr => arr.reduce(\r\n                                    ([sum, prefSum], v) => {\r\n                                      sum = v ? sum + 1 : sum;\r\n                                      prefSum.push(sum);\r\n                                      return [sum, prefSum];\r\n                                    }, [0, []]);\r\n\r\nexport const listToBoolArray = (arr, size) => arr.reduce(\r\n                                              (res, v) => {\r\n                                                if (v >= 0) res[v] = true; return res;\r\n                                              }, range(size).map(() => false));\r\n\r\nexport const inverseArray = (arr, size) => arr.reduce(\r\n                                            (res, v, i) => {\r\n                                              if (v >= 0) res[v] = i; return res;\r\n                                            }, range(size).map(() => -1));\r\n\r\nexport const cutToLength = (arr, len, getDefault) => {\r\n  if (arr.length >= len) {\r\n      return arr.slice(0, len);\r\n  }\r\n  return copyArr(arr).concat(\r\n    range(len - arr.length).map(i => getDefault()));\r\n}\r\n\r\nexport const updateArr2D = (arr, i, j, val) => {\r\n  const newArr = copyArr2D(arr);\r\n  newArr[i][j] = val;\r\n  return newArr;\r\n}\r\n\r\nexport const updateArr = (arr, i, val) => {\r\n  const newArr = copyArr(arr);\r\n  newArr[i] = val;\r\n  return newArr;\r\n}\r\n\r\nexport const frMod = (a, b) => a.mod(b).add(b).mod(b);\r\nexport const floor = a => a.sub(frMod(a, one));\r\nexport const ceil  = a => a.add(frMod(one.sub(frMod(a, one)), one));\r\n\r\nconst maxFactor = (f, val) => {\r\n  let exp = 0;\r\n  let fct = 1;\r\n  while (val % f === 0) {\r\n    fct = fct * f;\r\n    val /= f;\r\n    exp ++;\r\n  } \r\n  return [exp, fct];\r\n}\r\n\r\nexport const decimalFraction = val => {\r\n  const den = val.d;\r\n  let [e2, f2] = maxFactor(2, den);\r\n  let [e5, f5] = maxFactor(5, den);\r\n  if (den / (f2 * f5) !== 1) return null;\r\n  let res = val.n;\r\n  while (e2 < e5) { e2 ++; res *= 2; }\r\n  while (e5 < e2) { e5 ++; res *= 5; }\r\n  let rep = res.toString().padStart(e2 + 1, '0');\r\n  return (val.s === -1 ? \"-\" : \"\") + (e2 === 0 ? rep : `${rep.slice(0, -e2)}.${rep.slice(-e2)}`);\r\n}\r\n\r\nexport const toLatex = (val, excludeWhole=false, useDecimal=true) => {\r\n  if (useDecimal) {\r\n    const rep = decimalFraction(val);\r\n    if (rep !== null) return rep;\r\n  }\r\n  return val.toLatex(excludeWhole);\r\n}\r\n\r\nexport function isAllowedToSelect(i, j, selection) {\r\n  switch (selection.type) {\r\n    case \"rows\":\r\n      return selection.allowed[i];\r\n    case \"columns\":\r\n    case \"base_columns\":\r\n      return selection.allowed[j];\r\n    case \"cells\":\r\n      return selection.allowed[i][j];\r\n    default:\r\n      return false;\r\n  }\r\n}\r\n\r\nexport function isInSelection(i, j, selection) {\r\n  switch (selection.type) {\r\n    case \"rows\":\r\n      return selection.selected[i];\r\n    case \"columns\":\r\n    case \"base_columns\":\r\n      return selection.selected[j];\r\n    case \"cells\":\r\n      return selection.selected[i][j];\r\n    default:\r\n      return false;\r\n  }\r\n}\r\n\r\nexport function isSecondarySelected(i, j, selection, state) {\r\n  return selection.type === 'base_columns' && i > 0 && selection.selected[state.baseVariables[i-1]];\r\n}\r\n\r\nexport function setSelection(i, j, selection, value) {\r\n  switch (selection.type) {\r\n    case \"rows\":\r\n      return {...selection, selected: updateArr(selection.selected, i, value)};\r\n    case \"columns\":\r\n    case \"base_columns\":\r\n      return {...selection, selected: updateArr(selection.selected, j, value)};\r\n    case \"cells\":\r\n      return {...selection, selected: updateArr2D(selection.selected, i, j, value)};\r\n    default:\r\n      return {...selection};\r\n  }\r\n}\r\n\r\nexport function flipSelection(i, j, selection) {\r\n  return setSelection(i, j, selection, !isInSelection(i, j, selection));\r\n}","import { copyArr, copyArr2D, zero, scaleArray, addArrays, last} from './utils.js'\r\n\r\nexport function pivot(tableau, baseVariables, i, j) {\r\n  const newTableau = copyArr2D(tableau);\r\n  newTableau[i] = scaleArray(newTableau[i], newTableau[i][j].inverse());\r\n  for (let k = 0; k < newTableau.length; k ++) {\r\n    if (k !== i) {\r\n      newTableau[k] = addArrays(newTableau[k], scaleArray(newTableau[i], newTableau[k][j].neg()));\r\n    }\r\n  }\r\n\r\n  const newBaseVariables = copyArr(baseVariables);\r\n  newBaseVariables[i - 1] = j;\r\n  \r\n  return [newTableau, newBaseVariables];\r\n}\r\n\r\nexport function nonePivotSuggestion(tableau) {\r\n  return { pivots: tableau.map(row => row.map(() => false)), description: \"None\"};\r\n}\r\n\r\nexport function emptyPrimalPivots(tableau) {\r\n  return {\r\n    \"generic_primal\": { pivots: tableau.map(row => row.map(() => false)), \r\n                        description: \"Generic pivot for primal simplex\" },\r\n    \"bland_primal\"  : { pivots: tableau.map(row => row.map(() => false)), \r\n                        description: \"Bland's rule for primal simplex\" },\r\n  }\r\n}\r\n\r\nexport function emptyDualPivots(tableau) {\r\n  return {\r\n    \"generic_dual\": { pivots: tableau.map(row => row.map(() => false)), \r\n                      description: \"Generic pivot for dual simplex\" },\r\n    \"bland_dual\"  : { pivots: tableau.map(row => row.map(() => false)), \r\n                      description: \"Bland's rule for dual simplex\" },\r\n  };\r\n}\r\n\r\nexport function calculatePrimalPivots(tableau, baseColumns, disallowSlack=false, n=null) {\r\n  const results = emptyPrimalPivots(tableau);\r\n\r\n  if (!tableau.slice(1).every(row => last(row).compare(zero) >= 0)) \r\n    return [results, false];\r\n\r\n  let foundBland = false;\r\n  let unbounded = false;\r\n  const columnsToCheck = disallowSlack ? n : tableau[0].length - 1;\r\n  for (let j = 0; j < columnsToCheck; j ++) {\r\n    if (baseColumns[j] || tableau[0][j].compare(zero) >= 0) continue;\r\n    let minDelta = null;\r\n    let maxI = null;\r\n    for (let i = 1; i < tableau.length; i ++) {\r\n      if (tableau[i][j].compare(zero) <= 0) continue;\r\n      if (minDelta === null || minDelta.compare(last(tableau[i]).div(tableau[i][j])) > 0) {\r\n        minDelta = last(tableau[i]).div(tableau[i][j]);\r\n        maxI = i;\r\n      }\r\n    }\r\n    if (minDelta === null) {\r\n      unbounded = true;\r\n      continue;\r\n    }\r\n    for (let i = 1; i < tableau.length; i ++) {\r\n      if (tableau[i][j].compare(zero) <= 0) continue;\r\n      if (minDelta.equals(last(tableau[i]).div(tableau[i][j]))) {\r\n        results[\"generic_primal\"].pivots[i][j] = true;\r\n      }\r\n    }\r\n    if (!foundBland) {\r\n      foundBland = true;\r\n      results[\"bland_primal\"].pivots[maxI][j] = true;\r\n    }\r\n  }\r\n  return [results, unbounded];\r\n}\r\n\r\nexport function calculateDualPivots(tableau, disallowSlack=false, n=null) {\r\n  const results = emptyDualPivots(tableau);\r\n  if (!tableau[0].slice(0, -1).every(x => x.compare(zero) >= 0))\r\n    return [results, false];\r\n\r\n  let foundBland = false;\r\n  let unbounded = false;\r\n\r\n  const columnsToCheck = disallowSlack ? n : tableau[0].length - 1;\r\n  for (let i = 1; i < tableau.length; i ++) {\r\n    if (last(tableau[i]).compare(0) >= 0) continue;\r\n    let minRatio = null;\r\n    let minJ = null;\r\n    for (let j = 0; j < columnsToCheck; j ++) {\r\n      if (tableau[i][j].compare(zero) >= 0) continue;\r\n      const ratio = tableau[0][j].div(tableau[i][j]).abs();\r\n      if (minRatio === null || ratio.compare(minRatio) < 0) {\r\n        minRatio = ratio;\r\n        minJ = j;\r\n      }\r\n    }\r\n    if (minRatio === null) {\r\n      unbounded = true;\r\n      continue;\r\n    }\r\n    for (let j = 0; j < columnsToCheck; j ++) {\r\n      if (tableau[i][j].compare(zero) >= 0) continue;\r\n      if (minRatio.equals(tableau[0][j].div(tableau[i][j]).abs())) {\r\n        results[\"generic_dual\"].pivots[i][j] = true;\r\n      }\r\n    }\r\n    if (!foundBland) {\r\n      foundBland = true;\r\n      results[\"bland_dual\"].pivots[i][minJ] = true;\r\n    }\r\n  }\r\n  return [results, unbounded];\r\n}","import { range, copyArr, copyArr2D, zero, last, cutToLength, isIntegral, isIntegral2D, updateArr2D, updateArr, listToBoolArray, inverseArray } from './utils.js'\r\nimport { pivot } from './pivots.js'\r\n// import Fraction from 'fraction.js/bigfraction'\r\nimport Fraction from 'fraction.js'\r\n\r\nconst getZeroFraction = () => zero;\r\nconst getZeroRow = len => () => range(len).map(() => zero);\r\n\r\nexport default class Program {\r\n  constructor({n, m, A, b, c, form, labels=null}) {\r\n    this.n = n;\r\n    this.m = m;\r\n    this.A = A;\r\n    this.b = b;\r\n    this.c = c;  \r\n    this.form = form;\r\n    this.labels = labels !== null ? labels :\r\n      form === 'primal' || form === \"equality\" ? \r\n        range(n).map(i => `x_{${i + 1}}`) : range(m).map(i => `y_{${i + 1}}`);\r\n  }\r\n\r\n  static zeroProgram(n, m) {\r\n    return new Program({n: n, m: m, \r\n      A: range(m).map(() => range(n).map(() => zero)),\r\n      b: range(m).map(() => zero),\r\n      c: range(n).map(() => zero),\r\n      form: 'primal',\r\n    });\r\n  }\r\n\r\n  static fromArrays(A, b, c, form='primal', labels=null) {\r\n    return new Program({n: c.length, m: b.length, \r\n      A: A.map(r => r.map(v => Fraction(v))),\r\n      b: b.map(v => Fraction(v)),\r\n      c: c.map(v => Fraction(v)),\r\n      form: form,\r\n      labels: labels\r\n    });\r\n  }\r\n\r\n  static fromTableau(n, m, tableau, baseVariables, labels) {\r\n    let isBase = listToBoolArray(baseVariables, n + m);\r\n\r\n    for (let j = 0; j < m; j ++) {\r\n      if (isBase[n + j]) continue;\r\n\r\n      for (let i = 1; i <= m; i ++) {\r\n        if (!tableau[i][n + j].equals(zero) && baseVariables[i-1] < n) {\r\n          [tableau, baseVariables] = pivot(tableau, baseVariables, i, n + j);\r\n          isBase = listToBoolArray(baseVariables, n + m);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    const invBaseVariables = inverseArray(baseVariables, n + m);\r\n    tableau = [tableau[0]].concat(range(m).map(j => tableau[invBaseVariables[n + j]+1]));\r\n\r\n    return new Program({\r\n      n: n, m: m,\r\n      A: range(m).map(i => range(n).map(j => tableau[i+1][j])),\r\n      b: range(m).map(i => last(tableau[i+1])),\r\n      c: range(n).map(j => tableau[0][j].neg()),\r\n      form: 'primal',\r\n      labels: labels.slice(0, n),\r\n    })\r\n  }\r\n\r\n  isDual() {\r\n    return this.form === 'dual' || this.form === 'equality_dual';\r\n  }\r\n\r\n  isEquality() {\r\n    return this.form === 'equality' || this.form === 'equality_dual';\r\n  }\r\n\r\n  copy() {\r\n    return new Program({\r\n      ...this,\r\n      A: copyArr2D(this.A),\r\n      b: copyArr(this.b),\r\n      c: copyArr(this.c),\r\n    });\r\n  }\r\n\r\n  updateSize(n, m) {\r\n    const Acopy = cutToLength(\r\n        this.A.map(row => cutToLength(row, n, getZeroFraction)), \r\n        m, getZeroRow(n));\r\n    const bcopy = cutToLength(this.b, m, getZeroFraction);\r\n    const ccopy = cutToLength(this.c, n, getZeroFraction);\r\n\r\n    return new Program({n: n, m: m, A: Acopy, b: bcopy, c: ccopy, form: this.form});\r\n  }\r\n\r\n  updateA(i, j, val) {\r\n    return new Program({\r\n      ...this,\r\n      A: updateArr2D(this.A, i, j, val)\r\n    })\r\n  }\r\n\r\n  updateB(i, val) {\r\n    return new Program({\r\n      ...this,\r\n      b: updateArr(this.b, i, val)\r\n    })\r\n  }\r\n\r\n  updateC(j, val) {\r\n    return new Program({\r\n      ...this,\r\n      c: updateArr(this.c, j, val)\r\n    })\r\n  }\r\n\r\n  setForm(f) {\r\n    return new Program({\r\n      ...this,\r\n      form: f,\r\n      labels: null\r\n    });\r\n  }\r\n\r\n  setLabels(labels) {\r\n    return new Program({\r\n      ...this,\r\n      labels: labels\r\n    })\r\n  }\r\n\r\n  isIntegral() {\r\n    return isIntegral2D(this.A) && isIntegral(this.b) && isIntegral(this.c);\r\n  }\r\n}","import { copyArr, copyArr2D, range, zero, one, minusOne, floor, ceil, \r\n  last, isInteger, isIntegral, isNonNegative, truePrefixSum, listToBoolArray, inverseArray} from './utils.js';\r\nimport Program from './Program.js';\r\nimport { pivot, calculatePrimalPivots, calculateDualPivots, nonePivotSuggestion, emptyDualPivots, emptyPrimalPivots } from './pivots.js'\r\n\r\nexport function getStateFromProgram(program) {\r\n  if (program.form === 'equality' || program.form === 'equality_dual')\r\n    return EqualityState.getFromProgram(program);\r\n  else\r\n    return BasicState.getFromProgram(program);\r\n}\r\n\r\nfunction validationFunction(allowed, selectedPart, allowedErrorMessage) {\r\n  return args => {\r\n    if (!Array.isArray(args) || !args.every(e => typeof e === 'boolean')) \r\n      return [false, \"Argument must be an array of booleans\"];\r\n    if (!args.every((v, i) => !v || allowed[i]))\r\n      return [false, allowedErrorMessage];\r\n    if (!args.includes(true))\r\n      return [false, `At least one ${selectedPart} must be selected.`];\r\n    return [true, null];\r\n  };\r\n}\r\n\r\nfunction primalGomoryCutTransition(state, func) {\r\n  const allowed = range(state.m + 1).map(i => !isInteger(last(state.tableau[i])));\r\n  return {\r\n    label: \"Add Gomory cuts for primal LP\",\r\n    args: \"rows\",\r\n    prompt: \"Select rows to use in making cuts\",\r\n    allowed: allowed,\r\n    defaultSelection: range(state.m + 1).map(() => false),\r\n    validateArgs: validationFunction(allowed, \"row\", \"Only rows with non integer value in the last column can be used.\"),\r\n    getNewState: func\r\n  };\r\n}\r\n\r\nfunction dualGomoryCutTransition(state, func) {\r\n  const allowed = range(state.columns).map(i => !isInteger(state.tableau[0][i]));\r\n  return {\r\n    label: \"Add Gomory cuts for dual LP\",\r\n    args: \"columns\",\r\n    prompt: \"Select columns to use in making cuts\",\r\n    allowed: allowed,\r\n    defaultSelection: range(state.columns).map(() => false),\r\n    validateArgs: validationFunction(allowed, \"column\", \"Only columns with non integer value in the first row can be used.\"),\r\n    getNewState: func\r\n  }\r\n}\r\n\r\nfunction standardStatusMessage(state, canStart=true, allowPrimalCut=true, allowDualCut=true) {\r\n  if (state.primalUnbounded) {\r\n    return \"The primal LP is unbounded.\";\r\n  } else if (state.dualUnbounded) {\r\n    return \"The dual LP is unbounded.\";\r\n  } else if(state.iter === 0 && !state.primalFeasible && canStart) {\r\n    if (state.dualFeasible) {\r\n      return \"Use the dual simplex method. Alternatively use an auxiliary LP or Farkas lemma to find a feasible primal solution\";\r\n    }\r\n    return \"Use an auxiliary LP or Farkas lemma to find a feasible primal solution\";\r\n  } else if (state.primalFeasible && state.dualFeasible) {\r\n    let canPrimalCut = !isIntegral(state.primalSolution) && allowPrimalCut;\r\n    let canDualCut = !isIntegral(state.dualSolution) && state.primalProgram.isIntegral() && allowDualCut;\r\n    if (canPrimalCut && canDualCut) {\r\n      return \"The LP is optimized, but the primal and dual solutions aren't integral. You can use Gomory cuts to look for integral solutions.\"\r\n    } else if (canPrimalCut) {\r\n      return \"The LP is optimized, but the primal solution isn't integral. You can use Gomory cuts to look for an integral solution.\"\r\n    } else if (canDualCut) {\r\n      return \"The LP is optimized, but the dual solution isn't integral. You can use Gomory cuts to look for an integral solution.\"\r\n    }\r\n    return \"An optimal solution has been reached.\";\r\n  } else if (state.primalFeasible) {\r\n    return \"Use the primal simplex method to optimize the LP.\";\r\n  } else if (state.dualFeasible) {\r\n    return \"Use the dual simplex method to optimize the LP.\";\r\n  }\r\n  return \"The tableau is not primal feasible or dual feasible. Return to previous state and follow instructions or make pivots to find a feasible base\";\r\n}\r\n\r\nclass BasicState {\r\n  constructor({tableau, n, m, primalLabels, dualLabels, baseVariables, primalProgram, iter, columns, addInfo=true}) {\r\n    this.tableau = tableau;\r\n    this.n = n;\r\n    this.m = m;\r\n    this.columns = columns;\r\n    this.primalLabels = primalLabels;\r\n    this.dualLabels = dualLabels;\r\n    this.baseVariables = baseVariables;\r\n    this.primalProgram = primalProgram;\r\n    this.dualProgram = primalProgram.setForm(primalProgram.form === 'primal' ? 'dual' : 'equality_dual').setLabels(this.dualLabels);\r\n    this.iter = iter;\r\n\r\n    if (addInfo)\r\n      this.addInformation();\r\n  }\r\n\r\n  static getFromProgram(program) {\r\n    let tableau = [\r\n      program.c.map(v => v.neg()).concat(\r\n        range(program.m + 1).map(() => zero))\r\n    ].concat(\r\n      program.A.map((row, i) =>\r\n        row.concat(\r\n          range(program.m).map(v => v === i ? one : zero)\r\n        ).concat(program.b[i])\r\n      )\r\n    );\r\n    \r\n    const primalLabels = range(program.n).map(i => `x_{${i+1}}`)\r\n          .concat(range(program.m).map(i => `s_{${i+1}}`));\r\n    const dualLabels = range(program.m).map(i => `y_{${i+1}}`);\r\n    const baseVariables = range(program.m).map(i => program.n + i);\r\n  \r\n    return new BasicState({\r\n      tableau: tableau,\r\n      n: program.n,\r\n      m: program.m,\r\n      columns: program.n + program.m + 1,\r\n      primalLabels: primalLabels,\r\n      dualLabels: dualLabels,\r\n      baseVariables: baseVariables,\r\n      primalProgram: program.form === \"dual\" ? program.setForm(\"primal\") : program,\r\n      iter: 0,\r\n    });\r\n  }\r\n\r\n  addInformation() {  \r\n    this.isBase = listToBoolArray(this.baseVariables, this.columns - 1);\r\n    \r\n    this.calculateSolutions();\r\n    this.calculatePivots();\r\n    this.calculatePrograms();\r\n    this.calculateDisabled();\r\n    this.calculateTransitions();\r\n\r\n    this.statusMessage = this.getStatusMessage();\r\n  }\r\n\r\n  getStatusMessage() {\r\n    return standardStatusMessage(this);\r\n  }\r\n\r\n  calculateTransitions() {\r\n    if (this.primalUnbounded || this.dualUnbounded) {\r\n      this.transitions = [];\r\n    } else if(this.iter === 0 && !this.primalFeasible) {\r\n      this.transitions = [{ \r\n          label: \"Use an auxiliary LP\", \r\n          args: \"none\",\r\n          getNewState: () => AuxiliaryState.getFromBasicState(this) \r\n        }, { \r\n          label: \"Use Farkas' Lemma\", \r\n          args: \"none\",\r\n          getNewState: () => FarkasState.getFromBasic(this)\r\n      }];\r\n    } else if (this.primalFeasible && this.dualFeasible) {\r\n      let res = [];\r\n      if (!isIntegral(this.primalSolution)) {\r\n        res.push(primalGomoryCutTransition(this, rows => PrimaryGomory.getFirstCut(this, rows)))\r\n      }\r\n      if (!isIntegral(this.dualSolution) && this.primalProgram.isIntegral()) {\r\n        res.push(dualGomoryCutTransition(this, cols => DualGomory.getFirstCut(this, cols)));\r\n      }\r\n      this.transitions = res;\r\n    } else {\r\n      this.transitions = [];\r\n    }\r\n  }\r\n\r\n  calculatePivots() {\r\n    const [primalPivots, primalUnbounded] = calculatePrimalPivots(this.tableau, this.isBase);\r\n    const [dualPivots  , dualUnbounded ] = calculateDualPivots(this.tableau);\r\n\r\n    this.suggestedPivots = {\r\n      \"none\": nonePivotSuggestion(this.tableau),\r\n      ...primalPivots,\r\n      ...dualPivots,\r\n    }\r\n    this.defaultSuggestion = \"bland_primal\";\r\n    this.primalUnbounded = primalUnbounded;\r\n    this.dualUnbounded  = dualUnbounded;\r\n  }\r\n\r\n  calculateSolutions() {\r\n    this.primalFeasible = isNonNegative(this.tableau.slice(1).map(r => last(r)));\r\n    this.dualFeasible   = isNonNegative(this.tableau[0].slice(0, -1));\r\n\r\n    this.primalSolution = range(this.columns - 1).map(() => zero);\r\n    for (let i = 0; i < this.m; i ++) {\r\n      this.primalSolution[this.baseVariables[i]] = last(this.tableau[i+1]);\r\n    }\r\n\r\n    if (!this.primalProgram.equalityForm) {\r\n      this.dualSolution = Array(this.m);\r\n      for (let i = 0; i < this.m; i ++) {\r\n        this.dualSolution[i] = this.tableau[0][i + this.n];\r\n      }\r\n    }\r\n  }\r\n\r\n  calculatePrograms() {\r\n    this.programs = [{\r\n      name: \"Primal LP\",\r\n      program: this.primalProgram,\r\n    }, {\r\n      name: \"Dual LP\",\r\n      program: this.dualProgram,\r\n    }];\r\n    this.defaultProgram = \"Primal LP\";\r\n  }\r\n\r\n  calculateDisabled() {\r\n    this.disabledColumns = range(this.columns).map(() => false);\r\n    this.disabledRows = this.tableau.map(() => false);\r\n    this.disableObjectiveInvariant = false;\r\n  }\r\n\r\n  canPivot(i, j) {\r\n    return !(j === this.columns - 1 || i === 0  ||\r\n            this.tableau[i][j].equals(zero) ||\r\n            this.isBase[j]);\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new BasicState({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass FixBaseBasic extends BasicState {\r\n  constructor(args) {\r\n    super({...args, addInfo: false});\r\n    this.baseFixed = this.baseVariables.every(v => this.tableau[0][v].equals(zero));\r\n    this.addInformation();\r\n  }\r\n\r\n  getStatusMessage() {\r\n    if (this.baseFixed)\r\n      return \"The top row is fixed.\"\r\n    return \"Make pivots to represent the top row in the new base.\"\r\n  }\r\n\r\n  canPivot(i, j) {\r\n    return this.isBase[j] && !this.tableau[0][j].equals(zero) && this.tableau[i][j].equals(one);\r\n  }\r\n\r\n  calculateTransitions() {\r\n    if (this.baseFixed) {\r\n      this.transitions = [{\r\n        label: \"Continue\", \r\n        args: \"none\",\r\n        getNewState: () => this.backToBasic()\r\n      }];\r\n    } else {\r\n      this.transitions = [];\r\n    }\r\n  }\r\n\r\n  calculatePivots() {\r\n    const availablePivots = this.tableau.map((row, i) => row.map((v, j) => this.canPivot(i, j)));\r\n    this.suggestedPivots = {\r\n      \"none\": { pivots: availablePivots, description: \"None\"},\r\n      \"generic_dual\": { pivots: availablePivots, description: \"Generic pivot for dual simplex\"},\r\n      \"bland_dual\": { pivots: availablePivots, description: \"Bland's rule for dual simplex\"},\r\n      \"generic_primal\": { pivots: availablePivots, description: \"Generic pivot for primal simplex\"},\r\n      \"bland_primal\": { pivots: availablePivots, description: \"Bland's rule for primal simplex\"},\r\n    };\r\n    this.defaultSuggestion = \"bland_primal\";\r\n    this.primalUnbounded = false;\r\n    this.dualUnbounded = false;\r\n  }\r\n\r\n  backToBasic() {\r\n    return new BasicState({...this});\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new FixBaseBasic({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    });\r\n  }\r\n}\r\n\r\nclass PrimaryGomory extends BasicState {\r\n  constructor({addedOverall, initialN, initialM, ...args}) {\r\n    super({...args, addInfo: false});\r\n    this.addedOverall = addedOverall;\r\n    this.initialN = initialN;\r\n    this.initialM = initialM;\r\n    this.addInformation();\r\n  }\r\n\r\n  static getFirstCut(state, rows) {\r\n    return (new PrimaryGomory({\r\n      ...state,\r\n      addedOverall: 0,\r\n      initialN: state.n,\r\n      initialM: state.m,\r\n    })).addGomoryCuts(rows);\r\n  }\r\n\r\n  getStatusMessage() {\r\n    return standardStatusMessage(this, false, true, false);\r\n  }\r\n\r\n  calculateTransitions() {\r\n    if (this.primalUnbounded || this.dualUnbounded) {\r\n      this.transitions = [];\r\n    } else if (this.primalFeasible && this.dualFeasible) {\r\n      let res = [];\r\n      if (!isIntegral(this.primalSolution)) {\r\n        res.push(primalGomoryCutTransition(this, rows => this.addGomoryCuts(rows)))\r\n        const possibleToRemove = range(this.columns).map(j => (j >= this.initialN + this.initialM && j < this.columns - 1) && this.isBase[j]);\r\n        if (possibleToRemove.some(v => v)) {\r\n          res.push({\r\n            label: \"Remove superfluous cuts\",\r\n            args: \"base_columns\",\r\n            prompt: \"Select columns to remove\",\r\n            allowed: possibleToRemove,\r\n            defaultSelection: range(this.columns).map(() => false),\r\n            validateArgs: validationFunction(possibleToRemove, \"column\", \"Only columns added with Gomory cuts that are currently in the base can be removed.\"),\r\n            getNewState: cols => this.removeExtraColumns(cols)\r\n          })\r\n        }\r\n      }\r\n      this.transitions = res;\r\n    } else {\r\n      this.transitions = [];\r\n    }\r\n  }\r\n\r\n  addGomoryCuts(rows) {\r\n    let newTableau = copyArr2D(this.tableau);\r\n    let newBaseVariables = copyArr(this.baseVariables);\r\n    let rowsUsed = 0;\r\n    for (let i = 0; i <= this.m; i ++) {\r\n      if (!rows[i]) continue;\r\n      const col = this.tableau[0].length + rowsUsed;\r\n      const tab = newTableau;\r\n      const newRow = range(col + 1).map(j => \r\n        j === col     ? tab[i][col-1].sub(floor(tab[i][col-1])).neg() :\r\n        j === col - 1 ? one : \r\n        tab[i][j].sub(floor(tab[i][j])).neg());\r\n      newTableau = tab.map(row => row.slice(0, col-1).concat(zero, row[col-1]))\r\n                      .concat([newRow]);\r\n      newBaseVariables.push(col - 1);                      \r\n      rowsUsed ++;\r\n    }\r\n    const newPrimalLabels = this.primalLabels.concat(range(rowsUsed).map(i => `s_{${this.initialM + this.addedOverall + i + 1}}`));\r\n    const newDualLabels = this.dualLabels.concat(range(rowsUsed).map(i => `y_{${this.initialM + this.addedOverall + i + 1}}`));\r\n    const newPrimalProgram = Program.fromTableau(this.n, this.m + rowsUsed, newTableau, newBaseVariables, newPrimalLabels)\r\n\r\n    return new PrimaryGomory({\r\n      ...this,\r\n      m: this.m + rowsUsed,\r\n      columns: this.columns + rowsUsed,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      primalLabels: newPrimalLabels,\r\n      dualLabels: newDualLabels,\r\n      primalProgram: newPrimalProgram,\r\n      iter: this.iter + 1,\r\n      addedOverall: this.addedOverall + rowsUsed,\r\n    });\r\n  }\r\n\r\n  removeExtraColumns(cols) {\r\n    const [removedColumns, prefSum] = truePrefixSum(cols);\r\n    const newTableau = this.tableau.filter((r, i) => i === 0 ? true : !cols[this.baseVariables[i-1]]).map(row => row.filter((v, j) => !cols[j]));\r\n    const newBaseVariables = this.baseVariables.filter(v => !cols[v]).map(v => v - prefSum[v]);\r\n    const newPrimalLabels = this.primalLabels.filter((l, i) => !cols[i]);\r\n    const newDualLabels = this.dualLabels.filter((l, i) => !cols[i + this.n]);\r\n    const newPrimalProgram = Program.fromTableau(this.n, this.m - removedColumns, newTableau, newBaseVariables, newPrimalLabels)\r\n    return new PrimaryGomory({\r\n      ...this,\r\n      m: this.m - removedColumns,\r\n      columns: this.columns - removedColumns,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      primalLabels: newPrimalLabels,\r\n      dualLabels: newDualLabels,\r\n      primalProgram: newPrimalProgram,\r\n    })\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new PrimaryGomory({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass DualGomory extends BasicState {\r\n  constructor({initialN, addedOverall, ...args}) {\r\n    super({...args, addInfo: false});\r\n    this.initialN = initialN;\r\n    this.addedOverall = addedOverall;\r\n\r\n    this.addInformation();\r\n  }\r\n\r\n  static getFirstCut(state, cols) {\r\n    return (new DualGomory({\r\n      ...state,\r\n      initialN: state.n,\r\n      addedOverall: 0,\r\n    })).addGomoryCuts(cols);\r\n  }\r\n\r\n  getStatusMessage() {\r\n    return standardStatusMessage(this, false, false, true);\r\n  }\r\n\r\n  calculateTransitions() {\r\n    if (this.primalUnbounded || this.dualUnbounded) {\r\n      this.transitions = [];\r\n    } else if (this.primalFeasible && this.dualFeasible) {\r\n      let res = [];\r\n\r\n      if (!isIntegral(this.dualSolution)) {\r\n        res.push(dualGomoryCutTransition(this, cols => this.addGomoryCuts(cols)));\r\n\r\n        const possibleToRemove = range(this.columns).map(i => i >= this.initialN && i < this.n && !this.isBase[i]);\r\n        if (possibleToRemove.some(v => v)) {\r\n          res.push({\r\n            label: \"Remove superfluous cuts\",\r\n            args: \"columns\",\r\n            prompt: \"Select columns to remove\",\r\n            allowed: possibleToRemove,\r\n            defaultSelection: range(this.columns).map(() => false),\r\n            validateArgs: validationFunction(possibleToRemove, \"column\", \"Only columns added with Gomory cuts that are not currently in the base can be removed.\"),\r\n            getNewState: cols => this.removeExtraColumns(cols)\r\n          })\r\n        }\r\n      }\r\n      this.transitions = res;\r\n    } else {\r\n      this.transitions = [];\r\n    }\r\n  }\r\n\r\n  addGomoryCuts(cols) {\r\n    let addedRows = range(this.m + 1).map(() => []);\r\n    let columnsAdded = 0;\r\n    for (let j = 0; j <= this.columns; j ++) {\r\n      if (!cols[j]) continue;\r\n      addedRows = addedRows.map((row, i) =>\r\n        i === 0 ? \r\n        row.concat(this.tableau[i][j].sub( ceil(this.tableau[i][j]))) :\r\n        row.concat(this.tableau[i][j].sub(floor(this.tableau[i][j])))\r\n      );\r\n      columnsAdded ++;\r\n    }\r\n    const newTableau = this.tableau.map((row, i) => row.slice(0, this.n).concat(addedRows[i]).concat(row.slice(this.n)));\r\n    const newBaseVariables = this.baseVariables.map(v => v >= this.n ? v + columnsAdded : v);\r\n    const newPrimalLabels = this.primalLabels.slice(0, this.n)\r\n                .concat(range(columnsAdded).map(i => `x_{${this.initialN + this.addedOverall + i + 1}}`))\r\n                .concat(this.primalLabels.slice(this.n));\r\n    const newPrimalProgram = Program.fromTableau(this.n + columnsAdded, this.m, newTableau, newBaseVariables, newPrimalLabels);\r\n    return new DualGomory({\r\n      ...this,\r\n      n: this.n + columnsAdded,\r\n      columns: this.columns + columnsAdded,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      primalLabels: newPrimalLabels,\r\n      primalProgram: newPrimalProgram,\r\n      addedOverall: this.addedOverall + columnsAdded,\r\n    });\r\n  }\r\n\r\n  removeExtraColumns(cols) {\r\n    const [removedColumns, prefSum] = truePrefixSum(cols);\r\n    const newTableau = this.tableau.map(row => row.filter((v, j) => !cols[j]));\r\n    const newBaseVariables = this.baseVariables.map(v => v - prefSum[v]);\r\n    const newPrimalLabels = this.primalLabels.filter((l, i) => !cols[i]);\r\n    const newPrimalProgram = Program.fromTableau(this.n - removedColumns, this.m, newTableau, newBaseVariables, newPrimalLabels);\r\n    return new DualGomory({\r\n      ...this,\r\n      n: this.n - removedColumns,\r\n      columns: this.columns - removedColumns,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      primalLabels: newPrimalLabels,\r\n      primalProgram: newPrimalProgram,\r\n    })\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new DualGomory({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass AuxiliaryState extends BasicState {\r\n  constructor({auxiliaryProgram, savedObjective, ...args}) {\r\n    super({...args, addInfo: false});\r\n    this.auxiliaryProgram = auxiliaryProgram;\r\n    this.savedObjective = savedObjective;\r\n    this.addInformation();\r\n  }\r\n\r\n  static getFromBasicState(state) {\r\n    return new AuxiliaryState({\r\n      ...state,\r\n      auxiliaryProgram: Program.fromArrays(\r\n        state.primalProgram.A.map(r => Array.of(minusOne).concat(r)),\r\n        state.primalProgram.b,\r\n        Array.of(minusOne).concat(range(state.primalProgram.c.length).map(() => zero)),\r\n        \"primal\",\r\n        Array.of(\"x_{0}\").concat(state.primalLabels.slice(0, state.n)),\r\n      ),\r\n      tableau: state.tableau.map((row, i) => i === 0 ? \r\n        range(state.columns + 1).map(i => i === 0 ? one : zero) : \r\n        Array.of(minusOne).concat(row)),\r\n      n: state.n + 1,\r\n      columns: state.columns + 1,\r\n      primalLabels: Array.of(\"x_{0}\").concat(state.primalLabels),\r\n      baseVariables: state.baseVariables.map(x => x + 1),\r\n      savedObjective: state.tableau[0],\r\n      iter: 0,\r\n    });\r\n  }\r\n\r\n  getStatusMessage() {\r\n    if (this.primalFeasible && this.dualFeasible) {\r\n      if (this.primalSolution[0].equals(zero)) {\r\n        return 'The auxiliary LP is optimized and $x_0$ is equals to 0, so we can return to the original LP';\r\n      } else {\r\n        return 'The auxiliary LP is optimized, but $x_0$ is not equal to 0, so the original LP is infeasible';\r\n      }\r\n    } else if (this.iter === 0) {\r\n      if (this.dualFeasible)\r\n        return \"The primal solution is not feasible, pivot with $x_0$ as the entering variable and as the leaving the one with the lowest value in the current basic solution. Alternatively use the dual simplex algorithm.\";\r\n      return 'The primal solution is not feasible, pivot with $x_0$ as the entering variable and as the leaving the one with the lowest value in the current basic solution.';\r\n    } else {\r\n      return \"Optimize the auxiliary LP to find a feasible basic solution to the initial LP or determine that it is infeasible\";\r\n    }\r\n  }\r\n\r\n  getFirstPivotRow() {\r\n    let correctI = -1;\r\n    let minB = zero;\r\n    for (let k = 1; k <= this.m; k ++) {\r\n      if (last(this.tableau[k]).compare(minB) < 0) {\r\n        minB = last(this.tableau[k]);\r\n        correctI = k;\r\n      }\r\n    }\r\n    return correctI;\r\n  }\r\n\r\n  calculatePivots() {\r\n    const [primalPivots, primalUnbounded] = calculatePrimalPivots(this.tableau, this.isBase);\r\n    const [dualPivots  , dualUnbounded ] = calculateDualPivots(this.tableau);\r\n\r\n    this.suggestedPivots = {\r\n      \"none\": nonePivotSuggestion(this.tableau),\r\n      ...primalPivots,\r\n      ...dualPivots,\r\n    }\r\n\r\n    if (this.iter === 0) {\r\n      const row = this.getFirstPivotRow();\r\n      const auxiliaryPivot = this.tableau.map((r, i) => r.map((v, j) => (i === row && j === 0)));\r\n\r\n      this.suggestedPivots = {\r\n        ...this.suggestedPivots,\r\n        \"generic_primal\": { pivots: auxiliaryPivot, description: \"Generic pivot for primal simplex\"},\r\n        \"bland_primal\": { pivots: auxiliaryPivot, description: \"Bland's rule for primal simplex\"},\r\n      };\r\n    }\r\n    this.defaultSuggestion = \"bland_primal\";\r\n    this.primalUnbounded = primalUnbounded;\r\n    this.dualUnbounded  = dualUnbounded;\r\n  }\r\n\r\n  calculateTransitions() {\r\n    if (this.primalFeasible && this.dualFeasible && this.primalSolution[0].equals(zero)) {\r\n      this.transitions = [{ \r\n        label: \"Return to initial LP\", \r\n        args: \"none\",\r\n        getNewState: () => this.goBackToBasic() \r\n      }];\r\n    } else {\r\n      this.transitions = [];\r\n    }\r\n  }\r\n\r\n  goBackToBasic() {\r\n    const newTableau = this.tableau.map(r => r.slice(1));\r\n    newTableau[0] = this.savedObjective;\r\n  \r\n    return new FixBaseBasic({\r\n      ...this,\r\n      tableau: newTableau,\r\n      n: this.n - 1,\r\n      columns: this.columns - 1,\r\n      primalLabels: this.primalLabels.slice(1),\r\n      baseVariables: this.baseVariables.map(x => x - 1),\r\n      iter: this.outerIter + 1,\r\n    });\r\n  }\r\n\r\n  calculatePrograms() {\r\n    if (this.auxiliaryProgram === undefined) return;\r\n    this.programs = [{\r\n      name: \"Auxiliary LP\",\r\n      program: this.auxiliaryProgram,\r\n    },{\r\n      name: \"Dual auxiliary LP\",\r\n      program: this.auxiliaryProgram.setForm('dual'),\r\n    }];\r\n    this.defaultProgram = \"Auxiliary LP\";\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new AuxiliaryState({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass FarkasState extends BasicState {\r\n  constructor({...args}) {\r\n    super(args);\r\n  }\r\n  static getFromBasic(state) {\r\n    return new FarkasState({\r\n      ...state,\r\n      primalProgram: new Program({\r\n        ...state.primalProgram,\r\n        c: state.primalProgram.c.map(() => zero)\r\n      })\r\n    });\r\n  }\r\n\r\n  getStatusMessage() {\r\n    if (this.primalFeasible) {\r\n      return \"A feasible primal solution has been found.\";\r\n    } else if (this.dualUnbounded) {\r\n      return \"The initial LP is primal infeasible.\";\r\n    } else {\r\n      return \"Use dual simplex method to find a feasible primal solution.\";\r\n    }\r\n  }\r\n\r\n  calculatePivots() {\r\n    const dummyTableau = this.tableau.map((row, i) =>\r\n       i === 0 ? range(this.columns).map(() => zero) : row);\r\n    const [primalPivots, primalUnbounded] = calculatePrimalPivots(dummyTableau, this.isBase);\r\n    const [dualPivots  , dualUnbounded ] = calculateDualPivots(dummyTableau);\r\n\r\n    this.suggestedPivots = {\r\n      \"none\": nonePivotSuggestion(this.tableau),\r\n      ...primalPivots,\r\n      ...dualPivots,\r\n    }\r\n    this.primalUnbounded = primalUnbounded;\r\n    this.dualUnbounded  = dualUnbounded;\r\n  }\r\n\r\n  calculateTransitions() {\r\n    const thisRef = this;\r\n    if (this.primalFeasible) {\r\n      this.transitions = [\r\n      { \r\n        label: \"Go back to the initial LP\", \r\n        args: \"none\",\r\n        getNewState: () => new BasicState(thisRef) \r\n      }];\r\n    } else {\r\n      this.transitions = [];\r\n    }\r\n  }\r\n\r\n  calculateDisabled() {\r\n    this.disabledColumns = range(this.columns).map(() => false);\r\n    this.disabledRows = this.tableau.map(() => false);\r\n    this.disableObjectiveInvariant = true;\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new FarkasState({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass EqualityState extends BasicState {\r\n  constructor(args) {\r\n    super({...args, addInfo: false});\r\n    this.calculateDisabled();\r\n    this.hasBase = this.baseVariables.every((v, i) => v !== -1 || this.disabledRows[i + 1]);\r\n    this.infeasible = range(this.m, 1).some(i => range(this.n).every(j => this.tableau[i][j].equals(zero) || j === this.baseVariables[i-1]) \r\n                                            && last(this.tableau[i]).compare(zero) < 0);\r\n    this.addInformation();\r\n  }\r\n\r\n  static getFromProgram(program) {\r\n    let tableau = [\r\n      program.c.map(v => v.neg()).concat(\r\n        range(program.m + 1).map(() => zero))\r\n    ].concat(\r\n      program.A.map((row, i) =>\r\n        row.concat(\r\n          range(program.m).map(v => v === i ? (program.b[i].compare(zero) < 0 ? minusOne : one) : zero)\r\n        ).concat(program.b[i])\r\n      )\r\n    );\r\n    \r\n    const primalLabels = range(program.n).map(i => `x_{${i+1}}`)\r\n          .concat(range(program.m).map(i => `s_{${i+1}}`));\r\n    const dualLabels = range(program.m).map(i => `y_{${i+1}}`);\r\n    const baseVariables = range(program.m).map(() => -1);\r\n  \r\n    return new EqualityState({\r\n      tableau: tableau,\r\n      n: program.n,\r\n      m: program.m,\r\n      columns: program.n + program.m + 1,\r\n      primalLabels: primalLabels,\r\n      dualLabels: dualLabels,\r\n      baseVariables: baseVariables,\r\n      primalProgram: program.setForm('equality'),\r\n      iter: 0,\r\n    });\r\n  }\r\n\r\n  calculatePivots() {\r\n    const nonePivots = nonePivotSuggestion(this.tableau);\r\n    if (!this.hasBase || this.infeasible) {\r\n      this.suggestedPivots = {\r\n        \"none\": nonePivots,\r\n        ...emptyDualPivots(this.tableau),\r\n        ...emptyPrimalPivots(this.tableau),\r\n      }\r\n      this.defaultSuggestion = \"none\";\r\n      this.primalUnbounded = false;\r\n      this.dualUnbounded  = false;\r\n    } else {\r\n      const [primalPivots, primalUnbounded] = calculatePrimalPivots(this.tableau, this.isBase, true, this.n);\r\n      const [dualPivots  , dualUnbounded ] = calculateDualPivots(this.tableau, true, this.n);\r\n\r\n      this.suggestedPivots = {\r\n        \"none\": nonePivots,\r\n        ...primalPivots,\r\n        ...dualPivots,\r\n      }\r\n      this.defaultSuggestion = \"bland_primal\";\r\n      this.primalUnbounded = primalUnbounded;\r\n      this.dualUnbounded  = dualUnbounded;\r\n    }\r\n  }\r\n\r\n  getStatusMessage() {\r\n    if (this.infeasible) {\r\n      return \"The primal LP is infeasible.\"\r\n    } else if (!this.hasBase) {\r\n      if (this.iter === 0)\r\n        return \"Find a base by making pivots or using an auxiliary LP.\"\r\n      return \"Find a base by making pivots.\"\r\n    } else {\r\n      return standardStatusMessage(this, false, false, true);\r\n    }\r\n  }\r\n\r\n  calculateSolutions() {\r\n    this.primalFeasible = isNonNegative(this.tableau.slice(1).map(r => last(r)));\r\n    this.dualFeasible   = isNonNegative(this.tableau[0].slice(0, this.n));\r\n\r\n    this.primalSolution = range(this.n).map(() => zero);\r\n    for (let i = 0; i < this.m; i ++) {\r\n      if (this.baseVariables[i] !== -1 && this.baseVariables[i] < this.n)\r\n        this.primalSolution[this.baseVariables[i]] = last(this.tableau[i+1]);\r\n    }\r\n\r\n    this.dualSolution = Array(this.m);\r\n    for (let i = 0; i < this.m; i ++) {\r\n      this.dualSolution[i] = this.tableau[0][i + this.n];\r\n    }\r\n  }\r\n\r\n  calculateTransitions() {\r\n    if (!this.hasBase && this.iter === 0) {\r\n      this.transitions = [{ \r\n        label: \"Use an auxiliary LP\", \r\n        args: \"none\",\r\n        getNewState: () => EqualityFirstStage.getFromEqualityState(this) \r\n      }];\r\n    } else if (this.primalFeasible && this.dualFeasible && !isIntegral(this.dualSolution)\r\n               && this.primalProgram.isIntegral()) {\r\n      this.transitions = [dualGomoryCutTransition(this, cols => EqualityDualGomory.getFirstCut(this, cols))];\r\n    } else {\r\n      this.transitions = [];\r\n    }\r\n  }\r\n\r\n  calculateDisabled() {\r\n    this.disabledColumns = range(this.columns).map(i => i >= this.n && i < this.columns - 1);\r\n    this.disabledRows = range(this.m + 1).map(i => i > 0 && range(this.n).every(j => this.tableau[i][j].equals(zero)) \r\n                                                         && last(this.tableau[i]).equals(zero));\r\n    this.disableObjectiveInvariant = false;\r\n  }\r\n\r\n  canPivot(i, j) {\r\n    return !(j >= this.n || i === 0  ||\r\n            this.tableau[i][j].equals(zero) ||\r\n            this.isBase[j]);\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new EqualityState({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass EqualityFirstStage extends EqualityState {\r\n  constructor({savedObjective, ...args}) {\r\n    super({...args, addInfo: false});\r\n    this.savedObjective = savedObjective;\r\n    this.calculateSolutions();\r\n    \r\n    if (this.baseVariables.some(v => v === -1)) {\r\n      this.stage = 'base';\r\n    } else {\r\n      if (this.primalFeasible && this.dualFeasible) {\r\n        const invBaseVariables = inverseArray(this.baseVariables, this.n + this.m);\r\n        if (last(this.tableau[0]).compare(zero) < 0) {\r\n          this.stage = 'infeasible';\r\n        } else if (range(this.m, this.n).some(j => this.isBase[j] && \r\n            range(this.n).some(i => !this.tableau[invBaseVariables[j]+1][i].equals(zero)))) {\r\n          this.stage = 'rebase';\r\n        } else {\r\n          this.stage = 'done';\r\n        }\r\n      } else {\r\n        this.stage = 'optimize';\r\n      }\r\n    }\r\n\r\n    this.addInformation();\r\n  }\r\n\r\n  static getFromEqualityState(state) {\r\n    return new EqualityFirstStage({\r\n      ...state,\r\n      tableau: state.tableau.map((row, i) => i === 0 ? \r\n          row.map((v, j) => (j < state.n || j === state.columns - 1) ? zero : one) : row),\r\n      savedObjective: state.tableau[0],\r\n    });\r\n  }\r\n\r\n  calculateSolutions() {\r\n    this.primalFeasible = isNonNegative(this.tableau.slice(1).map(r => last(r)));\r\n    this.dualFeasible   = isNonNegative(this.tableau[0].slice(0, -1));\r\n\r\n    this.primalSolution = range(this.columns - 1).map(() => zero);\r\n    for (let i = 0; i < this.m; i ++) {\r\n      this.primalSolution[this.baseVariables[i]] = last(this.tableau[i+1]);\r\n    }\r\n\r\n    if (!this.primalProgram.equalityForm) {\r\n      this.dualSolution = Array(this.m);\r\n      for (let i = 0; i < this.m; i ++) {\r\n        this.dualSolution[i] = this.tableau[0][i + this.n];\r\n      }\r\n    }\r\n  }\r\n\r\n  getStatusMessage() {\r\n    if (this.stage === 'base') {\r\n      return \"Make pivots with slack variables to establish a base.\"\r\n    } else if (this.stage === 'done') {\r\n      return \"The LP is optimized. We can return to the initial LP.\"\r\n    } else if (this.stage === 'optimize') {\r\n      return \"Optimize the LP using the simplex method.\"\r\n    } else if (this.stage === 'rebase') {\r\n      return \"Remove the slack variables from base where possible.\"\r\n    } else if (this.stage === 'infeasible') {\r\n      return \"The initial LP is infeasible.\"\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  calculateTransitions() {\r\n    if (this.stage === 'done' && last(this.tableau[0]).equals(zero)) {\r\n      this.transitions = [{\r\n        label: \"Return to the initial LP\", \r\n        args: \"none\",\r\n        getNewState: () => this.goBack() \r\n      }];\r\n    } else {\r\n      this.transitions = [];\r\n    }\r\n  }\r\n\r\n  goBack() {\r\n    const newTableau = this.tableau.map((row, i) => i === 0 ? this.savedObjective : row);\r\n\r\n    return new FixBaseEquality({\r\n      ...this,\r\n      tableau: newTableau,\r\n    });\r\n  }\r\n\r\n  calculatePivots() {\r\n    if (this.stage !== 'optimize') {\r\n      this.suggestedPivots = {\r\n        \"none\": nonePivotSuggestion(this.tableau),\r\n        ...emptyDualPivots(this.tableau),\r\n        ...emptyPrimalPivots(this.tableau),\r\n      }\r\n      this.defaultSuggestion = \"none\";\r\n      this.primalUnbounded = false;\r\n      this.dualUnbounded  = false;\r\n    } else {\r\n      const [primalPivots, primalUnbounded] = calculatePrimalPivots(this.tableau, this.isBase);\r\n      const [dualPivots  , dualUnbounded ] = calculateDualPivots(this.tableau);\r\n\r\n      this.suggestedPivots = {\r\n        \"none\": nonePivotSuggestion(this.tableau),\r\n        ...primalPivots,\r\n        ...dualPivots,\r\n      }\r\n      this.defaultSuggestion = \"bland_primal\";\r\n      this.primalUnbounded = primalUnbounded;\r\n      this.dualUnbounded  = dualUnbounded;\r\n    }\r\n  }\r\n\r\n  calculateDisabled() {\r\n    this.disabledColumns = range(this.columns).map(() => false);\r\n    this.disabledRows = range(this.m + 1).map(() => false);\r\n    this.disableObjectiveInvariant = false;\r\n  }\r\n\r\n  canPivot(i, j) {\r\n    if (this.stage === 'base')\r\n      return (this.baseVariables[i-1] === -1) && (i === j - this.n + 1) && !this.isBase[j];\r\n    if (this.stage === 'optimize')\r\n      return !(j === this.columns - 1 || i === 0  ||\r\n        this.tableau[i][j].equals(zero) ||\r\n        this.isBase[j]);\r\n    if (this.stage === 'rebase') \r\n      return !(j === this.columns - 1 || i === 0  ||\r\n        this.tableau[i][j].equals(zero) ||\r\n        this.isBase[j]) && this.baseVariables[i-1] >= this.n && j < this.n;\r\n    return false;\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new EqualityFirstStage({\r\n      ...this,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass FixBaseEquality extends EqualityState {\r\n  constructor(args) {\r\n    super({...args, addInfo: false});\r\n    this.baseFixed = this.baseVariables.every(v => this.tableau[0][v].equals(zero));\r\n    this.addInformation();\r\n  }\r\n\r\n  getStatusMessage() {\r\n    if (this.baseFixed)\r\n      return \"The top row is fixed.\"\r\n    return \"Make pivots to represent the top row in the new base.\"\r\n  }\r\n\r\n  canPivot(i, j) {\r\n    return this.isBase[j] && !this.tableau[0][j].equals(zero) && this.tableau[i][j].equals(one);\r\n  }\r\n\r\n  calculatePivots() {\r\n    const availablePivots = this.tableau.map((row, i) => row.map((v, j) => this.canPivot(i, j)));\r\n    this.suggestedPivots = {\r\n      \"none\": { pivots: availablePivots, description: \"None\"},\r\n      \"generic_dual\": { pivots: availablePivots, description: \"Generic pivot for dual simplex\"},\r\n      \"bland_dual\": { pivots: availablePivots, description: \"Bland's rule for dual simplex\"},\r\n      \"generic_primal\": { pivots: availablePivots, description: \"Generic pivot for primal simplex\"},\r\n      \"bland_primal\": { pivots: availablePivots, description: \"Bland's rule for primal simplex\"},\r\n    };\r\n    this.defaultSuggestion = \"bland_primal\";\r\n    this.primalUnbounded = false;\r\n    this.dualUnbounded = false;\r\n  }\r\n\r\n  calculateTransitions() {\r\n    if (this.baseFixed) {\r\n      this.transitions = [{\r\n        label: \"Continue\", \r\n        args: \"none\",\r\n        getNewState: () => this.backToBasic()\r\n      }];\r\n    } else {\r\n      this.transitions = [];\r\n    }\r\n  }\r\n\r\n  backToBasic() {\r\n    return new EqualityState({...this});\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new FixBaseEquality({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    });\r\n  }\r\n}\r\n\r\nclass EqualityDualGomory extends EqualityState {\r\n  constructor({initialN, addedOverall, ...args}) {\r\n    super(args);\r\n    this.initialN = initialN;\r\n    this.addedOverall = addedOverall;\r\n\r\n    this.addInformation();\r\n  }\r\n\r\n  static getFirstCut(state, cols) {\r\n    return (new EqualityDualGomory({\r\n      ...state,\r\n      initialN: state.n,\r\n      addedOverall: 0,\r\n    })).addGomoryCuts(cols);\r\n  }\r\n\r\n  getStatusMessage() {\r\n    return standardStatusMessage(this, false, false, true);\r\n  }\r\n\r\n  calculateTransitions() {\r\n    if (this.primalUnbounded || this.dualUnbounded) {\r\n      this.transitions = [];\r\n    } else if (this.primalFeasible && this.dualFeasible) {\r\n      let res = [];\r\n\r\n      if (!isIntegral(this.dualSolution)) {\r\n        res.push(dualGomoryCutTransition(this, cols => this.addGomoryCuts(cols)));\r\n\r\n        const possibleToRemove = range(this.columns).map(i => i >= this.initialN && i < this.n && !this.isBase[i]);\r\n        if (possibleToRemove.some(v => v)) {\r\n          res.push({\r\n            label: \"Remove superfluous cuts\",\r\n            args: \"columns\",\r\n            prompt: \"Select columns to remove\",\r\n            allowed: possibleToRemove,\r\n            defaultSelection: range(this.columns).map(() => false),\r\n            validateArgs: validationFunction(possibleToRemove, \"column\", \"Only columns added with Gomory cuts that are not currently in the base can be removed.\"),\r\n            getNewState: cols => this.removeExtraColumns(cols)\r\n          })\r\n        }\r\n      }\r\n      this.transitions = res;\r\n    } else {\r\n      this.transitions = [];\r\n    }\r\n  }\r\n\r\n  addGomoryCuts(cols) {\r\n    let addedRows = range(this.m + 1).map(() => []);\r\n    let columnsAdded = 0;\r\n    for (let j = 0; j <= this.columns; j ++) {\r\n      if (!cols[j]) continue;\r\n      addedRows = addedRows.map((row, i) =>\r\n        i === 0 ? \r\n        row.concat(this.tableau[i][j].sub( ceil(this.tableau[i][j]))) :\r\n        row.concat(this.tableau[i][j].sub(floor(this.tableau[i][j])))\r\n      );\r\n      columnsAdded ++;\r\n    }\r\n    const newTableau = this.tableau.map((row, i) => row.slice(0, this.n).concat(addedRows[i]).concat(row.slice(this.n)));\r\n    const newBaseVariables = this.baseVariables.map(v => v >= this.n ? v + columnsAdded : v);\r\n    const newPrimalLabels = this.primalLabels.slice(0, this.n)\r\n                .concat(range(columnsAdded).map(i => `x_{${this.initialN + this.addedOverall + i + 1}}`))\r\n                .concat(this.primalLabels.slice(this.n));\r\n    const newPrimalProgram = Program.fromTableau(this.n + columnsAdded, this.m, newTableau, newBaseVariables, newPrimalLabels).setForm('equality');\r\n    return new EqualityDualGomory({\r\n      ...this,\r\n      n: this.n + columnsAdded,\r\n      columns: this.columns + columnsAdded,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      primalLabels: newPrimalLabels,\r\n      primalProgram: newPrimalProgram,\r\n      addedOverall: this.addedOverall + columnsAdded,\r\n    });\r\n  }\r\n\r\n  removeExtraColumns(cols) {\r\n    const [removedColumns, prefSum] = truePrefixSum(cols);\r\n    const newTableau = this.tableau.map(row => row.filter((v, j) => !cols[j]));\r\n    const newBaseVariables = this.baseVariables.map(v => v - prefSum[v]);\r\n    const newPrimalLabels = this.primalLabels.filter((l, i) => !cols[i]);\r\n    const newPrimalProgram = Program.fromTableau(this.n - removedColumns, this.m, newTableau, newBaseVariables, newPrimalLabels);\r\n    return new EqualityDualGomory({\r\n      ...this,\r\n      n: this.n - removedColumns,\r\n      columns: this.columns - removedColumns,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      primalLabels: newPrimalLabels,\r\n      primalProgram: newPrimalProgram,\r\n    })\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new EqualityDualGomory({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    });\r\n  }\r\n}","import { InlineMath } from 'react-katex'\r\nimport { range, zero, toLatex, isInSelection, isAllowedToSelect, last, isSecondarySelected } from './utils'\r\nimport './Tableau.scss'\r\n\r\nfunction TableauCell({\r\n  value,\r\n  position = \"inner\",\r\n  hidden = false,\r\n  showInvariant = false, \r\n  isBase = false,  \r\n  isCorner = false, \r\n  isHighlighted = false, \r\n  isDisabled = false,\r\n  isSelected = false,\r\n  isSelectable = false,\r\n  isSecondarySelected = false,\r\n  showPointer = true,\r\n  showSelection = false,\r\n  showDisabled = true,\r\n  useDecimal = true,\r\n  useMixed = false,\r\n  onClick = f => f, \r\n}) {\r\n  const isInner = position === 'inner';\r\n  const isNonNegative = value.compare(zero) >= 0;\r\n  const classes = [\r\n    \"tableau-cell\",\r\n    `cell-${position}`,\r\n    showInvariant &&  isNonNegative && !isDisabled ? \"invariant-holds\"  : \"\",\r\n    showInvariant && !isNonNegative && !isDisabled ? \"invariant-broken\" : \"\",\r\n    showPointer && \r\n        ((!isDisabled && isInner && !showSelection) ||\r\n        (showSelection && isSelectable))  ? \"clickable-cell\"      : \"\",\r\n    hidden                                ? \"hidden-cell\"         : \"\",\r\n    isCorner                              ? \"corner-cell\"         : \"\",\r\n    isBase && (isInner || !showInvariant) ? \"base-cell\"           : \"\",\r\n    isHighlighted && !showSelection       ? \"highlighted-cell\"    : \"\",\r\n    showSelection && isSelected           ? \"selected-cell\"       : \"\",\r\n    showSelection && !isSelectable        ? \"not-selectable-cell\" : \"\",\r\n    showSelection && isSecondarySelected  ? \"secondary-cell\"      : \"\",\r\n    showDisabled && !showSelection && \r\n      isDisabled                          ? \"disabled-cell\"       : \"\",\r\n  ].join(' ');\r\n  \r\n  return (\r\n    <td\r\n     className={classes}\r\n     onClick={onClick}\r\n    >\r\n      <InlineMath>{toLatex(value, useMixed, useDecimal)}</InlineMath>\r\n    </td>\r\n  );\r\n}\r\n\r\nfunction cornerCell({state, position, settings, onCellClick}) {\r\n  const {showSelection, selection} = settings;\r\n  return <TableauCell \r\n    value={last(state.tableau[0])}\r\n    position={position}\r\n    isSelected={showSelection && isInSelection(0, state.columns - 1, selection)}\r\n    isSelectable={showSelection && isAllowedToSelect(0, state.columns - 1, selection)}\r\n    isSecondarySelected={showSelection && isSecondarySelected(0, state.columns - 1, selection, state)}\r\n    onClick={() => onCellClick(0, state.columns - 1)}\r\n    {...settings}\r\n  />;\r\n}\r\n\r\nfunction bCell({state, i, position, settings, onCellClick}) {\r\n  const {showSelection, highlightInvariants, selection} = settings;\r\n  return <TableauCell \r\n    value={last(state.tableau[i])}\r\n    position={position}\r\n    showInvariant={highlightInvariants}\r\n    isDisabled={state.disabledRows[i]}\r\n    isSelected={showSelection && isInSelection(i, state.columns - 1, selection)}\r\n    isSelectable={showSelection && isAllowedToSelect(i, state.columns - 1, selection)}\r\n    isSecondarySelected={showSelection && isSecondarySelected(i, state.columns - 1, selection, state)}\r\n    onClick={() => onCellClick(i, state.columns - 1)}\r\n    {...settings}\r\n  />;\r\n}\r\n\r\nfunction objectiveRow({state, position, settings, onCellClick}) {\r\n  const {showSelection, highlightInvariants, selection, showBColumnsLeft, showSlackLeft, showBase, highlightBase} = settings;\r\n  return <tr>\r\n    <td></td>\r\n    {!showBColumnsLeft ? null :\r\n      cornerCell({state, position: `${position}-left`, settings, onCellClick})}\r\n    {!showSlackLeft ? null : range(state.m).map(j => \r\n      <TableauCell \r\n        key={state.n + j}\r\n        value={state.tableau[0][state.n + j]}\r\n        position={position}\r\n        showInvariant={highlightInvariants && !state.disableObjectiveInvariant}\r\n        hidden={state.isBase[state.n + j] && !state.disabledColumns[state.n + j] && !showBase}\r\n        isDisabled={state.disabledColumns[state.n + j]}\r\n        isBase={state.isBase[state.n + j] && highlightBase}\r\n        isSelected={showSelection && isInSelection(0, state.n + j, selection)}\r\n        isSelectable={showSelection && isAllowedToSelect(0, state.n + j, selection)}\r\n        isSecondarySelected={showSelection && isSecondarySelected(0, state.n + j, selection, state)}\r\n        onClick={() => onCellClick(0, state.n + j)}\r\n        {...settings}\r\n      />\r\n    )}\r\n    {range(state.n).map(j => \r\n      <TableauCell \r\n        key={j}\r\n        value={state.tableau[0][j]}\r\n        position={position}\r\n        showInvariant={highlightInvariants && !state.disableObjectiveInvariant}\r\n        hidden={state.isBase[j] && !state.disabledColumns[j] && !showBase}\r\n        isDisabled={state.disabledColumns[j]}\r\n        isBase={state.isBase[j] && highlightBase}\r\n        isSelected={showSelection && isInSelection(0, j, selection)}\r\n        isSelectable={showSelection && isAllowedToSelect(0, j, selection)}\r\n        isSecondarySelected={showSelection && isSecondarySelected(0, j, selection, state)}\r\n        onClick={() => onCellClick(0, j)}\r\n        {...settings}\r\n      />\r\n    )}\r\n    {showSlackLeft ? null : range(state.m).map(j => \r\n      <TableauCell \r\n        key={j}\r\n        value={state.tableau[0][state.n + j]}\r\n        position={position}\r\n        showInvariant={highlightInvariants && !state.disableObjectiveInvariant}\r\n        hidden={state.isBase[state.n + j] && !state.disabledColumns[state.n + j] && !showBase}\r\n        isDisabled={state.disabledColumns[state.n + j]}\r\n        isBase={state.isBase[state.n + j] && highlightBase}\r\n        isSelected={showSelection && isInSelection(0, state.n + j, selection)}\r\n        isSelectable={showSelection && isAllowedToSelect(0, state.n + j, selection)}\r\n        isSecondarySelected={showSelection && isSecondarySelected(0, state.n + j, selection, state)}\r\n        onClick={() => onCellClick(0, state.n + j)}\r\n        {...settings}\r\n      />\r\n    )}\r\n    {showBColumnsLeft ? null :\r\n      cornerCell({state, position: `${position}-right`, settings, onCellClick})}\r\n  </tr>;\r\n}\r\n\r\nfunction innerCell({state, i, j, settings, onCellClick}) {\r\n  const {showSelection, selection, highlightBase, showBase, highlightedPivots} = settings;\r\n  return <TableauCell \r\n    key={j}\r\n    value={state.tableau[i][j]}\r\n    hidden={state.isBase[j] && !state.disabledColumns[j] && !showBase}\r\n    isBase={state.isBase[j] && !state.disabledColumns[j] && highlightBase}\r\n    isHighlighted={state.suggestedPivots[highlightedPivots].pivots[i][j]}\r\n    isSelected={showSelection && isInSelection(i, j, selection)}\r\n    isSelectable={showSelection && isAllowedToSelect(i, j, selection)}\r\n    isSecondarySelected={showSelection && isSecondarySelected(i, j, selection, state)}\r\n    isDisabled={!state.canPivot(i, j)}\r\n    onClick={() => onCellClick(i, j)}\r\n    {...settings}\r\n  />;\r\n}\r\n\r\nfunction TableauDisplay({\r\n  state, \r\n  onCellClick = f => f, \r\n  highlightedPivots = \"none\", \r\n  highlightBase = true,\r\n  highlightInvariants = true,\r\n  useDecimal = true,\r\n  useMixed = false,\r\n  showBase = true,\r\n  selection = null,\r\n  showPointer = true,\r\n  showDisabled = false,\r\n  showObjectiveBottom = false,\r\n  showBColumnsLeft = false,\r\n  showSlackLeft = false,\r\n}) {\r\n  const showSelection = selection !== null;\r\n  const settings = {highlightedPivots, highlightBase, highlightInvariants, useDecimal, useMixed, showBase, showSelection,\r\n                    selection, showPointer, showDisabled, showObjectiveBottom, showBColumnsLeft, showSlackLeft};\r\n  return (\r\n    <div className=\"tableau-box\">\r\n      <table className=\"tableau-table\">\r\n        <tbody>\r\n          {showObjectiveBottom ? null :\r\n            objectiveRow({state, position: \"top\", settings, onCellClick})\r\n          }\r\n          {range(state.m, 1).map(i => \r\n            <tr key={i}>\r\n              <td>\r\n                <InlineMath>\r\n                  {i === 0 ? \"\" : \r\n                    (state.baseVariables[i-1] < 0\r\n                    || state.disabledColumns[state.baseVariables[i-1]]\r\n                    || state.disabledRows[i]) ? \"-\"  :\r\n                    state.primalLabels[state.baseVariables[i-1]]}\r\n                </InlineMath>\r\n              </td>\r\n              {!showBColumnsLeft ? null :\r\n                bCell({state, i, position: \"left\", settings, onCellClick})}\r\n              {!showSlackLeft ? null : range(state.m, state.n).map(j => \r\n                innerCell({state, i, j, settings, onCellClick})\r\n              )}\r\n              {range(state.n).map(j => \r\n                innerCell({state, i, j, settings, onCellClick})\r\n              )}\r\n              {showSlackLeft ? null : range(state.m, state.n).map(j => \r\n                innerCell({state, i, j, settings, onCellClick})\r\n              )}\r\n              {showBColumnsLeft ? null :\r\n                bCell({state, i, position: \"right\", settings, onCellClick})}\r\n            </tr>\r\n          )}\r\n          {!showObjectiveBottom ? null :\r\n            objectiveRow({state, position: \"bottom\", settings, onCellClick})}\r\n          <tr>\r\n            <td></td>\r\n            {showBColumnsLeft ? <td></td> : null}\r\n            {!showSlackLeft ? null : range(state.m).map(j => \r\n              <td key={state.n + j}>\r\n                <InlineMath>\r\n                  {state.primalLabels[state.n + j]}\r\n                </InlineMath>\r\n              </td>\r\n            )}\r\n            {range(state.n).map(j => \r\n              <td key={j}>\r\n                <InlineMath>\r\n                  {state.primalLabels[j]}\r\n                </InlineMath>\r\n              </td>\r\n            )}\r\n            {showSlackLeft ? null : range(state.m).map(j => \r\n              <td key={state.n + j}>\r\n                <InlineMath>\r\n                  {state.primalLabels[state.n + j]}\r\n                </InlineMath>\r\n              </td>\r\n            )}\r\n            {!showBColumnsLeft ? <td></td> : null}\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport { TableauDisplay };","import Program from './Program'\r\n\r\nconst examples = [\r\n  {\r\n    name: \"Standard 1\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 1, 3],\r\n        [2, 2, 5],\r\n        [4, 1, 2]\r\n      ],\r\n      [30, 24, 36],\r\n      [3, 1, 2],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Standard 2\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 1],\r\n        [1, 0],\r\n        [0, 1]\r\n      ],\r\n      [20, 12, 16],\r\n      [18, 12.5],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Initial solution not feasible\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [2, -1],\r\n        [1, -5]\r\n      ],\r\n      [2, -4],\r\n      [2, -1],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Initial solution not feasible 2\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [-2, \"-7.5\", 3],\r\n        [-20, -5, -3],\r\n      ],\r\n      [-10000, -30000],\r\n      [-1, -1, -1],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Infeasible\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [-1, -1, 0],\r\n        [0, -1, -1],\r\n        [1, 2, 1],\r\n      ],\r\n      [-2, -3, 4],\r\n      [1, 1, 1],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Primal unbounded\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, -1, 1],\r\n        [-2, 1, 0],\r\n        [0, 1, -2]\r\n      ],\r\n      [5, 3, 5],\r\n      [0, 2, 1],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Dual unbounded\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [-1, 2, -1],\r\n        [6, -1, 2],\r\n      ],\r\n      [-1, -1],\r\n      [0, 0, -3],\r\n      \"dual\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Gomory cuts for primal LP\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [-1, 1],\r\n        [8, 2],\r\n      ],\r\n      [2, 17],\r\n      [\"5.5\", \"2.1\"],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Gomory cuts for primal LP no solution\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [3, 2],\r\n        [-2, -3],\r\n        [1, -3],\r\n        [-1, 3]\r\n      ],\r\n      [3, -1, 0, 2],\r\n      [1, 1],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Equality Form\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 1, 1],\r\n        [2, 2, 5],\r\n      ],\r\n      [5, 16],\r\n      [3, 4, 2],\r\n      \"equality\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Equality Form 2\",\r\n    program: Program.fromArrays(\r\n      [ \r\n        [-3, -2, 4], \r\n        [-1, -1, 4], \r\n        [3, -3, 0] \r\n      ],\r\n      [-10, -4, 0],\r\n      [1, 1, 1],\r\n      \"equality\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Equality infeasible\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 1, 1],\r\n        [2, 2, 5],\r\n      ],\r\n      [12, 16],\r\n      [3, 1, 2],\r\n      \"equality\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Equality redundant row\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 1],\r\n        [2, 3],\r\n        [3, 4],\r\n      ],\r\n      [4, 9, 13],\r\n      [1, 1],\r\n      \"equality\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Equality redundant row 2\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 1, 1, 3],\r\n        [2, 3, 1, 2],\r\n        [3, 4, 2, 5],\r\n      ],\r\n      [4, 9, 13],\r\n      [1, 1, 1, 1],\r\n      \"equality\"\r\n    )\r\n  },\r\n]\r\n\r\nexport default examples;","// import Fraction from 'fraction.js/bigfraction'\r\nimport Fraction from 'fraction.js'\r\nimport React, { useState } from 'react';\r\nimport { InlineMath } from 'react-katex';\r\nimport { getStateFromProgram } from './SimplexState'\r\nimport { TableauDisplay } from './TableauDisplay'\r\nimport Program from './Program';\r\nimport examples from './examples'\r\nimport { cutToLength, range, zero, updateArr, updateArr2D } from './utils'\r\nimport './Input.scss'\r\nimport 'katex/dist/katex.min.css'\r\n\r\nconst MAX_N = 7;\r\nconst MAX_M = 7;\r\n\r\nfunction checkInput(input) {\r\n  const re = /^-?((\\d+(\\/[1-9]\\d*)?)|(\\d*\\.\\d+)|(\\d+\\.))$/;\r\n  return re.test(input);\r\n}\r\n\r\nfunction InputField({value, onChange, ending}) { \r\n  return (\r\n    <div className=\"input-field\">\r\n      <input \r\n        className={checkInput(value) ? \"correct-input\" : \"wrong-input\"}\r\n        value={value}\r\n        onChange={e => onChange(e.target.value)}\r\n      />\r\n      <span className=\"label\">\r\n        <InlineMath>\r\n          {ending}\r\n        </InlineMath>\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ExampleLoading({examplesList, selected, onChange}) {\r\n  function update(val) {\r\n    onChange(val, parseInt(val) !== -1 ? examplesList[val].program : null);\r\n  }\r\n\r\n  return (\r\n    <div className=\"input-row\">\r\n      <label htmlFor=\"example\">Example:</label>\r\n      <select \r\n        id=\"example\"\r\n        value={selected}\r\n        onChange={e => update(e.target.value)}\r\n      >\r\n        <option value={-1}>Custom</option>\r\n        {examplesList.map((e, i) =>\r\n          <option\r\n            key={i}\r\n            value={i}\r\n          >{e.name}</option>\r\n        )}\r\n      </select>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ProgramInput({onFinish}) {\r\n  const [state, setState] = useState({\r\n    program: Program.zeroProgram(2, 1),\r\n    fieldsA: [[\"0\", \"0\"]],\r\n    fieldsB: [\"0\"],\r\n    fieldsC: [\"0\", \"0\"],\r\n    fieldN: \"2\",\r\n    fieldM: \"1\",\r\n    selectedExample: -1,\r\n  });\r\n\r\n  const updateSize = (fn, fm) => {\r\n    let n = parseInt(fn);\r\n    let m = parseInt(fm);\r\n    n = isNaN(n) ? state.program.n : Math.max(Math.min(n, MAX_N), 1);\r\n    m = isNaN(m) ? state.program.m : Math.max(Math.min(m, MAX_M), 1);\r\n    \r\n    setState({\r\n      ...state,\r\n      program: state.program.updateSize(n, m),\r\n      fieldsA: cutToLength(\r\n        state.fieldsA.map(row => cutToLength(row, n, () => \"0\")), \r\n        m, () => range(n).map(i => \"0\")),\r\n      fieldsB: cutToLength(state.fieldsB, m, () => \"0\"),\r\n      fieldsC: cutToLength(state.fieldsC, n, () => \"0\"),\r\n      fieldN: fn,\r\n      fieldM: fm,\r\n    });\r\n  }\r\n\r\n  const adjustSizeFields = () => {\r\n    let n = parseInt(state.fieldN);\r\n    let m = parseInt(state.fieldM);\r\n    n = isNaN(n) ? state.program.n : Math.max(Math.min(n, MAX_N), 1);\r\n    m = isNaN(m) ? state.program.m : Math.max(Math.min(m, MAX_M), 1);\r\n\r\n    updateSize(n.toString(), m.toString());\r\n  }\r\n\r\n  const updateA = (i, j, val) => {\r\n    setState({\r\n      ...state, \r\n      program: state.program.updateA(i, j, checkInput(val) ? new Fraction(val) : zero),\r\n      fieldsA: updateArr2D(state.fieldsA, i, j, val),\r\n      selectedExample: -1\r\n    });\r\n  }\r\n  const updateB = (i, val)    => { \r\n    setState({\r\n      ...state, \r\n      program: state.program.updateB(i, checkInput(val) ? new Fraction(val) : zero),\r\n      fieldsB: updateArr(state.fieldsB, i, val),\r\n      selectedExample: -1\r\n    });\r\n  }\r\n  const updateC = (j, val)    => {\r\n    setState({\r\n      ...state, \r\n      program: state.program.updateC(j, checkInput(val) ? new Fraction(val) : zero),\r\n      fieldsC: updateArr(state.fieldsC, j, val),\r\n      selectedExample: -1\r\n    });\r\n  }\r\n\r\n  const setForm = newForm => {\r\n    setState({\r\n      ...state,\r\n      program: state.program.setForm(newForm),\r\n      selectedExample: -1\r\n    })\r\n  }\r\n\r\n  function reset() {\r\n    setState({\r\n      ...state,\r\n      program: Program.zeroProgram(2, 1),\r\n      fieldsA: [[\"0\", \"0\"]],\r\n      fieldsB: [\"0\"],\r\n      fieldsC: [\"0\", \"0\"],\r\n      fieldN: \"2\",\r\n      fieldM: \"1\",\r\n      selectedExample: -1\r\n    });\r\n  }\r\n\r\n  function selectExample(exampleNum, program) {\r\n    if (program === null) {\r\n      setState({\r\n        ...state,\r\n        selectedExample: exampleNum\r\n      });\r\n    } else {\r\n      setState({\r\n        ...state,\r\n        program: program,\r\n        fieldsA: program.A.map(row => row.map(v => v.toFraction())),\r\n        fieldsB: program.b.map(v => v.toFraction()),\r\n        fieldsC: program.c.map(v => v.toFraction()),\r\n        fieldN: program.n.toString(),\r\n        fieldM: program.m.toString(),\r\n        selectedExample: exampleNum\r\n      });  \r\n    }\r\n  }\r\n\r\n  const isDual = state.program.isDual();\r\n  const isEquality = state.program.isEquality();\r\n\r\n  return (\r\n    <>\r\n    <ExampleLoading \r\n      examplesList={examples}\r\n      selected={state.selectedExample}\r\n      onChange={selectExample}\r\n    />\r\n    <div className=\"input-row\">\r\n      <label htmlFor=\"n\">{\"Variables:\"}</label>\r\n      <input \r\n        type=\"number\"\r\n        id=\"n\"\r\n        min=\"1\"\r\n        max={isDual ? MAX_M : MAX_N}\r\n        value={isDual ? state.fieldM : state.fieldN}\r\n        onChange={isDual ? (e => updateSize(state.fieldN, e.target.value)) :\r\n                           (e => updateSize(e.target.value, state.fieldM))}\r\n        onBlur={adjustSizeFields}\r\n        required\r\n      />\r\n      <label htmlFor=\"m\">{isEquality ? \"Equalities\" : \"Inequalities:\"}</label>\r\n      <input \r\n        type=\"number\"\r\n        id=\"m\"\r\n        min=\"1\"\r\n        max={isDual ? MAX_N : MAX_M}\r\n        value={isDual ? state.fieldN : state.fieldM}\r\n        onChange={isDual ? (e => updateSize(e.target.value, state.fieldM)) :\r\n                           (e => updateSize(state.fieldN, e.target.value))}\r\n        onBlur={adjustSizeFields}\r\n        required\r\n      />\r\n      <label htmlFor=\"form\">Form:</label>\r\n      <select \r\n        id=\"form\"\r\n        value={state.program.form}\r\n        onChange={e => setForm(e.target.value)}\r\n      >\r\n          <option value=\"primal\">Standard form</option>\r\n          <option value=\"dual\">Dual to standard form</option>\r\n          <option value=\"equality\">Equality form</option>\r\n          <option value=\"equality_dual\">Dual to equality form</option>\r\n      </select>\r\n    </div>\r\n    <div className=\"input-row\">\r\n      <button onClick={() => onFinish(state.program)}>Finish</button>\r\n      <button onClick={reset}>Reset</button>\r\n    </div>\r\n    <div style={{clear: \"both\"}}></div>\r\n    <table id=\"input-table\"><tbody>\r\n      <tr>\r\n        <td className=\"min-max\"><InlineMath>{isDual ? \"min\" : \"max\"}</InlineMath></td>\r\n        {range(isDual ? state.program.m : state.program.n).map(i =>\r\n          <React.Fragment key={i}>\r\n            <td>\r\n              <InputField\r\n                value={isDual ? state.fieldsB[i] : state.fieldsC[i]}\r\n                onChange={isDual ? (val => updateB(i, val)) : (val => updateC(i, val))}\r\n                ending={state.program.labels[i]}\r\n              />\r\n            </td>\r\n            <td>\r\n              <InlineMath>\r\n                {(i !== (isDual ? state.program.m : state.program.n) - 1 ? \"+\" : \"\")}\r\n              </InlineMath>\r\n            </td>\r\n          </React.Fragment>\r\n        )}\r\n      </tr>\r\n      {range(isDual ? state.program.n : state.program.m).map(i =>\r\n        <tr key={i}>\r\n          <td></td>\r\n          {range(isDual ? state.program.m : state.program.n).map(j =>\r\n            <React.Fragment key={j}>\r\n              <td key={j}>\r\n                <InputField\r\n                  value={isDual ? state.fieldsA[j][i] : state.fieldsA[i][j]}\r\n                  onChange={val => updateA(isDual ? j : i, isDual ? i : j, val)}\r\n                  ending={state.program.labels[j]}\r\n                />\r\n              </td>\r\n              <td>\r\n                <InlineMath>\r\n                  {(j !== (isDual ? state.program.m : state.program.n) - 1 ? \"+\" : \r\n                          (isDual ? \"\\\\geq\" : isEquality ? \"=\" : \"\\\\leq\"))}\r\n                </InlineMath>\r\n              </td>\r\n            </React.Fragment>\r\n          )}\r\n          <td>\r\n            <InputField\r\n              key={i}\r\n              value={isDual ? state.fieldsC[i] : state.fieldsB[i]}\r\n              onChange={isDual ? (val => updateC(i, val)) : (val => updateB(i, val))}\r\n              ending=\"\"\r\n            />\r\n          </td>\r\n        </tr>\r\n      )}\r\n      {(isEquality && isDual) ? <tr><td></td></tr> :\r\n        <tr>\r\n          <td \r\n            colSpan={2 * (isDual ? state.program.m : state.program.n)}\r\n            className=\"variable-list\"\r\n          >\r\n            <InlineMath>{state.program.labels.join(',')}</InlineMath>\r\n          </td>\r\n          <td><InlineMath>\\geq</InlineMath></td>\r\n          <td><InlineMath>0</InlineMath></td>\r\n        </tr>}\r\n    </tbody></table>\r\n    <TableauDisplay\r\n      state={getStateFromProgram(state.program)}\r\n      showPointer={false}\r\n    />\r\n    </>\r\n  );\r\n}\r\n\r\n\r\nexport { ProgramInput };","import './Layout.scss'\r\n\r\nexport function Pane({name, label, children}) {\r\n  return (\r\n    <div className=\"pane\">\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function MultiPane({chosen, setChosen, children}) {\r\n  const filteredChildren = children.flat().filter(c => c !== null);\r\n  return (\r\n    <div className={\"multi-pane\"}>\r\n      <div className={\"pane-list\"}>\r\n        {filteredChildren.map((child, i) =>\r\n          <div\r\n            key={i} \r\n            className={`pane-button ${chosen === child.props.name ? \"pane-button-selected\" : \"\"}`}\r\n            onClick={() => setChosen(child.props.name)}\r\n          >\r\n            {child.props.label}\r\n          </div>\r\n        )}\r\n        <div style={{clear: \"both\"}}></div>\r\n      </div>\r\n      {filteredChildren.map((child, i) =>\r\n        <div key={i} className={`${chosen !== child.props.name ? \"pane-hidden\" : \"\"}`}>\r\n          {child}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function SplitPane({children}) {\r\n  return (\r\n    <div className=\"split-pane\">\r\n      <div className=\"split\">{children[0]}</div>\r\n      <div className=\"split-border\"></div>\r\n      <div className=\"split\">{children[1]}</div>\r\n    </div>\r\n  );\r\n}","import { InlineMath } from 'react-katex';\r\nimport { range, zero, one, minusOne, toLatex } from './utils'\r\nimport './Program.scss'\r\n\r\nfunction Monomial({\r\n  value, \r\n  label, \r\n  first = false, \r\n  firstNonZero = false, \r\n  lastInEmptyRow = false,\r\n  useDecimal = true,\r\n  useMixed = true,\r\n}) {\r\n  return first ? (\r\n    <td>\r\n      <InlineMath>{\r\n        lastInEmptyRow         ? \"0\"         :\r\n        value.equals(zero)     ? \"\"          : \r\n        value.equals(one)      ? label       :\r\n        value.equals(minusOne) ? `-${label}` :\r\n        `${toLatex(value, useMixed, useDecimal)} ${label}`\r\n      }</InlineMath>\r\n    </td>\r\n  ) : (\r\n    <>\r\n      <td className=\"operator\">\r\n        <InlineMath>{\r\n          value.equals(zero)      ? \"\"  : \r\n          value.compare(zero) < 0 ? \"-\" :\r\n          !firstNonZero           ? \"+\" : \"\"\r\n        }</InlineMath>\r\n      </td>\r\n      <td>\r\n        <InlineMath>{\r\n          lastInEmptyRow          ? \"0\"   :\r\n          value.equals(zero)      ? \"\"    :\r\n          value.abs().equals(one) ? label : \r\n          `${toLatex(value.abs(), useMixed, useDecimal)} ${label}`\r\n        }</InlineMath>\r\n      </td>\r\n    </>\r\n  );\r\n}\r\n\r\nexport function ProgramDisplay({program, useDecimal, useMixed}) {\r\n  // console.log(program);\r\n  function getFirstNonZeroIndex(arr) {\r\n    return arr.map(v => !v.equals(zero)).indexOf(true);\r\n  }\r\n  const isDual = program.isDual()\r\n  const showPrimal = !isDual;\r\n  const isEquality = program.isEquality();\r\n  const firstNonZero = showPrimal ?\r\n    range(program.m).map(i => getFirstNonZeroIndex(program.A[i])) :\r\n    range(program.n).map(j => \r\n      getFirstNonZeroIndex(range(program.m).map(i => program.A[i][j])));\r\n  const firstNonZeroInTopRow = getFirstNonZeroIndex(showPrimal ? program.c : program.b);\r\n  return (\r\n    <table className=\"program-display\">\r\n      <tbody>\r\n        <tr>\r\n          <td><InlineMath>{showPrimal ? \"max\" : \"min\"}</InlineMath></td>\r\n          {range(showPrimal ? program.n : program.m).map(i =>\r\n            <Monomial\r\n              key={i}\r\n              value={showPrimal ? program.c[i] : program.b[i]}\r\n              first={i === 0}\r\n              label={program.labels[i]}\r\n              firstNonZero={i === firstNonZeroInTopRow}\r\n              lastInEmptyRow={i === (showPrimal ? program.n : program.m) - 1 \r\n                              && firstNonZeroInTopRow === -1}\r\n              useDecimal={useDecimal}\r\n              useMixed={useMixed}\r\n            />\r\n          )}\r\n        </tr>\r\n        {range(showPrimal ? program.m : program.n).map(i =>\r\n          <tr key={i}>\r\n            <td></td>\r\n            {range(showPrimal ? program.n : program.m).map(j =>\r\n              <Monomial\r\n                key={j}\r\n                value={showPrimal ? program.A[i][j] : program.A[j][i]}\r\n                first={j === 0}\r\n                label={program.labels[j]}\r\n                firstNonZero={j === firstNonZero[i]}\r\n                lastInEmptyRow={j === (showPrimal ? program.n : program.m) - 1 \r\n                                && firstNonZero[i] === -1}\r\n                useDecimal={useDecimal}\r\n                useMixed={useMixed}\r\n              />\r\n            )}\r\n            <td><InlineMath>{isDual ? \"\\\\geq\" : isEquality ? \"=\" : \"\\\\leq\"}</InlineMath></td>\r\n            <td>\r\n              <InlineMath>\r\n                {toLatex(showPrimal ? program.b[i] : program.c[i], useMixed, useDecimal)}\r\n              </InlineMath>\r\n            </td>\r\n          </tr>\r\n        )}\r\n        {program.form === \"equality_dual\" ? null :\r\n        <tr>\r\n          <td colSpan={showPrimal ? 2 * program.n : 2 * program.m}>\r\n            <InlineMath>\r\n              {program.labels.join(\", \")}\r\n            </InlineMath>\r\n          </td>\r\n          <td><InlineMath>\\geq</InlineMath></td>\r\n          <td><InlineMath>0</InlineMath></td>\r\n        </tr>}\r\n      </tbody>\r\n    </table>\r\n  );\r\n}\r\n\r\nexport function SlackForm({tableau, useDecimal, useMixed}) {\r\n  const nonBasicColumns = range(tableau.columns - 1).filter(i => !tableau.isBase[i]);\r\n  return (\r\n    <table className=\"program-display\">\r\n      <tbody>\r\n        <tr>\r\n          <td><InlineMath>z</InlineMath></td>\r\n          <td><InlineMath>=</InlineMath></td>\r\n          <td><InlineMath>{toLatex(tableau.tableau[0][tableau.columns-1], useMixed, useDecimal)}</InlineMath></td>\r\n          {nonBasicColumns.map(i =>\r\n            <Monomial\r\n              key={i}\r\n              value={tableau.tableau[0][i].neg()}\r\n              label={tableau.primalLabels[i]}\r\n              useDecimal={useDecimal}\r\n              useMixed={useMixed}\r\n            />\r\n          )}\r\n        </tr>\r\n        {range(tableau.m).map(i =>\r\n          <tr key={i}>\r\n            <td><InlineMath>{tableau.baseVariables[i] >= 0 ? tableau.primalLabels[tableau.baseVariables[i]] : \"0\"}</InlineMath></td>\r\n            <td><InlineMath>=</InlineMath></td>\r\n            <td><InlineMath>{tableau.tableau[i+1][tableau.columns-1].toLatex()}</InlineMath></td>\r\n            {nonBasicColumns.map(j =>\r\n              <Monomial\r\n                key={j}\r\n                value={tableau.tableau[i+1][j].neg()}\r\n                label={tableau.primalLabels[j]}\r\n                useDecimal={useDecimal}\r\n                useMixed={useMixed}\r\n              />\r\n            )}\r\n          </tr>\r\n        )}\r\n      </tbody>\r\n    </table>\r\n  )\r\n}","import React, { useState } from 'react';\r\nimport { InlineMath } from 'react-katex'\r\nimport Switch from \"react-switch\";\r\nimport { Pane, MultiPane, SplitPane } from './Layout'\r\nimport { range, copyArr, toLatex, flipSelection, isAllowedToSelect } from './utils'\r\nimport { getStateFromProgram } from './SimplexState'\r\nimport { ProgramDisplay, SlackForm } from './ProgramDisplay'\r\nimport { TableauDisplay } from './TableauDisplay'\r\nimport './Tableau.scss'\r\nimport './Input.scss'\r\n\r\nfunction SolutionDisplay({\r\n  title,\r\n  labels, \r\n  solution, \r\n  toShow = solution.length, \r\n  feasible, \r\n  useDecimal = true, \r\n  useMixed = false,\r\n}) {\r\n  return (\r\n    <div className=\"solution\">\r\n      <div className=\"solution-header\">{title} \r\n        {feasible ?\r\n          <span colSpan={toShow} className=\"highlight-pos\">Feasible</span> :\r\n          <span colSpan={toShow} className=\"highlight-neg\">Infeasible</span>\r\n        }\r\n      </div>\r\n      <div className=\"inner\">\r\n        <table className=\"solution-table\">\r\n          <tbody>\r\n            <tr>\r\n              {range(toShow).map(i => \r\n                <td key={i}><InlineMath>{labels[i]}</InlineMath></td>\r\n              )}\r\n            </tr>\r\n            <tr>\r\n              {range(toShow).map(i => \r\n                <td key={i}><InlineMath>{toLatex(solution[i], useMixed, useDecimal)}</InlineMath></td>\r\n              )}\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction SelectSetting({name, currentValue, options, onChange}) {\r\n  return (\r\n    <div className=\"setting\">\r\n      <select \r\n        className=\"setting-select\"\r\n        name={name}\r\n        value={currentValue}\r\n        onChange={e => onChange(e.target.value)}\r\n      >\r\n        {options.map((option, i) =>\r\n          <option \r\n            key={i}\r\n            value={option.value}\r\n          >\r\n            {option.label}\r\n          </option>\r\n        )}\r\n      </select>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction SwitchSetting({name, description, currentValue, onChange, color}) {\r\n  return (\r\n    <div className=\"setting\">\r\n      <div className=\"switch\">\r\n        <Switch \r\n          id={name}\r\n          height={25}\r\n          width={50}\r\n          onChange={val => onChange(val)} \r\n          onColor={color}\r\n          checked={currentValue}\r\n        />\r\n      </div>\r\n      <label \r\n        htmlFor={name}\r\n        className=\"description\"\r\n      >\r\n        {description}\r\n      </label>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Settings({settings, setSetting, availablePivots}) {\r\n  return (\r\n    <div id=\"settings\">\r\n      <div className=\"setting-pivot\">\r\n        <div className=\"header\">Suggested Pivots</div>\r\n        <SelectSetting \r\n          name=\"highlighted_pivot\"\r\n          description=\"Suggested\"\r\n          currentValue={settings.highlightedPivots}\r\n          options={Object.entries(availablePivots).map(s => ({ value: s[0], label: s[1].description }))}\r\n          onChange={newValue => setSetting(\"highlightedPivots\", newValue)}\r\n        />\r\n      </div>\r\n      <div className=\"setting-base\">\r\n        <div className=\"header\">Base columns</div>\r\n        <SwitchSetting \r\n          name=\"highlight_base\"\r\n          color=\"#88c5ff\"\r\n          description=\"Highlight base columns\"\r\n          currentValue={settings.highlightBase}\r\n          onChange={newValue => setSetting(\"highlightBase\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"show_base\"\r\n          color=\"#88c5ff\"\r\n          description=\"Show base columns\"\r\n          currentValue={settings.showBase}\r\n          onChange={newValue => setSetting(\"showBase\", newValue)}\r\n        />\r\n      </div>\r\n      <div className=\"setting-other\">\r\n        <div className=\"header\">Other settings</div>\r\n        <SwitchSetting \r\n          name=\"highlight_invariants\"\r\n          color=\"#6cd875\"\r\n          description=\"Highlight invariants\"\r\n          currentValue={settings.highlightInvariants}\r\n          onChange={newValue => setSetting(\"highlightInvariants\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"use_decimal\"\r\n          color=\"#6cd875\"\r\n          description=\"Use decimal fractions\"\r\n          currentValue={settings.useDecimal}\r\n          onChange={newValue => setSetting(\"useDecimal\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"use_mixed\"\r\n          color=\"#6cd875\"\r\n          description=\"Use mixed fractions\"\r\n          currentValue={settings.useMixed}\r\n          onChange={newValue => setSetting(\"useMixed\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"show_disabled\"\r\n          color=\"#6cd875\"\r\n          description=\"Darken cells where pivot cannot be done\"\r\n          currentValue={settings.showDisabled}\r\n          onChange={newValue => setSetting(\"showDisabled\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"objective_at_bottom\"\r\n          color=\"#6cd875\"\r\n          description=\"Display objective function row at the bottom\"\r\n          currentValue={settings.showObjectiveBottom}\r\n          onChange={newValue => setSetting(\"showObjectiveBottom\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"b_column_on_left\"\r\n          color=\"#6cd875\"\r\n          description=\"Display the b column on the left\"\r\n          currentValue={settings.showBColumnsLeft}\r\n          onChange={newValue => setSetting(\"showBColumnsLeft\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"slack_on_left\"\r\n          color=\"#6cd875\"\r\n          description=\"Display the slack variables on the left\"\r\n          currentValue={settings.showSlackLeft}\r\n          onChange={newValue => setSetting(\"showSlackLeft\", newValue)}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction InteractiveTableau({initialProgram, onStartOver}) {\r\n  const [state, setState] = useState({\r\n    stateHistory: [getStateFromProgram(initialProgram)],\r\n    index: 0,\r\n    settings: {\r\n      highlightedPivots: \"bland_primal\",\r\n      highlightBase: true,\r\n      showBase: true,\r\n      highlightInvariants: true,\r\n      useDecimal: true,\r\n      useMixed: false,\r\n      showDisabled: true,\r\n      showObjectiveBottom: false,\r\n      showBColumnsLeft: false,\r\n      showSlackLeft: false,\r\n    },\r\n    selectedProgram: null,\r\n    currentTransition: null\r\n  });\r\n\r\n  const currentTableau = state.stateHistory[state.index]; \r\n  let highlightedPivots = state.settings.highlightedPivots;\r\n  if (!(highlightedPivots in currentTableau.suggestedPivots)) {\r\n    highlightedPivots = currentTableau.defaultSuggestion;\r\n    setSetting(\"highlightedPivots\", currentTableau.defaultSuggestion);\r\n  }\r\n  let selectedProgram = state.selectedProgram;\r\n  if (!currentTableau.programs.map(p => p.name).concat(\"slack\").some(n => n === selectedProgram)) {\r\n    console.log(`old selected program ${selectedProgram}`);\r\n    selectedProgram = currentTableau.defaultProgram;\r\n    setState({...state, selectedProgram});\r\n    console.log(`setting selected program ${selectedProgram}`);\r\n    console.log(currentTableau.programs.map(p => p.name).concat(\"slack\"));\r\n  }\r\n\r\n  // console.log(state);\r\n  console.log(currentTableau);\r\n\r\n  function goToPrevious() { setState({ ...state, index: state.index - 1, currentTransition: null }); }\r\n  function goToNext()     { setState({ ...state, index: state.index + 1, currentTransition: null }); }\r\n\r\n  function appendTableau(newTab) {\r\n    setState({\r\n      ...state,\r\n      stateHistory: state.stateHistory.slice(0, state.index + 1).concat(newTab),\r\n      index: state.index + 1,\r\n      currentTransition: null\r\n    })\r\n  }\r\n\r\n  function handleCellClick(i, j) {\r\n    if (state.currentTransition === null) {\r\n      if (currentTableau.canPivot(i, j))\r\n        appendTableau(currentTableau.pivot(i, j));  \r\n    } else {\r\n      if (isAllowedToSelect(i, j, state.currentTransition.selection)) {\r\n        setState({\r\n          ...state,\r\n          currentTransition: {\r\n            ...state.currentTransition,\r\n            selection: flipSelection(i, j, state.currentTransition.selection)\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  function makeTransition(transition) {\r\n    if (transition.args === \"none\")\r\n      appendTableau(transition.getNewState());\r\n    else {\r\n      setState({\r\n        ...state,\r\n        currentTransition: {\r\n          getNewState: transition.getNewState,\r\n          validateArgs: transition.validateArgs,\r\n          prompt: transition.prompt,\r\n          selection: {\r\n            type: transition.args,\r\n            selected: copyArr(transition.defaultSelection),\r\n            allowed: transition.allowed,\r\n          },\r\n          errorMessage: null\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  function finishTransition() {\r\n    const args = state.currentTransition.selection.selected;\r\n    const [correct, error] = state.currentTransition.validateArgs(args);\r\n    if (correct) {\r\n      appendTableau(state.currentTransition.getNewState(args));\r\n    } else {\r\n      setState({\r\n        ...state,\r\n        currentTransition: {\r\n          ...state.currentTransition,\r\n          errorMessage: error\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  function cancelTransition() {\r\n    setState({\r\n      ...state,\r\n      currentTransition: null,\r\n    })\r\n  }\r\n\r\n  function selectAll() {\r\n    setState({\r\n      ...state,\r\n      currentTransition: {\r\n        ...state.currentTransition,\r\n        selection: {\r\n          ...state.currentTransition.selection,\r\n          selected: copyArr(state.currentTransition.selection.allowed)\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  function setSetting(setting, value) {\r\n    setState({\r\n      ...state,\r\n      settings: {\r\n        ...state.settings,\r\n        [setting]: value\r\n      }\r\n    })\r\n  }\r\n\r\n  return (\r\n    <div id=\"inner-wrapper\">\r\n      <div id=\"tab-and-controls\">\r\n        <div id=\"controls\">\r\n          <button\r\n            onClick={goToPrevious}\r\n            disabled={state.index === 0}\r\n          >\r\n            Previous\r\n          </button>\r\n          <span id=\"counter\">{`${state.index+1} / ${state.stateHistory.length}`}</span>\r\n          <button\r\n            onClick={goToNext}\r\n            disabled={state.index === state.stateHistory.length - 1}\r\n          >\r\n            Next\r\n          </button>\r\n        </div>\r\n        <TableauDisplay\r\n          state={currentTableau}\r\n          onCellClick={handleCellClick}\r\n          showDisabled={true}\r\n          selection={state.currentTransition === null ? null : state.currentTransition.selection}\r\n          {...state.settings}\r\n          highlightedPivots={highlightedPivots}\r\n        />\r\n        <div id=\"message\">\r\n          {state.currentTransition === null ?\r\n          (<>\r\n            <p>{currentTableau.statusMessage.split(\"$\").map((subMsg, i) => \r\n                i % 2 === 0 ? subMsg : (<InlineMath>{subMsg}</InlineMath>))}</p>\r\n            {currentTableau.transitions.map((transition, i) => \r\n              <button \r\n                key={i} \r\n                className=\"inline-button\"\r\n                onClick={() => makeTransition(transition)}>\r\n                  {transition.label}\r\n              </button>\r\n            )}\r\n          </>) :\r\n          (<>\r\n            {state.currentTransition.prompt}\r\n            <button onClick={finishTransition} className=\"inline-button\">Done</button>\r\n            <button onClick={selectAll} className=\"inline-button\">Select All</button>\r\n            <button onClick={cancelTransition} className=\"inline-button\">Cancel</button>\r\n            {state.currentTransition.errorMessage === null ? null :\r\n              <p className=\"highlight-neg\">{state.currentTransition.errorMessage}</p>\r\n            }\r\n          </>)\r\n          }\r\n        </div>\r\n      </div>\r\n      <div id=\"sidebar\">\r\n        <Settings\r\n          settings={{...state.settings, highlightedPivots: highlightedPivots}}\r\n          availablePivots={currentTableau.suggestedPivots}\r\n          setSetting={setSetting}\r\n        />\r\n        <button onClick={onStartOver} id=\"start-over\">Start over with a new LP</button>\r\n      </div>\r\n      <SplitPane>\r\n        <SolutionDisplay\r\n          title={\"Primal solution\"}\r\n          labels={currentTableau.primalLabels}\r\n          solution={currentTableau.primalSolution}\r\n          feasible={currentTableau.primalFeasible}\r\n          {...state.settings}\r\n        />\r\n        <SolutionDisplay\r\n          title={\"Dual solution\"}\r\n          labels={currentTableau.dualLabels}\r\n          solution={currentTableau.dualSolution}\r\n          feasible={currentTableau.dualFeasible}\r\n          {...state.settings}\r\n        />\r\n      </SplitPane>\r\n      <MultiPane\r\n        chosen={selectedProgram}\r\n        setChosen={choice => setState({...state, selectedProgram: choice})}\r\n      >\r\n        {currentTableau.programs.map(({name, program}, i) =>\r\n          <Pane \r\n            key={i}\r\n            name={name}\r\n            label={name}\r\n          >\r\n            <ProgramDisplay\r\n              program={program}\r\n              {...state.settings}\r\n            />\r\n          </Pane>\r\n        )}\r\n        {currentTableau.isEquality ? null :\r\n        <Pane\r\n          name=\"slack\"\r\n          label=\"Slack Form\"\r\n        >\r\n          <SlackForm\r\n            tableau={currentTableau}\r\n            {...state.settings}\r\n          />\r\n        </Pane>}\r\n      </MultiPane>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport { InteractiveTableau };","import './App.scss';\r\nimport { useState } from 'react';\r\nimport { ProgramInput } from './Input'\r\nimport { InteractiveTableau } from './InteractiveTableau'\r\n\r\nfunction App() {\r\n  const [initialProgram, setInitialProgram] = useState(null);\r\n  if (initialProgram === null) {\r\n    return (\r\n      <div id=\"wrapper\">\r\n        <ProgramInput \r\n          onFinish={(program) => setInitialProgram(program)}\r\n        />\r\n      </div>\r\n    );\r\n  } else {\r\n    return (\r\n      <div id=\"wrapper\">\r\n        <InteractiveTableau\r\n          initialProgram={initialProgram}\r\n          onStartOver={() => setInitialProgram(null)}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.scss';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}
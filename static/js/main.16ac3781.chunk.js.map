{"version":3,"sources":["utils.js","pivots.js","Program.js","SimplexState.js","TableauDisplay.js","examples.js","Input.js","Layout.js","ProgramDisplay.js","InteractiveTableau.js","App.js","reportWebVitals.js","index.js"],"names":["zero","Fraction","one","minusOne","isInteger","fraction","divisible","isIntegral","arr","every","v","isNonNegative","compare","range","n","st","Array","keys","map","i","copyArr","copyArr2D","r","addArrays","a","b","add","scaleArray","mul","last","length","truePrefixSum","reduce","sum","prefSum","push","listToBoolArray","size","res","inverseArray","cutToLength","len","getDefault","slice","concat","updateArr2D","j","val","newArr","updateArr","frMod","mod","floor","sub","ceil","maxFactor","f","exp","fct","decimalFraction","den","d","e2","f2","e5","rep","toString","padStart","s","toLatex","excludeWhole","useDecimal","isAllowedToSelect","selection","type","allowed","isInSelection","selected","isSecondarySelected","state","baseVariables","flipSelection","value","setSelection","pivot","tableau","newTableau","inverse","k","neg","newBaseVariables","nonePivotSuggestion","pivots","row","description","emptyPrimalPivots","emptyDualPivots","calculatePrimalPivots","baseColumns","disallowSlack","results","foundBland","unbounded","minDelta","maxI","div","equals","calculateDualPivots","x","minRatio","minJ","ratio","abs","getZeroFraction","Program","m","A","c","form","labels","this","Acopy","bcopy","ccopy","isBase","invBaseVariables","getStateFromProgram","program","EqualityState","getFromProgram","BasicState","validationFunction","selectedPart","allowedErrorMessage","args","isArray","e","includes","primalGomoryCutTransition","func","label","prompt","defaultSelection","validateArgs","getNewState","dualGomoryCutTransition","columns","standardStatusMessage","canStart","allowPrimalCut","allowDualCut","primalUnbounded","dualUnbounded","iter","primalFeasible","dualFeasible","canPrimalCut","primalSolution","canDualCut","dualSolution","primalProgram","primalLabels","dualLabels","addInfo","dualProgram","setForm","setLabels","addInformation","AuxiliaryState","getFromBasicState","FarkasState","getFromBasic","rows","PrimaryGomory","getFirstCut","cols","DualGomory","calculateSolutions","calculatePivots","calculatePrograms","calculateDisabled","transitions","getPossibleTransitions","primalPivots","dualPivots","suggestedPivots","defaultSuggestion","equalityForm","programs","name","defaultProgram","disabledColumns","disabledRows","disableObjectiveInvariant","FixBaseBasic","baseFixed","backToBasic","availablePivots","canPivot","addedOverall","initialN","initialM","addGomoryCuts","possibleToRemove","some","removeExtraColumns","rowsUsed","col","tab","newRow","newPrimalLabels","newDualLabels","newPrimalProgram","fromTableau","removedColumns","filter","l","addedRows","columnsAdded","auxiliaryProgram","savedObjective","correctI","minB","getFirstPivotRow","auxiliaryPivot","goBackToBasic","outerIter","undefined","fromArrays","of","dummyTableau","thisRef","hasBase","infeasible","nonePivots","EqualityDualGomory","EqualityFirstStage","getFromEqualityState","stage","goBack","FixBaseEquality","TableauCell","position","hidden","showInvariant","isCorner","isHighlighted","isDisabled","isSelected","isSelectable","showPointer","showSelection","showDisabled","useMixed","onClick","isInner","classes","join","className","cornerCell","settings","onCellClick","bCell","highlightInvariants","objectiveRow","showBColumnsLeft","showSlackLeft","showBase","highlightBase","innerCell","highlightedPivots","TableauDisplay","showObjectiveBottom","examples","checkInput","input","test","InputField","onChange","ending","target","ExampleLoading","examplesList","update","parseInt","htmlFor","id","ProgramInput","onFinish","useState","zeroProgram","fieldsA","fieldsB","fieldsC","fieldN","fieldM","selectedExample","setState","updateSize","fn","fm","isNaN","Math","max","min","adjustSizeFields","updateB","updateC","console","log","isDual","isEquality","exampleNum","toFraction","onBlur","required","newForm","style","clear","Fragment","updateA","colSpan","Pane","children","MultiPane","defaultChoice","chosen","setChosen","choice","filteredChildren","flat","props","child","SplitPane","Monomial","first","firstNonZero","lastInEmptyRow","ProgramDisplay","getFirstNonZeroIndex","indexOf","showPrimal","firstNonZeroInTopRow","SlackForm","nonBasicColumns","SolutionDisplay","title","solution","toShow","feasible","SelectSetting","currentValue","options","option","SwitchSetting","color","height","width","onColor","checked","Settings","setSetting","Object","entries","newValue","InteractiveTableau","initialProgram","onStartOver","stateHistory","index","selectedProgram","currentTransition","currentTableau","appendTableau","newTab","setting","disabled","getStatusMessage","split","subMsg","transition","errorMessage","makeTransition","correct","error","App","setInitialProgram","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.16ac3781.chunk.js","sourcesContent":["// import Fraction from 'fraction.js/bigfraction'\r\nimport Fraction from 'fraction.js'\r\n\r\nexport const zero     = new Fraction(\"0\");\r\nexport const one      = new Fraction(\"1\");\r\nexport const minusOne = new Fraction(\"-1\");\r\n\r\nexport const isInteger = fraction => fraction.divisible(one);\r\nexport const isIntegral = arr => arr.every(v => isInteger(v));\r\nexport const isIntegral2D = arr => arr.every(r => isIntegral(r));\r\nexport const isNonNegative = arr => arr.every(v => v.compare(zero) >= 0);\r\n\r\nexport const range = (n, st=0) => [...Array(n).keys()].map(i => i + st);\r\n\r\nexport const copyArr = arr => [...arr];\r\nexport const copyArr2D = arr => arr.map(r => copyArr(r));\r\n\r\nexport const addArrays  = (a, b) => a.map((v, i) => v.add(b[i]));\r\nexport const scaleArray = (v, a) => v.map(v => v.mul(a));\r\n\r\nexport const last = arr => arr[arr.length - 1];\r\n\r\nexport const countTrue = arr => arr.reduce((count, v) => v ? count + 1 : count, 0);\r\nexport const truePrefixSum = arr => arr.reduce(\r\n                                    ([sum, prefSum], v) => {\r\n                                      sum = v ? sum + 1 : sum;\r\n                                      prefSum.push(sum);\r\n                                      return [sum, prefSum];\r\n                                    }, [0, []]);\r\n\r\nexport const listToBoolArray = (arr, size) => arr.reduce(\r\n                                              (res, v) => {\r\n                                                if (v >= 0) res[v] = true; return res;\r\n                                              }, range(size).map(() => false));\r\n\r\nexport const inverseArray = (arr, size) => arr.reduce(\r\n                                            (res, v, i) => {\r\n                                              if (v >= 0) res[v] = i; return res;\r\n                                            }, range(size).map(() => -1));\r\n\r\nexport const cutToLength = (arr, len, getDefault) => {\r\n  if (arr.length >= len) {\r\n      return arr.slice(0, len);\r\n  }\r\n  return copyArr(arr).concat(\r\n    range(len - arr.length).map(i => getDefault()));\r\n}\r\n\r\nexport const updateArr2D = (arr, i, j, val) => {\r\n  const newArr = copyArr2D(arr);\r\n  newArr[i][j] = val;\r\n  return newArr;\r\n}\r\n\r\nexport const updateArr = (arr, i, val) => {\r\n  const newArr = copyArr(arr);\r\n  newArr[i] = val;\r\n  return newArr;\r\n}\r\n\r\nexport const frMod = (a, b) => a.mod(b).add(b).mod(b);\r\nexport const floor = a => a.sub(frMod(a, one));\r\nexport const ceil  = a => a.add(frMod(one.sub(frMod(a, one)), one));\r\n\r\nconst maxFactor = (f, val) => {\r\n  let exp = 0;\r\n  let fct = 1;\r\n  while (val % f === 0) {\r\n    fct = fct * f;\r\n    val /= f;\r\n    exp ++;\r\n  } \r\n  return [exp, fct];\r\n}\r\n\r\nexport const decimalFraction = val => {\r\n  const den = val.d;\r\n  let [e2, f2] = maxFactor(2, den);\r\n  let [e5, f5] = maxFactor(5, den);\r\n  if (den / (f2 * f5) !== 1) return null;\r\n  let res = val.n;\r\n  while (e2 < e5) { e2 ++; res *= 2; }\r\n  while (e5 < e2) { e5 ++; res *= 5; }\r\n  let rep = res.toString().padStart(e2 + 1, '0');\r\n  return (val.s === -1 ? \"-\" : \"\") + (e2 === 0 ? rep : `${rep.slice(0, -e2)}.${rep.slice(-e2)}`);\r\n}\r\n\r\nexport const toLatex = (val, excludeWhole=false, useDecimal=true) => {\r\n  if (useDecimal) {\r\n    const rep = decimalFraction(val);\r\n    if (rep !== null) return rep;\r\n  }\r\n  return val.toLatex(excludeWhole);\r\n}\r\n\r\nexport function isAllowedToSelect(i, j, selection) {\r\n  switch (selection.type) {\r\n    case \"rows\":\r\n      return selection.allowed[i];\r\n    case \"columns\":\r\n    case \"base_columns\":\r\n      return selection.allowed[j];\r\n    case \"cells\":\r\n      return selection.allowed[i][j];\r\n    default:\r\n      return false;\r\n  }\r\n}\r\n\r\nexport function isInSelection(i, j, selection) {\r\n  switch (selection.type) {\r\n    case \"rows\":\r\n      return selection.selected[i];\r\n    case \"columns\":\r\n    case \"base_columns\":\r\n      return selection.selected[j];\r\n    case \"cells\":\r\n      return selection.selected[i][j];\r\n    default:\r\n      return false;\r\n  }\r\n}\r\n\r\nexport function isSecondarySelected(i, j, selection, state) {\r\n  return selection.type === 'base_columns' && i > 0 && selection.selected[state.baseVariables[i-1]];\r\n}\r\n\r\nexport function setSelection(i, j, selection, value) {\r\n  switch (selection.type) {\r\n    case \"rows\":\r\n      return {...selection, selected: updateArr(selection.selected, i, value)};\r\n    case \"columns\":\r\n    case \"base_columns\":\r\n      return {...selection, selected: updateArr(selection.selected, j, value)};\r\n    case \"cells\":\r\n      return {...selection, selected: updateArr2D(selection.selected, i, j, value)};\r\n    default:\r\n      return {...selection};\r\n  }\r\n}\r\n\r\nexport function flipSelection(i, j, selection) {\r\n  return setSelection(i, j, selection, !isInSelection(i, j, selection));\r\n}","import { copyArr, copyArr2D, zero, scaleArray, addArrays, last} from './utils'\r\n\r\nexport function pivot(tableau, baseVariables, i, j) {\r\n  const newTableau = copyArr2D(tableau);\r\n  newTableau[i] = scaleArray(newTableau[i], newTableau[i][j].inverse());\r\n  for (let k = 0; k < newTableau.length; k ++) {\r\n    if (k !== i) {\r\n      newTableau[k] = addArrays(newTableau[k], scaleArray(newTableau[i], newTableau[k][j].neg()));\r\n    }\r\n  }\r\n\r\n  const newBaseVariables = copyArr(baseVariables);\r\n  newBaseVariables[i - 1] = j;\r\n  \r\n  return [newTableau, newBaseVariables];\r\n}\r\n\r\nexport function nonePivotSuggestion(tableau) {\r\n  return { pivots: tableau.map(row => row.map(() => false)), description: \"None\"};\r\n}\r\n\r\nexport function emptyPrimalPivots(tableau) {\r\n  return {\r\n    \"generic_primal\": { pivots: tableau.map(row => row.map(() => false)), \r\n                        description: \"Generic pivot for primal simplex\" },\r\n    \"bland_primal\"  : { pivots: tableau.map(row => row.map(() => false)), \r\n                        description: \"Bland's rule for primal simplex\" },\r\n  }\r\n}\r\n\r\nexport function emptyDualPivots(tableau) {\r\n  return {\r\n    \"generic_dual\": { pivots: tableau.map(row => row.map(() => false)), \r\n                      description: \"Generic pivot for dual simplex\" },\r\n    \"bland_dual\"  : { pivots: tableau.map(row => row.map(() => false)), \r\n                      description: \"Bland's rule for dual simplex\" },\r\n  };\r\n}\r\n\r\nexport function calculatePrimalPivots(tableau, baseColumns, disallowSlack=false, n=null) {\r\n  const results = emptyPrimalPivots(tableau);\r\n\r\n  if (!tableau.slice(1).every(row => last(row).compare(zero) >= 0)) \r\n    return [results, false];\r\n\r\n  let foundBland = false;\r\n  let unbounded = false;\r\n  for (let j = 0; j < tableau[0].length - 1; j ++) {\r\n    if (baseColumns[j] || tableau[0][j].compare(zero) >= 0) continue;\r\n    let minDelta = null;\r\n    let maxI = null;\r\n    for (let i = 1; i < tableau.length; i ++) {\r\n      if (tableau[i][j].compare(zero) <= 0) continue;\r\n      if (minDelta === null || minDelta.compare(last(tableau[i]).div(tableau[i][j])) > 0) {\r\n        minDelta = last(tableau[i]).div(tableau[i][j]);\r\n        maxI = i;\r\n      }\r\n    }\r\n    if (minDelta === null) {\r\n      unbounded = true;\r\n      continue;\r\n    }\r\n    for (let i = 1; i < tableau.length; i ++) {\r\n      if (tableau[i][j].compare(zero) <= 0) continue;\r\n      if (minDelta.equals(last(tableau[i]).div(tableau[i][j]))) {\r\n        results[\"generic_primal\"].pivots[i][j] = true;\r\n      }\r\n    }\r\n    if (!foundBland) {\r\n      foundBland = true;\r\n      results[\"bland_primal\"].pivots[maxI][j] = true;\r\n    }\r\n  }\r\n  if (disallowSlack) {\r\n    results[\"generic_primal\"].pivots = results[\"generic_primal\"].pivots.map(row => row.map((v, j) => j < n && v));\r\n    results[\"bland_primal\"].pivots = results[\"bland_primal\"].pivots.map(row => row.map((v, j) => j < n && v));\r\n  }\r\n  return [results, unbounded];\r\n}\r\n\r\nexport function calculateDualPivots(tableau, disallowSlack=false, n=null) {\r\n  const results = emptyDualPivots(tableau);\r\n  if (!tableau[0].slice(0, -1).every(x => x.compare(zero) >= 0))\r\n    return [results, false];\r\n\r\n  let foundBland = false;\r\n  let unbounded = false;\r\n\r\n  for (let i = 1; i < tableau.length; i ++) {\r\n    if (last(tableau[i]).compare(0) >= 0) continue;\r\n    let minRatio = null;\r\n    let minJ = null;\r\n    for (let j = 0; j < tableau[i].length - 1; j ++) {\r\n      if (tableau[i][j].compare(zero) >= 0) continue;\r\n      const ratio = tableau[0][j].div(tableau[i][j]).abs();\r\n      if (minRatio === null || ratio.compare(minRatio) < 0) {\r\n        minRatio = ratio;\r\n        minJ = j;\r\n      }\r\n    }\r\n    if (minRatio === null) {\r\n      unbounded = true;\r\n      continue;\r\n    }\r\n    for (let j = 0; j < tableau[i].length - 1; j ++) {\r\n      if (tableau[i][j].compare(zero) >= 0) continue;\r\n      if (minRatio.equals(tableau[0][j].div(tableau[i][j]).abs())) {\r\n        results[\"generic_dual\"].pivots[i][j] = true;\r\n      }\r\n    }\r\n    if (!foundBland) {\r\n      foundBland = true;\r\n      results[\"bland_dual\"].pivots[i][minJ] = true;\r\n    }\r\n  }\r\n  if (disallowSlack) {\r\n    results[\"generic_dual\"].pivots = results[\"generic_dual\"].pivots.map(row => row.map((v, j) => j < n && v));\r\n    results[\"bland_dual\"].pivots = results[\"bland_dual\"].pivots.map(row => row.map((v, j) => j < n && v));\r\n  }\r\n  return [results, unbounded];\r\n}","import { range, copyArr, copyArr2D, zero, last, cutToLength, isIntegral, isIntegral2D, updateArr2D, updateArr, listToBoolArray, inverseArray } from './utils'\r\nimport { pivot } from './pivots'\r\n// import Fraction from 'fraction.js/bigfraction'\r\nimport Fraction from 'fraction.js'\r\n\r\nconst getZeroFraction = () => zero;\r\nconst getZeroRow = len => () => range(len).map(() => zero);\r\n\r\nexport default class Program {\r\n  constructor({n, m, A, b, c, form, labels=null}) {\r\n    this.n = n;\r\n    this.m = m;\r\n    this.A = A;\r\n    this.b = b;\r\n    this.c = c;  \r\n    this.form = form;\r\n    this.labels = labels !== null ? labels :\r\n      form === 'primal' || form === \"equality\" ? \r\n        range(n).map(i => `x_{${i + 1}}`) : range(m).map(i => `y_{${i + 1}}`);\r\n  }\r\n\r\n  static zeroProgram(n, m) {\r\n    return new Program({n: n, m: m, \r\n      A: range(m).map(() => range(n).map(() => zero)),\r\n      b: range(m).map(() => zero),\r\n      c: range(n).map(() => zero),\r\n      form: 'primal',\r\n    });\r\n  }\r\n\r\n  static fromArrays(A, b, c, form='primal', labels=null) {\r\n    return new Program({n: c.length, m: b.length, \r\n      A: A.map(r => r.map(v => Fraction(v))),\r\n      b: b.map(v => Fraction(v)),\r\n      c: c.map(v => Fraction(v)),\r\n      form: form,\r\n      labels: labels\r\n    });\r\n  }\r\n\r\n  static fromTableau(n, m, tableau, baseVariables, labels) {\r\n    let isBase = listToBoolArray(baseVariables, n + m);\r\n\r\n    for (let j = 0; j < m; j ++) {\r\n      if (isBase[n + j]) continue;\r\n\r\n      for (let i = 1; i <= m; i ++) {\r\n        if (!tableau[i][n + j].equals(zero) && baseVariables[i-1] < n) {\r\n          [tableau, baseVariables] = pivot(tableau, baseVariables, i, n + j);\r\n          isBase = listToBoolArray(baseVariables, n + m);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    const invBaseVariables = inverseArray(baseVariables, n + m);\r\n    tableau = [tableau[0]].concat(range(m).map(j => tableau[invBaseVariables[n + j]+1]));\r\n\r\n    return new Program({\r\n      n: n, m: m,\r\n      A: range(m).map(i => range(n).map(j => tableau[i+1][j])),\r\n      b: range(m).map(i => last(tableau[i+1])),\r\n      c: range(n).map(j => tableau[0][j].neg()),\r\n      form: 'primal',\r\n      labels: labels.slice(0, n),\r\n    })\r\n  }\r\n\r\n  isDual() {\r\n    return this.form === 'dual' || this.form === 'equality_dual';\r\n  }\r\n\r\n  isEquality() {\r\n    return this.form === 'equality' || this.form === 'equality_dual';\r\n  }\r\n\r\n  copy() {\r\n    return new Program({\r\n      ...this,\r\n      A: copyArr2D(this.A),\r\n      b: copyArr(this.b),\r\n      c: copyArr(this.c),\r\n    });\r\n  }\r\n\r\n  updateSize(n, m) {\r\n    const Acopy = cutToLength(\r\n        this.A.map(row => cutToLength(row, n, getZeroFraction)), \r\n        m, getZeroRow(n));\r\n    const bcopy = cutToLength(this.b, m, getZeroFraction);\r\n    const ccopy = cutToLength(this.c, n, getZeroFraction);\r\n\r\n    return new Program({n: n, m: m, A: Acopy, b: bcopy, c: ccopy, form: this.form});\r\n  }\r\n\r\n  updateA(i, j, val) {\r\n    return new Program({\r\n      ...this,\r\n      A: updateArr2D(this.A, i, j, val)\r\n    })\r\n  }\r\n\r\n  updateB(i, val) {\r\n    return new Program({\r\n      ...this,\r\n      b: updateArr(this.b, i, val)\r\n    })\r\n  }\r\n\r\n  updateC(j, val) {\r\n    return new Program({\r\n      ...this,\r\n      c: updateArr(this.c, j, val)\r\n    })\r\n  }\r\n\r\n  setForm(f) {\r\n    return new Program({\r\n      ...this,\r\n      form: f,\r\n      labels: null\r\n    });\r\n  }\r\n\r\n  setLabels(labels) {\r\n    return new Program({\r\n      ...this,\r\n      labels: labels\r\n    })\r\n  }\r\n\r\n  isIntegral() {\r\n    return isIntegral2D(this.A) && isIntegral(this.b) && isIntegral(this.c);\r\n  }\r\n}","import { copyArr, copyArr2D, range, zero, one, minusOne, floor, ceil, \r\n  last, isInteger, isIntegral, isNonNegative, truePrefixSum, listToBoolArray, inverseArray} from './utils';\r\nimport Program from './Program';\r\nimport { pivot, calculatePrimalPivots, calculateDualPivots, nonePivotSuggestion, emptyDualPivots, emptyPrimalPivots } from './pivots'\r\n\r\nexport function getStateFromProgram(program) {\r\n  if (program.form === 'equality' || program.form === 'equality_dual')\r\n    return EqualityState.getFromProgram(program);\r\n  else\r\n    return BasicState.getFromProgram(program);\r\n}\r\n\r\nfunction validationFunction(allowed, selectedPart, allowedErrorMessage) {\r\n  return args => {\r\n    if (!Array.isArray(args) || !args.every(e => typeof e === 'boolean')) \r\n      return [false, \"Argument must be an array of booleans\"];\r\n    if (!args.every((v, i) => !v || allowed[i]))\r\n      return [false, allowedErrorMessage];\r\n    if (!args.includes(true))\r\n      return [false, `At least one ${selectedPart} must be selected.`];\r\n    return [true, null];\r\n  };\r\n}\r\n\r\nfunction primalGomoryCutTransition(state, func) {\r\n  const allowed = range(state.m + 1).map(i => !isInteger(last(state.tableau[i])));\r\n  return {\r\n    label: \"Add Gomory cuts for primal LP\",\r\n    args: \"rows\",\r\n    prompt: \"Select rows to use in making cuts\",\r\n    allowed: allowed,\r\n    defaultSelection: range(state.m + 1).map(() => false),\r\n    validateArgs: validationFunction(allowed, \"row\", \"Only rows with non integer value in the last column can be used.\"),\r\n    getNewState: func\r\n  };\r\n}\r\n\r\nfunction dualGomoryCutTransition(state, func) {\r\n  const allowed = range(state.columns).map(i => !isInteger(state.tableau[0][i]));\r\n  return {\r\n    label: \"Add Gomory cuts for dual LP\",\r\n    args: \"columns\",\r\n    prompt: \"Select columns to use in making cuts\",\r\n    allowed: allowed,\r\n    defaultSelection: range(state.columns).map(() => false),\r\n    validateArgs: validationFunction(allowed, \"column\", \"Only columns with non integer value in the first row can be used.\"),\r\n    getNewState: func\r\n  }\r\n}\r\n\r\nfunction standardStatusMessage(state, canStart=true, allowPrimalCut=true, allowDualCut=true) {\r\n  if (state.primalUnbounded) {\r\n    return \"The primal LP is unbounded.\";\r\n  } else if (state.dualUnbounded) {\r\n    return \"The dual LP is unbounded.\";\r\n  } else if(state.iter === 0 && !state.primalFeasible && canStart) {\r\n    if (state.dualFeasible) {\r\n      return \"Use the dual simplex method. Alternatively use an auxiliary LP or Farkas lemma to find a feasible primal solution\";\r\n    }\r\n    return \"Use an auxiliary LP or Farkas lemma to find a feasible primal solution\";\r\n  } else if (state.primalFeasible && state.dualFeasible) {\r\n    let canPrimalCut = !isIntegral(state.primalSolution) && allowPrimalCut;\r\n    let canDualCut = !isIntegral(state.dualSolution) && state.primalProgram.isIntegral() && allowDualCut;\r\n    if (canPrimalCut && canDualCut) {\r\n      return \"The LP is optimized, but the primal and dual solutions aren't integral. You can use Gomory cuts to look for integral solutions.\"\r\n    } else if (canPrimalCut) {\r\n      return \"The LP is optimized, but the primal solution isn't integral. You can use Gomory cuts to look for an integral solution.\"\r\n    } else if (canDualCut) {\r\n      return \"The LP is optimized, but the dual solution isn't integral. You can use Gomory cuts to look for an integral solution.\"\r\n    }\r\n    return \"An optimal solution has been reached.\";\r\n  } else if (state.primalFeasible) {\r\n    return \"Use the primal simplex method to optimize the LP.\";\r\n  } else if (state.dualFeasible) {\r\n    return \"Use the dual simplex method to optimize the LP.\";\r\n  }\r\n  return \"The tableau is not primal feasible or dual feasible. Return to previous state and follow instructions or make pivots to find a feasible base\";\r\n}\r\n\r\nclass BasicState {\r\n  constructor({tableau, n, m, primalLabels, dualLabels, baseVariables, primalProgram, iter, columns, addInfo=true}) {\r\n    this.tableau = tableau;\r\n    this.n = n;\r\n    this.m = m;\r\n    this.columns = columns;\r\n    this.primalLabels = primalLabels;\r\n    this.dualLabels = dualLabels;\r\n    this.baseVariables = baseVariables;\r\n    this.primalProgram = primalProgram;\r\n    this.dualProgram = primalProgram.setForm(primalProgram.form === 'primal' ? 'dual' : 'equality_dual').setLabels(this.dualLabels);\r\n    this.iter = iter;\r\n\r\n    if (addInfo)\r\n      this.addInformation();\r\n  }\r\n\r\n  static getFromProgram(program) {\r\n    let tableau = [\r\n      program.c.map(v => v.neg()).concat(\r\n        range(program.m + 1).map(() => zero))\r\n    ].concat(\r\n      program.A.map((row, i) =>\r\n        row.concat(\r\n          range(program.m).map(v => v === i ? one : zero)\r\n        ).concat(program.b[i])\r\n      )\r\n    );\r\n    \r\n    const primalLabels = range(program.n).map(i => `x_{${i+1}}`)\r\n          .concat(range(program.m).map(i => `s_{${i+1}}`));\r\n    const dualLabels = range(program.m).map(i => `y_{${i+1}}`);\r\n    const baseVariables = range(program.m).map(i => program.n + i);\r\n  \r\n    return new BasicState({\r\n      tableau: tableau,\r\n      n: program.n,\r\n      m: program.m,\r\n      columns: program.n + program.m + 1,\r\n      primalLabels: primalLabels,\r\n      dualLabels: dualLabels,\r\n      baseVariables: baseVariables,\r\n      primalProgram: program.form === \"dual\" ? program.setForm(\"primal\") : program,\r\n      iter: 0,\r\n    });\r\n  }\r\n\r\n  getStatusMessage() {\r\n    return standardStatusMessage(this);\r\n  }\r\n\r\n  getPossibleTransitions() {\r\n    if (this.primalUnbounded || this.dualUnbounded) {\r\n      return [];\r\n    } else if(this.iter === 0 && !this.primalFeasible) {\r\n      return [{ \r\n          label: \"Make an auxiliary LP\", \r\n          args: \"none\",\r\n          getNewState: () => AuxiliaryState.getFromBasicState(this) \r\n        }, { \r\n          label: \"Use Farkas Lemma\", \r\n          args: \"none\",\r\n          getNewState: () => FarkasState.getFromBasic(this)\r\n      }];\r\n    } else if (this.primalFeasible && this.dualFeasible) {\r\n      let res = [];\r\n      if (!isIntegral(this.primalSolution)) {\r\n        res.push(primalGomoryCutTransition(this, rows => PrimaryGomory.getFirstCut(this, rows)))\r\n      }\r\n      if (!isIntegral(this.dualSolution) && this.primalProgram.isIntegral()) {\r\n        res.push(dualGomoryCutTransition(this, cols => DualGomory.getFirstCut(this, cols)));\r\n      }\r\n      return res;\r\n    }\r\n    return [];\r\n  }\r\n\r\n  addInformation() {  \r\n    this.isBase = listToBoolArray(this.baseVariables, this.columns - 1);\r\n    \r\n    this.calculateSolutions();\r\n    this.calculatePivots();\r\n    this.calculatePrograms();\r\n    this.calculateDisabled();\r\n\r\n    this.transitions = this.getPossibleTransitions();\r\n  }\r\n\r\n  calculatePivots() {\r\n    const [primalPivots, primalUnbounded] = calculatePrimalPivots(this.tableau, this.isBase);\r\n    const [dualPivots  , dualUnbounded ] = calculateDualPivots(this.tableau);\r\n\r\n    this.suggestedPivots = {\r\n      \"none\": nonePivotSuggestion(this.tableau),\r\n      ...primalPivots,\r\n      ...dualPivots,\r\n    }\r\n    this.defaultSuggestion = \"bland_primal\";\r\n    this.primalUnbounded = primalUnbounded;\r\n    this.dualUnbounded  = dualUnbounded;\r\n  }\r\n\r\n  calculateSolutions() {\r\n    this.primalFeasible = isNonNegative(this.tableau.slice(1).map(r => last(r)));\r\n    this.dualFeasible   = isNonNegative(this.tableau[0].slice(0, -1));\r\n\r\n    this.primalSolution = range(this.columns - 1).map(() => zero);\r\n    for (let i = 0; i < this.m; i ++) {\r\n      this.primalSolution[this.baseVariables[i]] = last(this.tableau[i+1]);\r\n    }\r\n\r\n    if (!this.primalProgram.equalityForm) {\r\n      this.dualSolution = Array(this.m);\r\n      for (let i = 0; i < this.m; i ++) {\r\n        this.dualSolution[i] = this.tableau[0][i + this.n];\r\n      }\r\n    }\r\n  }\r\n\r\n  calculatePrograms() {\r\n    this.programs = [{\r\n      name: \"Primal LP\",\r\n      program: this.primalProgram,\r\n    }, {\r\n      name: \"Dual LP\",\r\n      program: this.dualProgram,\r\n    }];\r\n    this.defaultProgram = \"Primal LP\";\r\n  }\r\n\r\n  calculateDisabled() {\r\n    this.disabledColumns = range(this.columns).map(() => false);\r\n    this.disabledRows = this.tableau.map(() => false);\r\n    this.disableObjectiveInvariant = false;\r\n  }\r\n\r\n  canPivot(i, j) {\r\n    return !(j === this.columns - 1 || i === 0  ||\r\n            this.tableau[i][j].equals(zero) ||\r\n            this.isBase[j]);\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new BasicState({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass FixBaseBasic extends BasicState {\r\n  constructor(args) {\r\n    super({...args, addInfo: false});\r\n    this.baseFixed = this.baseVariables.every(v => this.tableau[0][v].equals(zero));\r\n    this.addInformation();\r\n  }\r\n\r\n  getStatusMessage() {\r\n    if (this.baseFixed)\r\n      return \"The top row is fixed.\"\r\n    return \"Make pivots to represent the top row in the new base.\"\r\n  }\r\n\r\n  canPivot(i, j) {\r\n    return this.isBase[j] && !this.tableau[0][j].equals(zero) && this.tableau[i][j].equals(one);\r\n  }\r\n\r\n  getPossibleTransitions() {\r\n    if (this.baseFixed) {\r\n      return [{\r\n        label: \"Continue\", \r\n        args: \"none\",\r\n        getNewState: () => this.backToBasic()\r\n      }];\r\n    }\r\n    return [];\r\n  }\r\n\r\n  calculatePivots() {\r\n    const availablePivots = this.tableau.map((row, i) => row.map((v, j) => this.canPivot(i, j)));\r\n    this.suggestedPivots = {\r\n      \"none\": { pivots: availablePivots, description: \"None\"},\r\n      \"generic_dual\": { pivots: availablePivots, description: \"Generic pivot for dual simplex\"},\r\n      \"bland_dual\": { pivots: availablePivots, description: \"Bland's rule for dual simplex\"},\r\n      \"generic_primal\": { pivots: availablePivots, description: \"Generic pivot for primal simplex\"},\r\n      \"bland_primal\": { pivots: availablePivots, description: \"Bland's rule for primal simplex\"},\r\n    };\r\n    this.defaultSuggestion = \"bland_primal\";\r\n    this.primalUnbounded = false;\r\n    this.dualUnbounded = false;\r\n  }\r\n\r\n  backToBasic() {\r\n    return new BasicState({...this});\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new FixBaseBasic({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    });\r\n  }\r\n}\r\n\r\nclass PrimaryGomory extends BasicState {\r\n  constructor({addedOverall, initialN, initialM, ...args}) {\r\n    super({...args, addInfo: false});\r\n    this.addedOverall = addedOverall;\r\n    this.initialN = initialN;\r\n    this.initialM = initialM;\r\n    this.addInformation();\r\n  }\r\n\r\n  static getFirstCut(state, rows) {\r\n    return (new PrimaryGomory({\r\n      ...state,\r\n      addedOverall: 0,\r\n      initialN: state.n,\r\n      initialM: state.m,\r\n    })).addGomoryCuts(rows);\r\n  }\r\n\r\n  getStatusMessage() {\r\n    return standardStatusMessage(this, false, true, false);\r\n  }\r\n\r\n  getPossibleTransitions() {\r\n    if (this.primalUnbounded || this.dualUnbounded) {\r\n      return [];\r\n    } else if (this.primalFeasible && this.dualFeasible) {\r\n      let res = [];\r\n      if (!isIntegral(this.primalSolution)) {\r\n        res.push(primalGomoryCutTransition(this, rows => this.addGomoryCuts(rows)))\r\n        const possibleToRemove = range(this.columns).map(j => (j >= this.initialN + this.initialM && j < this.columns - 1) && this.isBase[j]);\r\n        if (possibleToRemove.some(v => v)) {\r\n          res.push({\r\n            label: \"Remove superfluous cuts\",\r\n            args: \"base_columns\",\r\n            prompt: \"Select columns to remove\",\r\n            allowed: possibleToRemove,\r\n            defaultSelection: range(this.columns).map(() => false),\r\n            validateArgs: validationFunction(possibleToRemove, \"column\", \"Only columns added with Gomory cuts that are currently in the base can be removed.\"),\r\n            getNewState: cols => this.removeExtraColumns(cols)\r\n          })\r\n        }\r\n      }\r\n      return res;\r\n    }\r\n    return [];\r\n  }\r\n\r\n  addGomoryCuts(rows) {\r\n    let newTableau = copyArr2D(this.tableau);\r\n    let newBaseVariables = copyArr(this.baseVariables);\r\n    let rowsUsed = 0;\r\n    for (let i = 0; i <= this.m; i ++) {\r\n      if (!rows[i]) continue;\r\n      const col = this.tableau[0].length + rowsUsed;\r\n      const tab = newTableau;\r\n      const newRow = range(col + 1).map(j => \r\n        j === col     ? tab[i][col-1].sub(floor(tab[i][col-1])).neg() :\r\n        j === col - 1 ? one : \r\n        tab[i][j].sub(floor(tab[i][j])).neg());\r\n      newTableau = tab.map(row => row.slice(0, col-1).concat(zero, row[col-1]))\r\n                      .concat([newRow]);\r\n      newBaseVariables.push(col - 1);                      \r\n      rowsUsed ++;\r\n    }\r\n    const newPrimalLabels = this.primalLabels.concat(range(rowsUsed).map(i => `s_{${this.initialM + this.addedOverall + i + 1}}`));\r\n    const newDualLabels = this.dualLabels.concat(range(rowsUsed).map(i => `y_{${this.initialM + this.addedOverall + i + 1}}`));\r\n    const newPrimalProgram = Program.fromTableau(this.n, this.m + rowsUsed, newTableau, newBaseVariables, newPrimalLabels)\r\n\r\n    return new PrimaryGomory({\r\n      ...this,\r\n      m: this.m + rowsUsed,\r\n      columns: this.columns + rowsUsed,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      primalLabels: newPrimalLabels,\r\n      dualLabels: newDualLabels,\r\n      primalProgram: newPrimalProgram,\r\n      iter: this.iter + 1,\r\n      addedOverall: this.addedOverall + rowsUsed,\r\n    });\r\n  }\r\n\r\n  removeExtraColumns(cols) {\r\n    const [removedColumns, prefSum] = truePrefixSum(cols);\r\n    const newTableau = this.tableau.filter((r, i) => i === 0 ? true : !cols[this.baseVariables[i-1]]).map(row => row.filter((v, j) => !cols[j]));\r\n    const newBaseVariables = this.baseVariables.filter(v => !cols[v]).map(v => v - prefSum[v]);\r\n    const newPrimalLabels = this.primalLabels.filter((l, i) => !cols[i]);\r\n    const newDualLabels = this.dualLabels.filter((l, i) => !cols[i + this.n]);\r\n    const newPrimalProgram = Program.fromTableau(this.n, this.m - removedColumns, newTableau, newBaseVariables, newPrimalLabels)\r\n    return new PrimaryGomory({\r\n      ...this,\r\n      m: this.m - removedColumns,\r\n      columns: this.columns - removedColumns,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      primalLabels: newPrimalLabels,\r\n      dualLabels: newDualLabels,\r\n      primalProgram: newPrimalProgram,\r\n    })\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new PrimaryGomory({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass DualGomory extends BasicState {\r\n  constructor({initialN, addedOverall, ...args}) {\r\n    super({...args, addInfo: false});\r\n    this.initialN = initialN;\r\n    this.addedOverall = addedOverall;\r\n\r\n    this.addInformation();\r\n  }\r\n\r\n  static getFirstCut(state, cols) {\r\n    return (new DualGomory({\r\n      ...state,\r\n      initialN: state.n,\r\n      addedOverall: 0,\r\n    })).addGomoryCuts(cols);\r\n  }\r\n\r\n  getStatusMessage() {\r\n    return standardStatusMessage(this, false, false, true);\r\n  }\r\n\r\n  getPossibleTransitions() {\r\n    if (this.primalUnbounded || this.dualUnbounded) {\r\n      return [];\r\n    } else if (this.primalFeasible && this.dualFeasible) {\r\n      let res = [];\r\n\r\n      if (!isIntegral(this.dualSolution)) {\r\n        res.push(dualGomoryCutTransition(this, cols => this.addGomoryCuts(cols)));\r\n\r\n        const possibleToRemove = range(this.columns).map(i => i >= this.initialN && i < this.n && !this.isBase[i]);\r\n        if (possibleToRemove.some(v => v)) {\r\n          res.push({\r\n            label: \"Remove superfluous cuts\",\r\n            args: \"columns\",\r\n            prompt: \"Select columns to remove\",\r\n            allowed: possibleToRemove,\r\n            defaultSelection: range(this.columns).map(() => false),\r\n            validateArgs: validationFunction(possibleToRemove, \"column\", \"Only columns added with Gomory cuts that are not currently in the base can be removed.\"),\r\n            getNewState: cols => this.removeExtraColumns(cols)\r\n          })\r\n        }\r\n      }\r\n      return res;\r\n    }\r\n    return [];\r\n  }\r\n\r\n  addGomoryCuts(cols) {\r\n    let addedRows = range(this.m + 1).map(() => []);\r\n    let columnsAdded = 0;\r\n    for (let j = 0; j <= this.columns; j ++) {\r\n      if (!cols[j]) continue;\r\n      addedRows = addedRows.map((row, i) =>\r\n        i === 0 ? \r\n        row.concat(this.tableau[i][j].sub( ceil(this.tableau[i][j]))) :\r\n        row.concat(this.tableau[i][j].sub(floor(this.tableau[i][j])))\r\n      );\r\n      columnsAdded ++;\r\n    }\r\n    const newTableau = this.tableau.map((row, i) => row.slice(0, this.n).concat(addedRows[i]).concat(row.slice(this.n)));\r\n    const newBaseVariables = this.baseVariables.map(v => v >= this.n ? v + columnsAdded : v);\r\n    const newPrimalLabels = this.primalLabels.slice(0, this.n)\r\n                .concat(range(columnsAdded).map(i => `x_{${this.initialN + this.addedOverall + i + 1}}`))\r\n                .concat(this.primalLabels.slice(this.n));\r\n    const newPrimalProgram = Program.fromTableau(this.n + columnsAdded, this.m, newTableau, newBaseVariables, newPrimalLabels);\r\n    return new DualGomory({\r\n      ...this,\r\n      n: this.n + columnsAdded,\r\n      columns: this.columns + columnsAdded,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      primalLabels: newPrimalLabels,\r\n      primalProgram: newPrimalProgram,\r\n      addedOverall: this.addedOverall + columnsAdded,\r\n    });\r\n  }\r\n\r\n  removeExtraColumns(cols) {\r\n    const [removedColumns, prefSum] = truePrefixSum(cols);\r\n    const newTableau = this.tableau.map(row => row.filter((v, j) => !cols[j]));\r\n    const newBaseVariables = this.baseVariables.map(v => v - prefSum[v]);\r\n    const newPrimalLabels = this.primalLabels.filter((l, i) => !cols[i]);\r\n    const newPrimalProgram = Program.fromTableau(this.n - removedColumns, this.m, newTableau, newBaseVariables, newPrimalLabels);\r\n    return new DualGomory({\r\n      ...this,\r\n      n: this.n - removedColumns,\r\n      columns: this.columns - removedColumns,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      primalLabels: newPrimalLabels,\r\n      primalProgram: newPrimalProgram,\r\n    })\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new DualGomory({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass AuxiliaryState extends BasicState {\r\n  constructor({auxiliaryProgram, savedObjective, ...args}) {\r\n    super({...args, addInfo: false});\r\n    this.auxiliaryProgram = auxiliaryProgram;\r\n    this.savedObjective = savedObjective;\r\n    this.addInformation();\r\n  }\r\n\r\n  static getFromBasicState(state) {\r\n    return new AuxiliaryState({\r\n      ...state,\r\n      auxiliaryProgram: Program.fromArrays(\r\n        state.primalProgram.A.map(r => Array.of(minusOne).concat(r)),\r\n        state.primalProgram.b,\r\n        Array.of(minusOne).concat(range(state.primalProgram.c.length).map(() => zero)),\r\n        \"primal\",\r\n        Array.of(\"x_{0}\").concat(state.primalLabels.slice(0, state.n)),\r\n      ),\r\n      tableau: state.tableau.map((row, i) => i === 0 ? \r\n        range(state.columns + 1).map(i => i === 0 ? one : zero) : \r\n        Array.of(minusOne).concat(row)),\r\n      n: state.n + 1,\r\n      columns: state.columns + 1,\r\n      primalLabels: Array.of(\"x_{0}\").concat(state.primalLabels),\r\n      baseVariables: state.baseVariables.map(x => x + 1),\r\n      savedObjective: state.tableau[0],\r\n      iter: 0,\r\n    });\r\n  }\r\n\r\n  getStatusMessage() {\r\n    if (this.primalFeasible && this.dualFeasible) {\r\n      if (this.primalSolution[0].equals(zero)) {\r\n        return 'The auxiliary LP is optimized and $x_0$ is equals to 0, so we can return to the original LP';\r\n      } else {\r\n        return 'The auxiliary LP is optimized, but $x_0$ is not equal to 0, so the original LP is infeasible';\r\n      }\r\n    } else if (this.iter === 0) {\r\n      if (this.dualFeasible)\r\n        return \"The primal solution is not feasible, pivot with $x_0$ as the entering variable and as the leaving the one with the lowest value in the current basic solution. Alternatively use the dual simplex algorithm.\";\r\n      return 'The primal solution is not feasible, pivot with $x_0$ as the entering variable and as the leaving the one with the lowest value in the current basic solution.';\r\n    } else {\r\n      return 'Optimize the auxiliary LP to find a feasible basic solution to the initial LP or determine that it is infeasible';\r\n    }\r\n  }\r\n\r\n  getFirstPivotRow() {\r\n    let correctI = -1;\r\n    let minB = zero;\r\n    for (let k = 1; k <= this.m; k ++) {\r\n      if (last(this.tableau[k]).compare(minB) < 0) {\r\n        minB = last(this.tableau[k]);\r\n        correctI = k;\r\n      }\r\n    }\r\n    return correctI;\r\n  }\r\n\r\n  calculatePivots() {\r\n    const [primalPivots, primalUnbounded] = calculatePrimalPivots(this.tableau, this.isBase);\r\n    const [dualPivots  , dualUnbounded ] = calculateDualPivots(this.tableau);\r\n\r\n    this.suggestedPivots = {\r\n      \"none\": nonePivotSuggestion(this.tableau),\r\n      ...primalPivots,\r\n      ...dualPivots,\r\n    }\r\n\r\n    if (this.iter === 0) {\r\n      const row = this.getFirstPivotRow();\r\n      const auxiliaryPivot = this.tableau.map((r, i) => r.map((v, j) => (i === row && j === 0)));\r\n\r\n      this.suggestedPivots = {\r\n        ...this.suggestedPivots,\r\n        \"generic_primal\": { pivots: auxiliaryPivot, description: \"Generic pivot for primal simplex\"},\r\n        \"bland_primal\": { pivots: auxiliaryPivot, description: \"Bland's rule for primal simplex\"},\r\n      };\r\n    }\r\n    this.defaultSuggestion = \"bland_primal\";\r\n    this.primalUnbounded = primalUnbounded;\r\n    this.dualUnbounded  = dualUnbounded;\r\n  }\r\n\r\n  getPossibleTransitions() {\r\n    if (this.primalFeasible && this.dualFeasible && this.primalSolution[0].equals(zero)) {\r\n      return [{ \r\n        label: \"Return to initial LP\", \r\n        args: \"none\",\r\n        getNewState: () => this.goBackToBasic() \r\n      }];\r\n    }\r\n    return [];\r\n  }\r\n\r\n  goBackToBasic() {\r\n    const newTableau = this.tableau.map(r => r.slice(1));\r\n    newTableau[0] = this.savedObjective;\r\n  \r\n    return new FixBaseBasic({\r\n      ...this,\r\n      tableau: newTableau,\r\n      n: this.n - 1,\r\n      columns: this.columns - 1,\r\n      primalLabels: this.primalLabels.slice(1),\r\n      baseVariables: this.baseVariables.map(x => x - 1),\r\n      iter: this.outerIter + 1,\r\n    });\r\n  }\r\n\r\n  calculatePrograms() {\r\n    if (this.auxiliaryProgram === undefined) return;\r\n    this.programs = [{\r\n      name: \"Auxiliary LP\",\r\n      program: this.auxiliaryProgram,\r\n    },{\r\n      name: \"Dual auxiliary LP\",\r\n      program: this.auxiliaryProgram.setForm('dual'),\r\n    }];\r\n    this.defaultProgram = \"Auxiliary LP\";\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new AuxiliaryState({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass FarkasState extends BasicState {\r\n  constructor({...args}) {\r\n    super(args);\r\n  }\r\n  static getFromBasic(state) {\r\n    return new FarkasState({\r\n      ...state,\r\n      primalProgram: new Program({\r\n        ...state.primalProgram,\r\n        c: state.primalProgram.c.map(() => zero)\r\n      })\r\n    });\r\n  }\r\n\r\n  getStatusMessage() {\r\n    if (this.primalFeasible) {\r\n      return \"A feasible primal solution has been found.\";\r\n    } else if (this.dualUnbounded) {\r\n      return \"The initial LP is primal infeasible.\";\r\n    } else {\r\n      return \"Use dual simplex method to find a feasible primal solution.\";\r\n    }\r\n  }\r\n\r\n  calculatePivots() {\r\n    const dummyTableau = this.tableau.map((row, i) =>\r\n       i === 0 ? range(this.columns).map(() => zero) : row);\r\n    const [primalPivots, primalUnbounded] = calculatePrimalPivots(dummyTableau, this.isBase);\r\n    const [dualPivots  , dualUnbounded ] = calculateDualPivots(dummyTableau);\r\n\r\n    this.suggestedPivots = {\r\n      \"none\": nonePivotSuggestion(this.tableau),\r\n      ...primalPivots,\r\n      ...dualPivots,\r\n    }\r\n    this.primalUnbounded = primalUnbounded;\r\n    this.dualUnbounded  = dualUnbounded;\r\n  }\r\n\r\n  getPossibleTransitions() {\r\n    const thisRef = this;\r\n    if (this.primalFeasible) {\r\n      return [\r\n      { \r\n        label: \"Go back to the initial LP\", \r\n        args: \"none\",\r\n        getNewState: () => new BasicState(thisRef) \r\n      }];\r\n    }\r\n    return [];\r\n  }\r\n\r\n  calculateDisabled() {\r\n    this.disabledColumns = range(this.columns).map(() => false);\r\n    this.disabledRows = this.tableau.map(() => false);\r\n    this.disableObjectiveInvariant = true;\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new FarkasState({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass EqualityState extends BasicState {\r\n  constructor(args) {\r\n    super(args);\r\n    this.calculateDisabled();\r\n    this.hasBase = this.baseVariables.every((v, i) => v !== -1 || this.disabledRows[i + 1]);\r\n    this.infeasible = range(this.m, 1).some(i => range(this.n).every(j => this.tableau[i][j].equals(zero) || j === this.baseVariables[i-1]) \r\n                                            && !last(this.tableau[i]).equals(zero));\r\n    this.addInformation();\r\n  }\r\n\r\n  static getFromProgram(program) {\r\n    let tableau = [\r\n      program.c.map(v => v.neg()).concat(\r\n        range(program.m + 1).map(() => zero))\r\n    ].concat(\r\n      program.A.map((row, i) =>\r\n        row.concat(\r\n          range(program.m).map(v => v === i ? (program.b[i].compare(zero) < 0 ? minusOne : one) : zero)\r\n        ).concat(program.b[i])\r\n      )\r\n    );\r\n    \r\n    const primalLabels = range(program.n).map(i => `x_{${i+1}}`)\r\n          .concat(range(program.m).map(i => `s_{${i+1}}`));\r\n    const dualLabels = range(program.m).map(i => `y_{${i+1}}`);\r\n    const baseVariables = range(program.m).map(() => -1);\r\n  \r\n    return new EqualityState({\r\n      tableau: tableau,\r\n      n: program.n,\r\n      m: program.m,\r\n      columns: program.n + program.m + 1,\r\n      primalLabels: primalLabels,\r\n      dualLabels: dualLabels,\r\n      baseVariables: baseVariables,\r\n      primalProgram: program.setForm('equality'),\r\n      iter: 0,\r\n    });\r\n  }\r\n\r\n  calculatePivots() {\r\n    const nonePivots = nonePivotSuggestion(this.tableau);\r\n    if (!this.hasBase || this.infeasible) {\r\n      this.suggestedPivots = {\r\n        \"none\": nonePivots,\r\n        ...emptyDualPivots(this.tableau),\r\n        ...emptyPrimalPivots(this.tableau),\r\n      }\r\n      this.defaultSuggestion = \"none\";\r\n      this.primalUnbounded = false;\r\n      this.dualUnbounded  = false;\r\n    } else {\r\n      const [primalPivots, primalUnbounded] = calculatePrimalPivots(this.tableau, this.isBase, true, this.n);\r\n      const [dualPivots  , dualUnbounded ] = calculateDualPivots(this.tableau, true, this.n);\r\n\r\n      this.suggestedPivots = {\r\n        \"none\": nonePivots,\r\n        ...primalPivots,\r\n        ...dualPivots,\r\n      }\r\n      this.defaultSuggestion = \"bland_primal\";\r\n      this.primalUnbounded = primalUnbounded;\r\n      this.dualUnbounded  = dualUnbounded;\r\n    }\r\n  }\r\n\r\n  getStatusMessage() {\r\n    if (this.infeasible) {\r\n      return \"The primal LP is infeasible.\"\r\n    } else if (!this.hasBase) {\r\n      if (this.iter === 0)\r\n        return \"Find a base by making pivots or following an algorithm.\"\r\n      return \"Find a base by making pivots.\"\r\n    } else {\r\n      return standardStatusMessage(this, false, false, true);\r\n    }\r\n  }\r\n\r\n  calculateSolutions() {\r\n    this.primalFeasible = isNonNegative(this.tableau.slice(1).map(r => last(r)));\r\n    this.dualFeasible   = isNonNegative(this.tableau[0].slice(0, this.n));\r\n\r\n    this.primalSolution = range(this.n).map(() => zero);\r\n    for (let i = 0; i < this.m; i ++) {\r\n      if (this.baseVariables[i] !== -1 && this.baseVariables[i] < this.n)\r\n        this.primalSolution[this.baseVariables[i]] = last(this.tableau[i+1]);\r\n    }\r\n\r\n    this.dualSolution = Array(this.m);\r\n    for (let i = 0; i < this.m; i ++) {\r\n      this.dualSolution[i] = this.tableau[0][i + this.n];\r\n    }\r\n  }\r\n\r\n  getPossibleTransitions() {\r\n    if (!this.hasBase) {\r\n      if (this.iter === 0)\r\n        return [{ \r\n          label: \"Find a base\", \r\n          args: \"none\",\r\n          getNewState: () => EqualityFirstStage.getFromEqualityState(this) \r\n        }];\r\n    } else if (this.primalFeasible && this.dualFeasible) {\r\n      if (!isIntegral(this.dualSolution) && this.primalProgram.isIntegral()) {\r\n        return [dualGomoryCutTransition(this, cols => EqualityDualGomory.getFirstCut(this, cols))];\r\n      }\r\n    }\r\n    return [];\r\n  }\r\n\r\n  calculateDisabled() {\r\n    this.disabledColumns = range(this.columns).map(i => i >= this.n && i < this.columns - 1);\r\n    this.disabledRows = range(this.m + 1).map(i => i > 0 && range(this.n).every(j => this.tableau[i][j].equals(zero)) \r\n                                                         && last(this.tableau[i]).equals(zero));\r\n    this.disableObjectiveInvariant = false;\r\n  }\r\n\r\n  canPivot(i, j) {\r\n    return !(j >= this.n || i === 0  ||\r\n            this.tableau[i][j].equals(zero) ||\r\n            this.isBase[j]);\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new EqualityState({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass EqualityFirstStage extends EqualityState {\r\n  constructor({savedObjective, ...args}) {\r\n    super({...args, addInfo: false});\r\n    this.savedObjective = savedObjective;\r\n    \r\n    if (this.baseVariables.some(v => v === -1)) {\r\n      this.stage = 'base';\r\n    } else {\r\n      if (this.primalFeasible && this.dualFeasible) {\r\n        const invBaseVariables = inverseArray(this.baseVariables, this.n + this.m);\r\n        if (last(this.tableau[0]).compare(zero) < 0) {\r\n          this.stage = 'infeasible';\r\n        } else if (range(this.m, this.n).some(j => this.isBase[j] && \r\n            range(this.n).some(i => !this.tableau[invBaseVariables[j]+1][i].equals(zero)))) {\r\n          this.stage = 'rebase';\r\n        } else {\r\n          this.stage = 'done';\r\n        }\r\n      } else {\r\n        this.stage = 'optimize';\r\n      }\r\n    }\r\n\r\n    this.addInformation();\r\n  }\r\n\r\n\r\n  static getFromEqualityState(state) {\r\n    return new EqualityFirstStage({\r\n      ...state,\r\n      tableau: state.tableau.map((row, i) => i === 0 ? \r\n          row.map((v, j) => (j < state.n || j === state.columns - 1) ? zero : one) : row),\r\n      savedObjective: state.tableau[0],\r\n    });\r\n  }\r\n\r\n  getStatusMessage() {\r\n    if (this.stage === 'base') {\r\n      return \"Make pivots with slack variables to establish a base.\"\r\n    } else if (this.stage === 'done') {\r\n      return \"The program is optimized. We can return to the initial program.\"\r\n    } else if (this.stage === 'optimize') {\r\n      return \"Optimize the LP using the simplex method.\"\r\n    } else if (this.stage === 'rebase') {\r\n      return \"Remove the slack variables from base where possible.\"\r\n    } else if (this.stage === 'infeasible') {\r\n      return \"The initial LP is infeasible.\"\r\n    }\r\n    return \"\";\r\n  }\r\n\r\n  getPossibleTransitions() {\r\n    if (this.stage === 'done') {\r\n      if (last(this.tableau[0]).compare(zero) === 0)\r\n        return [{\r\n          label: \"Return to initial LP\", \r\n          args: \"none\",\r\n          getNewState: () => this.goBack() \r\n        }];\r\n    }\r\n    return [];\r\n  }\r\n\r\n  goBack() {\r\n    const newTableau = this.tableau.map((row, i) => i === 0 ? this.savedObjective : row);\r\n\r\n    return new FixBaseEquality({\r\n      ...this,\r\n      tableau: newTableau,\r\n    });\r\n  }\r\n\r\n  calculatePivots() {\r\n    if (this.stage !== 'optimize') {\r\n      this.suggestedPivots = {\r\n        \"none\": nonePivotSuggestion(this.tableau),\r\n        ...emptyDualPivots(this.tableau),\r\n        ...emptyPrimalPivots(this.tableau),\r\n      }\r\n      this.defaultSuggestion = \"none\";\r\n      this.primalUnbounded = false;\r\n      this.dualUnbounded  = false;\r\n    } else {\r\n      const [primalPivots, primalUnbounded] = calculatePrimalPivots(this.tableau, this.isBase);\r\n      const [dualPivots  , dualUnbounded ] = calculateDualPivots(this.tableau);\r\n\r\n      this.suggestedPivots = {\r\n        \"none\": nonePivotSuggestion(this.tableau),\r\n        ...primalPivots,\r\n        ...dualPivots,\r\n      }\r\n      this.defaultSuggestion = \"bland_primal\";\r\n      this.primalUnbounded = primalUnbounded;\r\n      this.dualUnbounded  = dualUnbounded;\r\n    }\r\n  }\r\n\r\n  calculateDisabled() {\r\n    this.disabledColumns = range(this.columns).map(() => false);\r\n    this.disabledRows = range(this.m + 1).map(() => false);\r\n    this.disableObjectiveInvariant = false;\r\n  }\r\n\r\n  canPivot(i, j) {\r\n    if (this.stage === 'base')\r\n      return (this.baseVariables[i-1] === -1) && (i === j - this.n + 1) && !this.isBase[j];\r\n    if (this.stage === 'optimize')\r\n      return !(j === this.columns - 1 || i === 0  ||\r\n        this.tableau[i][j].equals(zero) ||\r\n        this.isBase[j]);\r\n    if (this.stage === 'rebase') \r\n      return !(j === this.columns - 1 || i === 0  ||\r\n        this.tableau[i][j].equals(zero) ||\r\n        this.isBase[j]) && this.baseVariables[i-1] >= this.n && j < this.n;\r\n    return false;\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new EqualityFirstStage({\r\n      ...this,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      iter: this.iter + 1,\r\n    })\r\n  }\r\n}\r\n\r\nclass FixBaseEquality extends EqualityState {\r\n  constructor(args) {\r\n    super({...args, addInfo: false});\r\n    this.baseFixed = this.baseVariables.every(v => this.tableau[0][v].equals(zero));\r\n    this.addInformation();\r\n  }\r\n\r\n  getStatusMessage() {\r\n    if (this.baseFixed)\r\n      return \"The top row is fixed.\"\r\n    return \"Make pivots to represent the top row in the new base.\"\r\n  }\r\n\r\n  canPivot(i, j) {\r\n    return this.isBase[j] && !this.tableau[0][j].equals(zero) && this.tableau[i][j].equals(one);\r\n  }\r\n\r\n  calculatePivots() {\r\n    const availablePivots = this.tableau.map((row, i) => row.map((v, j) => this.canPivot(i, j)));\r\n    this.suggestedPivots = {\r\n      \"none\": { pivots: availablePivots, description: \"None\"},\r\n      \"generic_dual\": { pivots: availablePivots, description: \"Generic pivot for dual simplex\"},\r\n      \"bland_dual\": { pivots: availablePivots, description: \"Bland's rule for dual simplex\"},\r\n      \"generic_primal\": { pivots: availablePivots, description: \"Generic pivot for primal simplex\"},\r\n      \"bland_primal\": { pivots: availablePivots, description: \"Bland's rule for primal simplex\"},\r\n    };\r\n    this.defaultSuggestion = \"bland_primal\";\r\n    this.primalUnbounded = false;\r\n    this.dualUnbounded = false;\r\n  }\r\n\r\n  getPossibleTransitions() {\r\n    if (this.baseFixed) {\r\n      return [{\r\n        label: \"Continue\", \r\n        args: \"none\",\r\n        getNewState: () => this.backToBasic()\r\n      }];\r\n    }\r\n    return [];\r\n  }\r\n\r\n  backToBasic() {\r\n    return new EqualityState({...this});\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new FixBaseEquality({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    });\r\n  }\r\n}\r\n\r\nclass EqualityDualGomory extends EqualityState {\r\n  constructor({initialN, addedOverall, ...args}) {\r\n    super(args);\r\n    this.initialN = initialN;\r\n    this.addedOverall = addedOverall;\r\n\r\n    this.addInformation();\r\n  }\r\n\r\n  static getFirstCut(state, cols) {\r\n    return (new EqualityDualGomory({\r\n      ...state,\r\n      initialN: state.n,\r\n      addedOverall: 0,\r\n    })).addGomoryCuts(cols);\r\n  }\r\n\r\n  getStatusMessage() {\r\n    return standardStatusMessage(this, false, false, true);\r\n  }\r\n\r\n  getPossibleTransitions() {\r\n    if (this.primalUnbounded || this.dualUnbounded) {\r\n      return [];\r\n    } else if (this.primalFeasible && this.dualFeasible) {\r\n      let res = [];\r\n\r\n      if (!isIntegral(this.dualSolution)) {\r\n        res.push(dualGomoryCutTransition(this, cols => this.addGomoryCuts(cols)));\r\n\r\n        const possibleToRemove = range(this.columns).map(i => i >= this.initialN && i < this.n && !this.isBase[i]);\r\n        if (possibleToRemove.some(v => v)) {\r\n          res.push({\r\n            label: \"Remove superfluous cuts\",\r\n            args: \"columns\",\r\n            prompt: \"Select columns to remove\",\r\n            allowed: possibleToRemove,\r\n            defaultSelection: range(this.columns).map(() => false),\r\n            validateArgs: validationFunction(possibleToRemove, \"column\", \"Only columns added with Gomory cuts that are not currently in the base can be removed.\"),\r\n            getNewState: cols => this.removeExtraColumns(cols)\r\n          })\r\n        }\r\n      }\r\n      return res;\r\n    }\r\n    return [];\r\n  }\r\n\r\n  addGomoryCuts(cols) {\r\n    let addedRows = range(this.m + 1).map(() => []);\r\n    let columnsAdded = 0;\r\n    for (let j = 0; j <= this.columns; j ++) {\r\n      if (!cols[j]) continue;\r\n      addedRows = addedRows.map((row, i) =>\r\n        i === 0 ? \r\n        row.concat(this.tableau[i][j].sub( ceil(this.tableau[i][j]))) :\r\n        row.concat(this.tableau[i][j].sub(floor(this.tableau[i][j])))\r\n      );\r\n      columnsAdded ++;\r\n    }\r\n    const newTableau = this.tableau.map((row, i) => row.slice(0, this.n).concat(addedRows[i]).concat(row.slice(this.n)));\r\n    const newBaseVariables = this.baseVariables.map(v => v >= this.n ? v + columnsAdded : v);\r\n    const newPrimalLabels = this.primalLabels.slice(0, this.n)\r\n                .concat(range(columnsAdded).map(i => `x_{${this.initialN + this.addedOverall + i + 1}}`))\r\n                .concat(this.primalLabels.slice(this.n));\r\n    const newPrimalProgram = Program.fromTableau(this.n + columnsAdded, this.m, newTableau, newBaseVariables, newPrimalLabels).setForm('equality');\r\n    return new EqualityDualGomory({\r\n      ...this,\r\n      n: this.n + columnsAdded,\r\n      columns: this.columns + columnsAdded,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      primalLabels: newPrimalLabels,\r\n      primalProgram: newPrimalProgram,\r\n      addedOverall: this.addedOverall + columnsAdded,\r\n    });\r\n  }\r\n\r\n  removeExtraColumns(cols) {\r\n    const [removedColumns, prefSum] = truePrefixSum(cols);\r\n    const newTableau = this.tableau.map(row => row.filter((v, j) => !cols[j]));\r\n    const newBaseVariables = this.baseVariables.map(v => v - prefSum[v]);\r\n    const newPrimalLabels = this.primalLabels.filter((l, i) => !cols[i]);\r\n    const newPrimalProgram = Program.fromTableau(this.n - removedColumns, this.m, newTableau, newBaseVariables, newPrimalLabels);\r\n    return new EqualityDualGomory({\r\n      ...this,\r\n      n: this.n - removedColumns,\r\n      columns: this.columns - removedColumns,\r\n      tableau: newTableau,\r\n      baseVariables: newBaseVariables,\r\n      primalLabels: newPrimalLabels,\r\n      primalProgram: newPrimalProgram,\r\n    })\r\n  }\r\n\r\n  pivot(i, j) {\r\n    const [newTableau, newBaseVariables] = pivot(this.tableau, this.baseVariables, i, j);\r\n    \r\n    return new EqualityDualGomory({\r\n      ...this,\r\n      baseVariables: newBaseVariables,\r\n      tableau: newTableau,\r\n      iter: this.iter + 1,\r\n    });\r\n  }\r\n}","import { InlineMath } from 'react-katex'\r\nimport { range, zero, toLatex, isInSelection, isAllowedToSelect, last, isSecondarySelected } from './utils'\r\nimport './Tableau.scss'\r\n\r\nfunction TableauCell({\r\n  value,\r\n  position = \"inner\",\r\n  hidden = false,\r\n  showInvariant = false, \r\n  isBase = false,  \r\n  isCorner = false, \r\n  isHighlighted = false, \r\n  isDisabled = false,\r\n  isSelected = false,\r\n  isSelectable = false,\r\n  isSecondarySelected = false,\r\n  showPointer = true,\r\n  showSelection = false,\r\n  showDisabled = true,\r\n  useDecimal = true,\r\n  useMixed = false,\r\n  onClick = f => f, \r\n}) {\r\n  const isInner = position === 'inner';\r\n  const isNonNegative = value.compare(zero) >= 0;\r\n  const classes = [\r\n    \"tableau-cell\",\r\n    `cell-${position}`,\r\n    showInvariant &&  isNonNegative && !isDisabled ? \"invariant-holds\"  : \"\",\r\n    showInvariant && !isNonNegative && !isDisabled ? \"invariant-broken\" : \"\",\r\n    showPointer && \r\n        ((!isDisabled && isInner && !showSelection) ||\r\n        (showSelection && isSelectable))  ? \"clickable-cell\"      : \"\",\r\n    hidden                                ? \"hidden-cell\"         : \"\",\r\n    isCorner                              ? \"corner-cell\"         : \"\",\r\n    isBase && (isInner || !showInvariant) ? \"base-cell\"           : \"\",\r\n    isHighlighted && !showSelection       ? \"highlighted-cell\"    : \"\",\r\n    showSelection && isSelected           ? \"selected-cell\"       : \"\",\r\n    showSelection && !isSelectable        ? \"not-selectable-cell\" : \"\",\r\n    showSelection && isSecondarySelected  ? \"secondary-cell\"      : \"\",\r\n    showDisabled && !showSelection && \r\n      isDisabled                          ? \"disabled-cell\"       : \"\",\r\n  ].join(' ');\r\n  \r\n  return (\r\n    <td\r\n     className={classes}\r\n     onClick={onClick}\r\n    >\r\n      <InlineMath>{toLatex(value, useMixed, useDecimal)}</InlineMath>\r\n    </td>\r\n  );\r\n}\r\n\r\nfunction cornerCell({state, position, settings, onCellClick}) {\r\n  const {showSelection, selection} = settings;\r\n  return <TableauCell \r\n    value={last(state.tableau[0])}\r\n    position={position}\r\n    isSelected={showSelection && isInSelection(0, state.columns - 1, selection)}\r\n    isSelectable={showSelection && isAllowedToSelect(0, state.columns - 1, selection)}\r\n    isSecondarySelected={showSelection && isSecondarySelected(0, state.columns - 1, selection, state)}\r\n    onClick={() => onCellClick(0, state.columns - 1)}\r\n    {...settings}\r\n  />;\r\n}\r\n\r\nfunction bCell({state, i, position, settings, onCellClick}) {\r\n  const {showSelection, highlightInvariants, selection} = settings;\r\n  return <TableauCell \r\n    value={last(state.tableau[i])}\r\n    position={position}\r\n    showInvariant={highlightInvariants}\r\n    isDisabled={state.disabledRows[i]}\r\n    isSelected={showSelection && isInSelection(i, state.columns - 1, selection)}\r\n    isSelectable={showSelection && isAllowedToSelect(i, state.columns - 1, selection)}\r\n    isSecondarySelected={showSelection && isSecondarySelected(i, state.columns - 1, selection, state)}\r\n    onClick={() => onCellClick(i, state.columns - 1)}\r\n    {...settings}\r\n  />;\r\n}\r\n\r\nfunction objectiveRow({state, position, settings, onCellClick}) {\r\n  const {showSelection, highlightInvariants, selection, showBColumnsLeft, showSlackLeft, showBase, highlightBase} = settings;\r\n  return <tr>\r\n    <td></td>\r\n    {!showBColumnsLeft ? null :\r\n      cornerCell({state, position: `${position}-left`, settings, onCellClick})}\r\n    {!showSlackLeft ? null : range(state.m).map(j => \r\n      <TableauCell \r\n        key={state.n + j}\r\n        value={state.tableau[0][state.n + j]}\r\n        position={position}\r\n        showInvariant={highlightInvariants && !state.disableObjectiveInvariant}\r\n        hidden={state.isBase[state.n + j] && !state.disabledColumns[state.n + j] && !showBase}\r\n        isDisabled={state.disabledColumns[state.n + j]}\r\n        isBase={state.isBase[state.n + j] && highlightBase}\r\n        isSelected={showSelection && isInSelection(0, state.n + j, selection)}\r\n        isSelectable={showSelection && isAllowedToSelect(0, state.n + j, selection)}\r\n        isSecondarySelected={showSelection && isSecondarySelected(0, state.n + j, selection, state)}\r\n        onClick={() => onCellClick(0, state.n + j)}\r\n        {...settings}\r\n      />\r\n    )}\r\n    {range(state.n).map(j => \r\n      <TableauCell \r\n        key={j}\r\n        value={state.tableau[0][j]}\r\n        position={position}\r\n        showInvariant={highlightInvariants && !state.disableObjectiveInvariant}\r\n        hidden={state.isBase[j] && !state.disabledColumns[j] && !showBase}\r\n        isDisabled={state.disabledColumns[j]}\r\n        isBase={state.isBase[j] && highlightBase}\r\n        isSelected={showSelection && isInSelection(0, j, selection)}\r\n        isSelectable={showSelection && isAllowedToSelect(0, j, selection)}\r\n        isSecondarySelected={showSelection && isSecondarySelected(0, j, selection, state)}\r\n        onClick={() => onCellClick(0, j)}\r\n        {...settings}\r\n      />\r\n    )}\r\n    {showSlackLeft ? null : range(state.m).map(j => \r\n      <TableauCell \r\n        key={j}\r\n        value={state.tableau[0][state.n + j]}\r\n        position={position}\r\n        showInvariant={highlightInvariants && !state.disableObjectiveInvariant}\r\n        hidden={state.isBase[state.n + j] && !state.disabledColumns[state.n + j] && !showBase}\r\n        isDisabled={state.disabledColumns[state.n + j]}\r\n        isBase={state.isBase[state.n + j] && highlightBase}\r\n        isSelected={showSelection && isInSelection(0, state.n + j, selection)}\r\n        isSelectable={showSelection && isAllowedToSelect(0, state.n + j, selection)}\r\n        isSecondarySelected={showSelection && isSecondarySelected(0, state.n + j, selection, state)}\r\n        onClick={() => onCellClick(0, state.n + j)}\r\n        {...settings}\r\n      />\r\n    )}\r\n    {showBColumnsLeft ? null :\r\n      cornerCell({state, position: `${position}-right`, settings, onCellClick})}\r\n  </tr>;\r\n}\r\n\r\nfunction innerCell({state, i, j, settings, onCellClick}) {\r\n  const {showSelection, selection, highlightBase, showBase, highlightedPivots} = settings;\r\n  return <TableauCell \r\n    key={j}\r\n    value={state.tableau[i][j]}\r\n    hidden={state.isBase[j] && !state.disabledColumns[j] && !showBase}\r\n    isBase={state.isBase[j] && !state.disabledColumns[j] && highlightBase}\r\n    isHighlighted={state.suggestedPivots[highlightedPivots].pivots[i][j]}\r\n    isSelected={showSelection && isInSelection(i, j, selection)}\r\n    isSelectable={showSelection && isAllowedToSelect(i, j, selection)}\r\n    isSecondarySelected={showSelection && isSecondarySelected(i, j, selection, state)}\r\n    isDisabled={!state.canPivot(i, j)}\r\n    onClick={() => onCellClick(i, j)}\r\n    {...settings}\r\n  />;\r\n}\r\n\r\nfunction TableauDisplay({\r\n  state, \r\n  onCellClick = f => f, \r\n  highlightedPivots = \"none\", \r\n  highlightBase = true,\r\n  highlightInvariants = true,\r\n  useDecimal = true,\r\n  useMixed = false,\r\n  showBase = true,\r\n  selection = null,\r\n  showPointer = true,\r\n  showDisabled = false,\r\n  showObjectiveBottom = false,\r\n  showBColumnsLeft = false,\r\n  showSlackLeft = false,\r\n}) {\r\n  const showSelection = selection !== null;\r\n  const settings = {highlightedPivots, highlightBase, highlightInvariants, useDecimal, useMixed, showBase, showSelection,\r\n                    selection, showPointer, showDisabled, showObjectiveBottom, showBColumnsLeft, showSlackLeft};\r\n  return (\r\n    <div className=\"tableau-box\">\r\n      <table className=\"tableau-table\">\r\n        <tbody>\r\n          {showObjectiveBottom ? null :\r\n            objectiveRow({state, position: \"top\", settings, onCellClick})\r\n          }\r\n          {range(state.m, 1).map(i => \r\n            <tr key={i}>\r\n              <td>\r\n                <InlineMath>\r\n                  {i === 0 ? \"\" : \r\n                    (state.baseVariables[i-1] < 0\r\n                    || state.disabledColumns[state.baseVariables[i-1]]\r\n                    || state.disabledRows[i]) ? \"-\"  :\r\n                    state.primalLabels[state.baseVariables[i-1]]}\r\n                </InlineMath>\r\n              </td>\r\n              {!showBColumnsLeft ? null :\r\n                bCell({state, i, position: \"left\", settings, onCellClick})}\r\n              {!showSlackLeft ? null : range(state.m, state.n).map(j => \r\n                innerCell({state, i, j, settings, onCellClick})\r\n              )}\r\n              {range(state.n).map(j => \r\n                innerCell({state, i, j, settings, onCellClick})\r\n              )}\r\n              {showSlackLeft ? null : range(state.m, state.n).map(j => \r\n                innerCell({state, i, j, settings, onCellClick})\r\n              )}\r\n              {showBColumnsLeft ? null :\r\n                bCell({state, i, position: \"right\", settings, onCellClick})}\r\n            </tr>\r\n          )}\r\n          {!showObjectiveBottom ? null :\r\n            objectiveRow({state, position: \"bottom\", settings, onCellClick})}\r\n          <tr>\r\n            <td></td>\r\n            {showBColumnsLeft ? <td></td> : null}\r\n            {!showSlackLeft ? null : range(state.m).map(j => \r\n              <td key={state.n + j}>\r\n                <InlineMath>\r\n                  {state.primalLabels[state.n + j]}\r\n                </InlineMath>\r\n              </td>\r\n            )}\r\n            {range(state.n).map(j => \r\n              <td key={j}>\r\n                <InlineMath>\r\n                  {state.primalLabels[j]}\r\n                </InlineMath>\r\n              </td>\r\n            )}\r\n            {showSlackLeft ? null : range(state.m).map(j => \r\n              <td key={state.n + j}>\r\n                <InlineMath>\r\n                  {state.primalLabels[state.n + j]}\r\n                </InlineMath>\r\n              </td>\r\n            )}\r\n            {!showBColumnsLeft ? <td></td> : null}\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport { TableauDisplay };","import Program from './Program'\r\n\r\nconst examples = [\r\n  {\r\n    name: \"Simple 1\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 1, 3],\r\n        [2, 2, 5],\r\n        [4, 1, 2]\r\n      ],\r\n      [30, 24, 36],\r\n      [3, 1, 2],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Simple 2\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 1],\r\n        [1, 0],\r\n        [0, 1]\r\n      ],\r\n      [20, 12, 16],\r\n      [18, 12.5],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Basic solution not feasible\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [2, -1],\r\n        [1, -5]\r\n      ],\r\n      [2, -4],\r\n      [2, -1],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Basic solution not feasible 2\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [-2, \"-7.5\", 3],\r\n        [-20, -5, -3],\r\n      ],\r\n      [-10000, -30000],\r\n      [-1, -1, -1],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Infeasible\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [-1, -1, 0],\r\n        [0, -1, -1],\r\n        [1, 2, 1],\r\n      ],\r\n      [-2, -3, 4],\r\n      [1, 1, 1],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Unbounded\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, -1, 1],\r\n        [-2, 1, 0],\r\n        [0, 1, -2]\r\n      ],\r\n      [5, 3, 5],\r\n      [0, 2, 1],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Dual unbounded\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 0],\r\n        [3, 2],\r\n      ],\r\n      [1, -1],\r\n      [-2, 0],\r\n      \"dual\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Gomory cuts\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [-1, 1],\r\n        [8, 2],\r\n      ],\r\n      [2, 17],\r\n      [\"5.5\", \"2.1\"],\r\n      \"primal\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Equality Form\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 1, 1],\r\n        [2, 2, 5],\r\n      ],\r\n      [5, 16],\r\n      [3, 1, 2],\r\n      \"equality\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Equality Form 2\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [-1, -1, -1],\r\n        [2, 2, 3],\r\n      ],\r\n      [-8, 16],\r\n      [3, 1, 2],\r\n      \"equality\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Equality infeasible\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 1, 1],\r\n        [2, 2, 5],\r\n      ],\r\n      [12, 16],\r\n      [3, 1, 2],\r\n      \"equality\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Equality redundant row\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 1],\r\n        [2, 3],\r\n        [3, 4],\r\n      ],\r\n      [4, 9, 13],\r\n      [1, 1],\r\n      \"equality\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Equality redundant row 2\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 1, 1, 3],\r\n        [2, 3, 1, 2],\r\n        [3, 4, 2, 5],\r\n      ],\r\n      [4, 9, 13],\r\n      [1, 1, 1, 1],\r\n      \"equality\"\r\n    )\r\n  },\r\n  {\r\n    name: \"Klee-Minty cube  D=4\",\r\n    program: Program.fromArrays(\r\n      [\r\n        [1, 0, 0, 0],\r\n        [4, 1, 0, 0],\r\n        [8, 4, 1, 0],\r\n        [16, 8, 4, 1],\r\n      ],\r\n      [5, 25, 125, 625],\r\n      [8, 4, 2, 1],\r\n      \"primal\",\r\n    )\r\n  }\r\n]\r\n\r\nexport default examples;","// import Fraction from 'fraction.js/bigfraction'\r\nimport Fraction from 'fraction.js'\r\nimport React, { useState } from 'react';\r\nimport { InlineMath } from 'react-katex';\r\nimport { getStateFromProgram } from './SimplexState'\r\nimport { TableauDisplay } from './TableauDisplay'\r\nimport Program from './Program';\r\nimport examples from './examples'\r\nimport { cutToLength, range, zero, updateArr, updateArr2D } from './utils'\r\nimport './Input.scss'\r\nimport 'katex/dist/katex.min.css'\r\n\r\nconst MAX_N = 7;\r\nconst MAX_M = 7;\r\n\r\nfunction checkInput(input) {\r\n  const re = /^-?((\\d+(\\/[1-9]\\d*)?)|(\\d*\\.\\d+)|(\\d+\\.))$/;\r\n  return re.test(input);\r\n}\r\n\r\nfunction InputField({value, onChange, ending}) { \r\n  return (\r\n    <div className=\"input-field\">\r\n      <input \r\n        className={checkInput(value) ? \"correct-input\" : \"wrong-input\"}\r\n        value={value}\r\n        onChange={e => onChange(e.target.value)}\r\n      />\r\n      <span className=\"label\">\r\n        <InlineMath>\r\n          {ending}\r\n        </InlineMath>\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ExampleLoading({examplesList, selected, onChange}) {\r\n  function update(val) {\r\n    onChange(val, parseInt(val) !== -1 ? examplesList[val].program : null);\r\n  }\r\n\r\n  return (\r\n    <div className=\"input-row\">\r\n      <label htmlFor=\"example\">Example:</label>\r\n      <select \r\n        id=\"example\"\r\n        value={selected}\r\n        onChange={e => update(e.target.value)}\r\n      >\r\n        <option value={-1}>Custom</option>\r\n        {examplesList.map((e, i) =>\r\n          <option\r\n            key={i}\r\n            value={i}\r\n          >{e.name}</option>\r\n        )}\r\n      </select>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ProgramInput({onFinish}) {\r\n  const [state, setState] = useState({\r\n    program: Program.zeroProgram(2, 1),\r\n    fieldsA: [[\"0\", \"0\"]],\r\n    fieldsB: [\"0\"],\r\n    fieldsC: [\"0\", \"0\"],\r\n    fieldN: \"2\",\r\n    fieldM: \"1\",\r\n    selectedExample: -1,\r\n  });\r\n\r\n  const updateSize = (fn, fm) => {\r\n    let n = parseInt(fn);\r\n    let m = parseInt(fm);\r\n    n = isNaN(n) ? state.program.n : Math.max(Math.min(n, MAX_N), 1);\r\n    m = isNaN(m) ? state.program.m : Math.max(Math.min(m, MAX_M), 1);\r\n    \r\n    setState({\r\n      ...state,\r\n      program: state.program.updateSize(n, m),\r\n      fieldsA: cutToLength(\r\n        state.fieldsA.map(row => cutToLength(row, n, () => \"0\")), \r\n        m, () => range(n).map(i => \"0\")),\r\n      fieldsB: cutToLength(state.fieldsB, m, () => \"0\"),\r\n      fieldsC: cutToLength(state.fieldsC, n, () => \"0\"),\r\n      fieldN: fn,\r\n      fieldM: fm,\r\n    });\r\n  }\r\n\r\n  const adjustSizeFields = () => {\r\n    let n = parseInt(state.fieldN);\r\n    let m = parseInt(state.fieldM);\r\n    n = isNaN(n) ? state.program.n : Math.max(Math.min(n, MAX_N), 1);\r\n    m = isNaN(m) ? state.program.m : Math.max(Math.min(m, MAX_M), 1);\r\n\r\n    updateSize(n.toString(), m.toString());\r\n  }\r\n\r\n  const updateA = (i, j, val) => {\r\n    setState({\r\n      ...state, \r\n      program: state.program.updateA(i, j, checkInput(val) ? new Fraction(val) : zero),\r\n      fieldsA: updateArr2D(state.fieldsA, i, j, val),\r\n      selectedExample: -1\r\n    });\r\n  }\r\n  const updateB = (i, val)    => { \r\n    setState({\r\n      ...state, \r\n      program: state.program.updateB(i, checkInput(val) ? new Fraction(val) : zero),\r\n      fieldsB: updateArr(state.fieldsB, i, val),\r\n      selectedExample: -1\r\n    });\r\n  }\r\n  const updateC = (j, val)    => {\r\n    setState({\r\n      ...state, \r\n      program: state.program.updateC(j, checkInput(val) ? new Fraction(val) : zero),\r\n      fieldsC: updateArr(state.fieldsC, j, val),\r\n      selectedExample: -1\r\n    });\r\n  }\r\n\r\n  const setForm = newForm => {\r\n    setState({\r\n      ...state,\r\n      program: state.program.setForm(newForm),\r\n      selectedExample: -1\r\n    })\r\n  }\r\n\r\n  function reset() {\r\n    setState({\r\n      ...state,\r\n      program: Program.zeroProgram(2, 1),\r\n      fieldsA: [[\"0\", \"0\"]],\r\n      fieldsB: [\"0\"],\r\n      fieldsC: [\"0\", \"0\"],\r\n      fieldN: \"2\",\r\n      fieldM: \"1\",\r\n      selectedExample: -1\r\n    });\r\n  }\r\n\r\n  function selectExample(exampleNum, program) {\r\n    if (program === null) {\r\n      setState({\r\n        ...state,\r\n        selectedExample: exampleNum\r\n      });\r\n    } else {\r\n      setState({\r\n        ...state,\r\n        program: program,\r\n        fieldsA: program.A.map(row => row.map(v => v.toFraction())),\r\n        fieldsB: program.b.map(v => v.toFraction()),\r\n        fieldsC: program.c.map(v => v.toFraction()),\r\n        fieldN: program.n.toString(),\r\n        fieldM: program.m.toString(),\r\n        selectedExample: exampleNum\r\n      });  \r\n    }\r\n  }\r\n\r\n  console.log(state);\r\n\r\n  const isDual = state.program.isDual();\r\n  const isEquality = state.program.isEquality();\r\n\r\n  return (\r\n    <>\r\n    <ExampleLoading \r\n      examplesList={examples}\r\n      selected={state.selectedExample}\r\n      onChange={selectExample}\r\n    />\r\n    <div className=\"input-row\">\r\n      <label htmlFor=\"n\">{\"Variables:\"}</label>\r\n      <input \r\n        type=\"number\"\r\n        id=\"n\"\r\n        min=\"1\"\r\n        max={isDual ? MAX_M : MAX_N}\r\n        value={isDual ? state.fieldM : state.fieldN}\r\n        onChange={isDual ? (e => updateSize(state.fieldN, e.target.value)) :\r\n                           (e => updateSize(e.target.value, state.fieldM))}\r\n        onBlur={adjustSizeFields}\r\n        required\r\n      />\r\n      <label htmlFor=\"m\">{isEquality ? \"Equalities\" : \"Inequalities:\"}</label>\r\n      <input \r\n        type=\"number\"\r\n        id=\"m\"\r\n        min=\"1\"\r\n        max={isDual ? MAX_N : MAX_M}\r\n        value={isDual ? state.fieldN : state.fieldM}\r\n        onChange={isDual ? (e => updateSize(e.target.value, state.fieldM)) :\r\n                           (e => updateSize(state.fieldN, e.target.value))}\r\n        onBlur={adjustSizeFields}\r\n        required\r\n      />\r\n      <label htmlFor=\"form\">Form:</label>\r\n      <select \r\n        id=\"form\"\r\n        value={state.program.form}\r\n        onChange={e => setForm(e.target.value)}\r\n      >\r\n          <option value=\"primal\">Standard form</option>\r\n          <option value=\"dual\">Dual to standard form</option>\r\n          <option value=\"equality\">Equality form</option>\r\n          <option value=\"equality_dual\">Dual to equality form</option>\r\n      </select>\r\n    </div>\r\n    <div className=\"input-row\">\r\n      <button onClick={() => onFinish(state.program)}>Finish</button>\r\n      <button onClick={reset}>Reset</button>\r\n    </div>\r\n    <div style={{clear: \"both\"}}></div>\r\n    <table id=\"input-table\"><tbody>\r\n      <tr>\r\n        <td className=\"min-max\"><InlineMath>{isDual ? \"min\" : \"max\"}</InlineMath></td>\r\n        {range(isDual ? state.program.m : state.program.n).map(i =>\r\n          <React.Fragment key={i}>\r\n            <td>\r\n              <InputField\r\n                value={isDual ? state.fieldsB[i] : state.fieldsC[i]}\r\n                onChange={isDual ? (val => updateB(i, val)) : (val => updateC(i, val))}\r\n                ending={state.program.labels[i]}\r\n              />\r\n            </td>\r\n            <td>\r\n              <InlineMath>\r\n                {(i !== (isDual ? state.program.m : state.program.n) - 1 ? \"+\" : \"\")}\r\n              </InlineMath>\r\n            </td>\r\n          </React.Fragment>\r\n        )}\r\n      </tr>\r\n      {range(isDual ? state.program.n : state.program.m).map(i =>\r\n        <tr key={i}>\r\n          <td></td>\r\n          {range(isDual ? state.program.m : state.program.n).map(j =>\r\n            <React.Fragment key={j}>\r\n              <td key={j}>\r\n                <InputField\r\n                  value={isDual ? state.fieldsA[j][i] : state.fieldsA[i][j]}\r\n                  onChange={val => updateA(isDual ? j : i, isDual ? i : j, val)}\r\n                  ending={state.program.labels[j]}\r\n                />\r\n              </td>\r\n              <td>\r\n                <InlineMath>\r\n                  {(j !== (isDual ? state.program.m : state.program.n) - 1 ? \"+\" : \r\n                          (isDual ? \"\\\\geq\" : isEquality ? \"=\" : \"\\\\leq\"))}\r\n                </InlineMath>\r\n              </td>\r\n            </React.Fragment>\r\n          )}\r\n          <td>\r\n            <InputField\r\n              key={i}\r\n              value={isDual ? state.fieldsC[i] : state.fieldsB[i]}\r\n              onChange={isDual ? (val => updateC(i, val)) : (val => updateB(i, val))}\r\n              ending=\"\"\r\n            />\r\n          </td>\r\n        </tr>\r\n      )}\r\n      {(isEquality && isDual) ? <tr><td></td></tr> :\r\n        <tr>\r\n          <td \r\n            colSpan={2 * (isDual ? state.program.m : state.program.n)}\r\n            className=\"variable-list\"\r\n          >\r\n            <InlineMath>{state.program.labels.join(',')}</InlineMath>\r\n          </td>\r\n          <td><InlineMath>\\geq</InlineMath></td>\r\n          <td><InlineMath>0</InlineMath></td>\r\n        </tr>}\r\n    </tbody></table>\r\n    <TableauDisplay\r\n      state={getStateFromProgram(state.program)}\r\n      showPointer={false}\r\n    />\r\n    </>\r\n  );\r\n}\r\n\r\n\r\nexport { ProgramInput };","import './Layout.scss'\r\n\r\nexport function Pane({name, label, children}) {\r\n  return (\r\n    <div className=\"pane\">\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function MultiPane({defaultChoice, chosen, setChosen, children}) {\r\n  let choice = chosen;\r\n  const filteredChildren = children.flat().filter(c => c !== null);\r\n  if (!filteredChildren.some(c => c.props.name === chosen)) {\r\n    choice = defaultChoice;\r\n    setChosen(defaultChoice);\r\n  }\r\n  return (\r\n    <div className={\"multi-pane\"}>\r\n      <div className={\"pane-list\"}>\r\n        {filteredChildren.map((child, i) =>\r\n          <div\r\n            key={i} \r\n            className={`pane-button ${choice === child.props.name ? \"pane-button-selected\" : \"\"}`}\r\n            onClick={() => setChosen(child.props.name)}\r\n          >\r\n            {child.props.label}\r\n          </div>\r\n        )}\r\n        <div style={{clear: \"both\"}}></div>\r\n      </div>\r\n      {filteredChildren.map((child, i) =>\r\n        <div key={i} className={`${choice !== child.props.name ? \"pane-hidden\" : \"\"}`}>\r\n          {child}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function SplitPane({children}) {\r\n  return (\r\n    <div className=\"split-pane\">\r\n      <div className=\"split\">{children[0]}</div>\r\n      <div className=\"split-border\"></div>\r\n      <div className=\"split\">{children[1]}</div>\r\n    </div>\r\n  );\r\n}","import { InlineMath } from 'react-katex';\r\nimport { range, zero, one, minusOne, toLatex } from './utils'\r\nimport './Program.scss'\r\n\r\nfunction Monomial({\r\n  value, \r\n  label, \r\n  first = false, \r\n  firstNonZero = false, \r\n  lastInEmptyRow = false,\r\n  useDecimal = true,\r\n  useMixed = true,\r\n}) {\r\n  return first ? (\r\n    <td>\r\n      <InlineMath>{\r\n        lastInEmptyRow         ? \"0\"         :\r\n        value.equals(zero)     ? \"\"          : \r\n        value.equals(one)      ? label       :\r\n        value.equals(minusOne) ? `-${label}` :\r\n        `${toLatex(value.abs(), useMixed, useDecimal)} ${label}`\r\n      }</InlineMath>\r\n    </td>\r\n  ) : (\r\n    <>\r\n      <td className=\"operator\">\r\n        <InlineMath>{\r\n          value.equals(zero)      ? \"\"  : \r\n          value.compare(zero) < 0 ? \"-\" :\r\n          !firstNonZero           ? \"+\" : \"\"\r\n        }</InlineMath>\r\n      </td>\r\n      <td>\r\n        <InlineMath>{\r\n          lastInEmptyRow          ? \"0\"   :\r\n          value.equals(zero)      ? \"\"    :\r\n          value.abs().equals(one) ? label : \r\n          `${toLatex(value.abs(), useMixed, useDecimal)} ${label}`\r\n        }</InlineMath>\r\n      </td>\r\n    </>\r\n  );\r\n}\r\n\r\nexport function ProgramDisplay({program, useDecimal, useMixed}) {\r\n  // console.log(program);\r\n  function getFirstNonZeroIndex(arr) {\r\n    return arr.map(v => !v.equals(zero)).indexOf(true);\r\n  }\r\n  const isDual = program.isDual()\r\n  const showPrimal = !isDual;\r\n  const isEquality = program.isEquality();\r\n  const firstNonZero = showPrimal ?\r\n    range(program.m).map(i => getFirstNonZeroIndex(program.A[i])) :\r\n    range(program.n).map(j => \r\n      getFirstNonZeroIndex(range(program.m).map(i => program.A[i][j])));\r\n  const firstNonZeroInTopRow = getFirstNonZeroIndex(showPrimal ? program.c : program.b);\r\n  return (\r\n    <table className=\"program-display\">\r\n      <tbody>\r\n        <tr>\r\n          <td><InlineMath>{showPrimal ? \"max\" : \"min\"}</InlineMath></td>\r\n          {range(showPrimal ? program.n : program.m).map(i =>\r\n            <Monomial\r\n              key={i}\r\n              value={showPrimal ? program.c[i] : program.b[i]}\r\n              first={i === 0}\r\n              label={program.labels[i]}\r\n              firstNonZero={i === firstNonZeroInTopRow}\r\n              lastInEmptyRow={i === (showPrimal ? program.n : program.m) - 1 \r\n                              && firstNonZeroInTopRow === -1}\r\n              useDecimal={useDecimal}\r\n              useMixed={useMixed}\r\n            />\r\n          )}\r\n        </tr>\r\n        {range(showPrimal ? program.m : program.n).map(i =>\r\n          <tr key={i}>\r\n            <td></td>\r\n            {range(showPrimal ? program.n : program.m).map(j =>\r\n              <Monomial\r\n                key={j}\r\n                value={showPrimal ? program.A[i][j] : program.A[j][i]}\r\n                first={j === 0}\r\n                label={program.labels[j]}\r\n                firstNonZero={j === firstNonZero[i]}\r\n                lastInEmptyRow={j === (showPrimal ? program.n : program.m) - 1 \r\n                                && firstNonZero[i] === -1}\r\n                useDecimal={useDecimal}\r\n                useMixed={useMixed}\r\n              />\r\n            )}\r\n            <td><InlineMath>{isDual ? \"\\\\geq\" : isEquality ? \"=\" : \"\\\\geq\"}</InlineMath></td>\r\n            <td>\r\n              <InlineMath>\r\n                {toLatex(showPrimal ? program.b[i] : program.c[i], useMixed, useDecimal)}\r\n              </InlineMath>\r\n            </td>\r\n          </tr>\r\n        )}\r\n        {program.form === \"equality_dual\" ? null :\r\n        <tr>\r\n          <td colSpan={showPrimal ? 2 * program.n : 2 * program.m}>\r\n            <InlineMath>\r\n              {program.labels.join(\", \")}\r\n            </InlineMath>\r\n          </td>\r\n          <td><InlineMath>\\geq</InlineMath></td>\r\n          <td><InlineMath>0</InlineMath></td>\r\n        </tr>}\r\n      </tbody>\r\n    </table>\r\n  );\r\n}\r\n\r\nexport function SlackForm({tableau, useDecimal, useMixed}) {\r\n  const nonBasicColumns = range(tableau.columns - 1).filter(i => !tableau.isBase[i]);\r\n  return (\r\n    <table className=\"program-display\">\r\n      <tbody>\r\n        <tr>\r\n          <td><InlineMath>z</InlineMath></td>\r\n          <td><InlineMath>=</InlineMath></td>\r\n          <td><InlineMath>{toLatex(tableau.tableau[0][tableau.columns-1], useMixed, useDecimal)}</InlineMath></td>\r\n          {nonBasicColumns.map(i =>\r\n            <Monomial\r\n              key={i}\r\n              value={tableau.tableau[0][i].neg()}\r\n              label={tableau.primalLabels[i]}\r\n              useDecimal={useDecimal}\r\n              useMixed={useMixed}\r\n            />\r\n          )}\r\n        </tr>\r\n        {range(tableau.m).map(i =>\r\n          <tr key={i}>\r\n            <td><InlineMath>{tableau.baseVariables[i] >= 0 ? tableau.primalLabels[tableau.baseVariables[i]] : \"0\"}</InlineMath></td>\r\n            <td><InlineMath>=</InlineMath></td>\r\n            <td><InlineMath>{tableau.tableau[i+1][tableau.columns-1].toLatex()}</InlineMath></td>\r\n            {nonBasicColumns.map(j =>\r\n              <Monomial\r\n                key={j}\r\n                value={tableau.tableau[i+1][j].neg()}\r\n                label={tableau.primalLabels[j]}\r\n                useDecimal={useDecimal}\r\n                useMixed={useMixed}\r\n              />\r\n            )}\r\n          </tr>\r\n        )}\r\n      </tbody>\r\n    </table>\r\n  )\r\n}","import React, { useState } from 'react';\r\nimport { InlineMath } from 'react-katex'\r\nimport Switch from \"react-switch\";\r\nimport { Pane, MultiPane, SplitPane } from './Layout'\r\nimport { range, copyArr, toLatex, flipSelection, isAllowedToSelect } from './utils'\r\nimport { getStateFromProgram } from './SimplexState'\r\nimport { ProgramDisplay, SlackForm } from './ProgramDisplay'\r\nimport { TableauDisplay } from './TableauDisplay'\r\nimport './Tableau.scss'\r\nimport './Input.scss'\r\n\r\nfunction SolutionDisplay({\r\n  title,\r\n  labels, \r\n  solution, \r\n  toShow = solution.length, \r\n  feasible, \r\n  useDecimal = true, \r\n  useMixed = false,\r\n}) {\r\n  return (\r\n    <div className=\"solution\">\r\n      <div className=\"solution-header\">{title} \r\n        {feasible ?\r\n          <span colSpan={toShow} className=\"highlight-pos\">Feasible</span> :\r\n          <span colSpan={toShow} className=\"highlight-neg\">Infeasible</span>\r\n        }\r\n      </div>\r\n      <div className=\"inner\">\r\n        <table className=\"solution-table\">\r\n          <tbody>\r\n            <tr>\r\n              {range(toShow).map(i => \r\n                <td key={i}><InlineMath>{labels[i]}</InlineMath></td>\r\n              )}\r\n            </tr>\r\n            <tr>\r\n              {range(toShow).map(i => \r\n                <td key={i}><InlineMath>{toLatex(solution[i], useMixed, useDecimal)}</InlineMath></td>\r\n              )}\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction SelectSetting({name, currentValue, options, onChange}) {\r\n  return (\r\n    <div className=\"setting\">\r\n      <select \r\n        className=\"setting-select\"\r\n        name={name}\r\n        value={currentValue}\r\n        onChange={e => onChange(e.target.value)}\r\n      >\r\n        {options.map((option, i) =>\r\n          <option \r\n            key={i}\r\n            value={option.value}\r\n          >\r\n            {option.label}\r\n          </option>\r\n        )}\r\n      </select>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction SwitchSetting({name, description, currentValue, onChange, color}) {\r\n  return (\r\n    <div className=\"setting\">\r\n      <div className=\"switch\">\r\n        <Switch \r\n          id={name}\r\n          height={25}\r\n          width={50}\r\n          onChange={val => onChange(val)} \r\n          onColor={color}\r\n          checked={currentValue}\r\n        />\r\n      </div>\r\n      <label \r\n        htmlFor={name}\r\n        className=\"description\"\r\n      >\r\n        {description}\r\n      </label>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Settings({settings, setSetting, availablePivots}) {\r\n  return (\r\n    <div id=\"settings\">\r\n      <div className=\"setting-pivot\">\r\n        <div className=\"header\">Suggested Pivots</div>\r\n        <SelectSetting \r\n          name=\"highlighted_pivot\"\r\n          description=\"Suggested\"\r\n          currentValue={settings.highlightedPivots}\r\n          options={Object.entries(availablePivots).map(s => ({ value: s[0], label: s[1].description }))}\r\n          onChange={newValue => setSetting(\"highlightedPivots\", newValue)}\r\n        />\r\n      </div>\r\n      <div className=\"setting-base\">\r\n        <div className=\"header\">Base columns</div>\r\n        <SwitchSetting \r\n          name=\"highlight_base\"\r\n          color=\"#88c5ff\"\r\n          description=\"Highlight base columns\"\r\n          currentValue={settings.highlightBase}\r\n          onChange={newValue => setSetting(\"highlightBase\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"show_base\"\r\n          color=\"#88c5ff\"\r\n          description=\"Show base columns\"\r\n          currentValue={settings.showBase}\r\n          onChange={newValue => setSetting(\"showBase\", newValue)}\r\n        />\r\n      </div>\r\n      <div className=\"setting-other\">\r\n        <div className=\"header\">Other settings</div>\r\n        <SwitchSetting \r\n          name=\"highlight_invariants\"\r\n          color=\"#6cd875\"\r\n          description=\"Highlight invariants\"\r\n          currentValue={settings.highlightInvariants}\r\n          onChange={newValue => setSetting(\"highlightInvariants\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"use_decimal\"\r\n          color=\"#6cd875\"\r\n          description=\"Use decimal fractions\"\r\n          currentValue={settings.useDecimal}\r\n          onChange={newValue => setSetting(\"useDecimal\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"use_mixed\"\r\n          color=\"#6cd875\"\r\n          description=\"Use mixed fractions\"\r\n          currentValue={settings.useMixed}\r\n          onChange={newValue => setSetting(\"useMixed\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"show_disabled\"\r\n          color=\"#6cd875\"\r\n          description=\"Darken cells where pivot cannot be done\"\r\n          currentValue={settings.showDisabled}\r\n          onChange={newValue => setSetting(\"showDisabled\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"objective_at_bottom\"\r\n          color=\"#6cd875\"\r\n          description=\"Display objective function row at the bottom\"\r\n          currentValue={settings.showObjectiveBottom}\r\n          onChange={newValue => setSetting(\"showObjectiveBottom\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"b_column_on_left\"\r\n          color=\"#6cd875\"\r\n          description=\"Display the b column on the left\"\r\n          currentValue={settings.showBColumnsLeft}\r\n          onChange={newValue => setSetting(\"showBColumnsLeft\", newValue)}\r\n        />\r\n        <SwitchSetting \r\n          name=\"slack_on_left\"\r\n          color=\"#6cd875\"\r\n          description=\"Display the slack variables on the left\"\r\n          currentValue={settings.showSlackLeft}\r\n          onChange={newValue => setSetting(\"showSlackLeft\", newValue)}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction InteractiveTableau({initialProgram, onStartOver}) {\r\n  const [state, setState] = useState({\r\n    stateHistory: [getStateFromProgram(initialProgram)],\r\n    index: 0,\r\n    settings: {\r\n      highlightedPivots: \"bland_primal\",\r\n      highlightBase: true,\r\n      showBase: true,\r\n      highlightInvariants: true,\r\n      useDecimal: true,\r\n      useMixed: false,\r\n      showDisabled: true,\r\n      showObjectiveBottom: false,\r\n      showBColumnsLeft: false,\r\n      showSlackLeft: false,\r\n    },\r\n    selectedProgram: null,\r\n    currentTransition: null\r\n  });\r\n\r\n  const currentTableau = state.stateHistory[state.index]; \r\n  let highlightedPivots = state.settings.highlightedPivots;\r\n  if (!(highlightedPivots in currentTableau.suggestedPivots)) {\r\n    highlightedPivots = currentTableau.defaultSuggestion;\r\n    setSetting(\"highlightedPivots\", currentTableau.defaultSuggestion);\r\n  }\r\n\r\n  // console.log(state);\r\n  // console.log(currentTableau);\r\n\r\n  function goToPrevious() { setState({ ...state, index: state.index - 1, currentTransition: null }); }\r\n  function goToNext()     { setState({ ...state, index: state.index + 1, currentTransition: null }); }\r\n\r\n  function appendTableau(newTab) {\r\n    setState({\r\n      ...state,\r\n      stateHistory: state.stateHistory.slice(0, state.index + 1).concat(newTab),\r\n      index: state.index + 1,\r\n      currentTransition: null\r\n    })\r\n  }\r\n\r\n  function handleCellClick(i, j) {\r\n    if (state.currentTransition === null) {\r\n      if (currentTableau.canPivot(i, j))\r\n        appendTableau(currentTableau.pivot(i, j));  \r\n    } else {\r\n      if (isAllowedToSelect(i, j, state.currentTransition.selection)) {\r\n        setState({\r\n          ...state,\r\n          currentTransition: {\r\n            ...state.currentTransition,\r\n            selection: flipSelection(i, j, state.currentTransition.selection)\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  function makeTransition(transition) {\r\n    if (transition.args === \"none\")\r\n      appendTableau(transition.getNewState());\r\n    else {\r\n      setState({\r\n        ...state,\r\n        currentTransition: {\r\n          getNewState: transition.getNewState,\r\n          validateArgs: transition.validateArgs,\r\n          prompt: transition.prompt,\r\n          selection: {\r\n            type: transition.args,\r\n            selected: copyArr(transition.defaultSelection),\r\n            allowed: transition.allowed,\r\n          },\r\n          errorMessage: null\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  function finishTransition() {\r\n    const args = state.currentTransition.selection.selected;\r\n    const [correct, error] = state.currentTransition.validateArgs(args);\r\n    if (correct) {\r\n      appendTableau(state.currentTransition.getNewState(args));\r\n    } else {\r\n      setState({\r\n        ...state,\r\n        currentTransition: {\r\n          ...state.currentTransition,\r\n          errorMessage: error\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  function cancelTransition() {\r\n    setState({\r\n      ...state,\r\n      currentTransition: null,\r\n    })\r\n  }\r\n\r\n  function selectAll() {\r\n    setState({\r\n      ...state,\r\n      currentTransition: {\r\n        ...state.currentTransition,\r\n        selection: {\r\n          ...state.currentTransition.selection,\r\n          selected: copyArr(state.currentTransition.selection.allowed)\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  function setSetting(setting, value) {\r\n    setState({\r\n      ...state,\r\n      settings: {\r\n        ...state.settings,\r\n        [setting]: value\r\n      }\r\n    })\r\n  }\r\n\r\n  return (\r\n    <div id=\"inner-wrapper\">\r\n      <div id=\"tab-and-controls\">\r\n        <div id=\"controls\">\r\n          <button\r\n            onClick={goToPrevious}\r\n            disabled={state.index === 0}\r\n          >\r\n            Previous\r\n          </button>\r\n          <span id=\"counter\">{`${state.index+1} / ${state.stateHistory.length}`}</span>\r\n          <button\r\n            onClick={goToNext}\r\n            disabled={state.index === state.stateHistory.length - 1}\r\n          >\r\n            Next\r\n          </button>\r\n        </div>\r\n        <TableauDisplay\r\n          state={currentTableau}\r\n          onCellClick={handleCellClick}\r\n          showDisabled={true}\r\n          selection={state.currentTransition === null ? null : state.currentTransition.selection}\r\n          {...state.settings}\r\n          highlightedPivots={highlightedPivots}\r\n        />\r\n        <div id=\"message\">\r\n          {state.currentTransition === null ?\r\n          (<>\r\n            <p>{currentTableau.getStatusMessage().split(\"$\").map((subMsg, i) => \r\n                i % 2 === 0 ? subMsg : (<InlineMath>{subMsg}</InlineMath>))}</p>\r\n            {currentTableau.transitions.map((transition, i) => \r\n              <button \r\n                key={i} \r\n                className=\"inline-button\"\r\n                onClick={() => makeTransition(transition)}>\r\n                  {transition.label}\r\n              </button>\r\n            )}\r\n          </>) :\r\n          (<>\r\n            {state.currentTransition.prompt}\r\n            <button onClick={finishTransition} className=\"inline-button\">Done</button>\r\n            <button onClick={selectAll} className=\"inline-button\">Select All</button>\r\n            <button onClick={cancelTransition} className=\"inline-button\">Cancel</button>\r\n            {state.currentTransition.errorMessage === null ? null :\r\n              <p className=\"highlight-neg\">{state.currentTransition.errorMessage}</p>\r\n            }\r\n          </>)\r\n          }\r\n        </div>\r\n      </div>\r\n      <div id=\"sidebar\">\r\n        <Settings\r\n          settings={{...state.settings, highlightedPivots: highlightedPivots}}\r\n          availablePivots={currentTableau.suggestedPivots}\r\n          setSetting={setSetting}\r\n        />\r\n        <button onClick={onStartOver} id=\"start-over\">Start over with a new program</button>\r\n      </div>\r\n      <SplitPane>\r\n        <SolutionDisplay\r\n          title={\"Primal solution\"}\r\n          labels={currentTableau.primalLabels}\r\n          solution={currentTableau.primalSolution}\r\n          feasible={currentTableau.primalFeasible}\r\n          {...state.settings}\r\n        />\r\n        <SolutionDisplay\r\n          title={\"Dual solution\"}\r\n          labels={currentTableau.dualLabels}\r\n          solution={currentTableau.dualSolution}\r\n          feasible={currentTableau.dualFeasible}\r\n          {...state.settings}\r\n        />\r\n      </SplitPane>\r\n      <MultiPane\r\n        defaultChoice={currentTableau.defaultProgram}\r\n        chosen={state.selectedProgram}\r\n        setChosen={choice => setState({...state, selectedProgram: choice})}\r\n      >\r\n        {currentTableau.programs.map(({name, program}, i) =>\r\n          <Pane \r\n            key={i}\r\n            name={name}\r\n            label={name}\r\n          >\r\n            <ProgramDisplay\r\n              program={program}\r\n              {...state.settings}\r\n            />\r\n          </Pane>\r\n        )}\r\n        {currentTableau.isEquality ? null :\r\n        <Pane\r\n          name=\"slack\"\r\n          label=\"Slack Form\"\r\n        >\r\n          <SlackForm\r\n            tableau={currentTableau}\r\n            {...state.settings}\r\n          />\r\n        </Pane>}\r\n      </MultiPane>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport { InteractiveTableau };","import './App.scss';\r\nimport { useState } from 'react';\r\nimport { ProgramInput } from './Input'\r\nimport { InteractiveTableau } from './InteractiveTableau'\r\n\r\nfunction App() {\r\n  const [initialProgram, setInitialProgram] = useState(null);\r\n  if (initialProgram === null) {\r\n    return (\r\n      <div id=\"wrapper\">\r\n        <ProgramInput \r\n          onFinish={(program) => setInitialProgram(program)}\r\n        />\r\n      </div>\r\n    );\r\n  } else {\r\n    return (\r\n      <div id=\"wrapper\">\r\n        <InteractiveTableau\r\n          initialProgram={initialProgram}\r\n          onStartOver={() => setInitialProgram(null)}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.scss';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}